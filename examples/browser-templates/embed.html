<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- ===== CUSTOMIZE THESE META TAGS ===== -->
  <title>HoloScript Scene | Interactive 3D Experience</title>
  <meta name="description" content="Interactive 3D scene built with HoloScript. Experience in VR/AR!">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="player">
  <meta name="twitter:site" content="@HoloScriptDev">
  <meta name="twitter:title" content="HoloScript Scene">
  <meta name="twitter:description" content="Interactive 3D scene built with HoloScript">
  <meta name="twitter:image" content="https://holoscript.dev/preview.png">
  <meta name="twitter:player" content="https://play.holoscript.dev/embed">
  <meta name="twitter:player:width" content="800">
  <meta name="twitter:player:height" content="600">
  
  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="HoloScript Scene">
  <meta property="og:description" content="Interactive 3D scene built with HoloScript">
  <meta property="og:image" content="https://holoscript.dev/preview.png">
  <meta property="og:url" content="https://play.holoscript.dev">
  <!-- ====================================== -->
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      background: #0a0a1a; 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      overflow: hidden;
      color: #fff;
    }
    
    #container { 
      width: 100vw; 
      height: 100vh; 
    }
    
    #loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
    }
    
    .spinner {
      width: 50px;
      height: 50px;
      border: 3px solid rgba(0, 255, 255, 0.2);
      border-top-color: #00ffff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    #controls {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 12px;
    }
    
    .control-btn {
      padding: 12px 24px;
      background: rgba(0, 255, 255, 0.2);
      color: #00ffff;
      border: 1px solid rgba(0, 255, 255, 0.5);
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .control-btn:hover {
      background: rgba(0, 255, 255, 0.4);
    }
    
    .control-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    #brand {
      position: absolute;
      top: 20px;
      left: 20px;
      font-size: 12px;
      opacity: 0.7;
    }
    
    #brand a {
      color: #00ffff;
      text-decoration: none;
    }
    
    #qr-container {
      position: absolute;
      top: 20px;
      right: 20px;
      text-align: center;
    }
    
    #qr-code {
      width: 80px;
      height: 80px;
      background: #fff;
      border-radius: 4px;
    }
    
    #qr-label {
      font-size: 10px;
      margin-top: 5px;
      opacity: 0.7;
    }
    
    #share-btn {
      position: absolute;
      top: 20px;
      right: 120px;
    }
  </style>
</head>
<body>
  <div id="loading">
    <div class="spinner"></div>
    <div>Loading HoloScript scene...</div>
  </div>
  
  <div id="container"></div>
  
  <div id="brand">
    Built with <a href="https://holoscript.dev" target="_blank">HoloScript</a>
  </div>
  
  <div id="qr-container">
    <img id="qr-code" src="" alt="QR Code">
    <div id="qr-label">Scan for mobile XR</div>
  </div>
  
  <button id="share-btn" class="control-btn" onclick="shareScene()">
    ðŸ“¤ Share
  </button>
  
  <div id="controls">
    <button id="vr-btn" class="control-btn" disabled>ðŸ¥½ Enter VR</button>
    <button id="ar-btn" class="control-btn" disabled>ðŸ“± Enter AR</button>
    <button id="fullscreen-btn" class="control-btn" onclick="toggleFullscreen()">â›¶ Fullscreen</button>
  </div>
  
  <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
      }
    }
  </script>
  
  <script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
    import { VRButton } from 'three/addons/webxr/VRButton.js';
    import { ARButton } from 'three/addons/webxr/ARButton.js';
    
    // ===== HOLOSCRIPT CODE - REPLACE THIS =====
    const HOLOSCRIPT_CODE = `
      composition "X Share Demo" {
        environment {
          skybox: "nebula"
          ambient_light: 0.3
        }
        
        object "Crystal" @glowing @grabbable {
          geometry: "sphere"
          color: "#00ffff"
          position: [0, 1.5, 0]
        }
        
        object "Platform" {
          geometry: "cylinder"
          color: "#333366"
          position: [0, 0.1, 0]
          scale: [1.5, 0.2, 1.5]
        }
      }
    `;
    // ==========================================
    
    // Generate QR code
    const currentUrl = window.location.href;
    document.getElementById('qr-code').src = 
      `https://api.qrserver.com/v1/create-qr-code/?size=80x80&data=${encodeURIComponent(currentUrl)}`;
    
    // Setup scene
    const container = document.getElementById('container');
    const scene = new THREE.Scene();
    
    // Gradient background
    const canvas = document.createElement('canvas');
    canvas.width = 2;
    canvas.height = 512;
    const ctx = canvas.getContext('2d');
    const gradient = ctx.createLinearGradient(0, 0, 0, 512);
    gradient.addColorStop(0, '#1a1a2e');
    gradient.addColorStop(0.5, '#16213e');
    gradient.addColorStop(1, '#0f0f23');
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, 2, 512);
    const bgTexture = new THREE.CanvasTexture(canvas);
    scene.background = bgTexture;
    
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.set(0, 2, 4);
    
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    renderer.xr.enabled = true;
    container.appendChild(renderer.domElement);
    
    // Controls
    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.target.set(0, 1, 0);
    controls.autoRotate = true;
    controls.autoRotateSpeed = 0.5;
    
    // Lighting
    const ambientLight = new THREE.AmbientLight(0xffffff, 0.3);
    scene.add(ambientLight);
    
    const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
    directionalLight.position.set(5, 10, 5);
    directionalLight.castShadow = true;
    scene.add(directionalLight);
    
    // Add glow light
    const pointLight = new THREE.PointLight(0x00ffff, 1, 5);
    pointLight.position.set(0, 1.5, 0);
    scene.add(pointLight);
    
    // Create objects
    const objects = [];
    
    // Crystal
    const crystalGeometry = new THREE.IcosahedronGeometry(0.4, 1);
    const crystalMaterial = new THREE.MeshStandardMaterial({
      color: 0x00ffff,
      emissive: 0x00ffff,
      emissiveIntensity: 0.5,
      metalness: 0.5,
      roughness: 0.2,
    });
    const crystal = new THREE.Mesh(crystalGeometry, crystalMaterial);
    crystal.position.set(0, 1.5, 0);
    scene.add(crystal);
    objects.push(crystal);
    
    // Platform
    const platformGeometry = new THREE.CylinderGeometry(1.5, 1.5, 0.2, 32);
    const platformMaterial = new THREE.MeshStandardMaterial({
      color: 0x333366,
      metalness: 0.8,
      roughness: 0.2,
    });
    const platform = new THREE.Mesh(platformGeometry, platformMaterial);
    platform.position.set(0, 0.1, 0);
    scene.add(platform);
    
    // Hide loading
    document.getElementById('loading').style.display = 'none';
    
    // Check WebXR support
    if ('xr' in navigator) {
      // VR
      navigator.xr.isSessionSupported('immersive-vr').then(supported => {
        const vrBtn = document.getElementById('vr-btn');
        if (supported) {
          vrBtn.disabled = false;
          vrBtn.onclick = () => {
            const vrButton = VRButton.createButton(renderer);
            vrButton.click();
          };
        } else {
          vrBtn.textContent = 'ðŸ¥½ VR Unavailable';
        }
      });
      
      // AR
      navigator.xr.isSessionSupported('immersive-ar').then(supported => {
        const arBtn = document.getElementById('ar-btn');
        if (supported) {
          arBtn.disabled = false;
          arBtn.onclick = () => {
            const arButton = ARButton.createButton(renderer);
            arButton.click();
          };
        } else {
          arBtn.textContent = 'ðŸ“± AR Unavailable';
        }
      });
    }
    
    // Animation
    const clock = new THREE.Clock();
    
    function animate() {
      const elapsed = clock.getElapsedTime();
      
      // Float the crystal
      crystal.position.y = 1.5 + Math.sin(elapsed * 2) * 0.1;
      crystal.rotation.y = elapsed * 0.5;
      
      // Pulse the glow
      crystalMaterial.emissiveIntensity = 0.3 + Math.sin(elapsed * 3) * 0.2;
      pointLight.intensity = 0.5 + Math.sin(elapsed * 3) * 0.3;
      
      controls.update();
      renderer.render(scene, camera);
    }
    
    renderer.setAnimationLoop(animate);
    
    // Handle resize
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
    
    // Expose for share function
    window.holoScriptCode = HOLOSCRIPT_CODE;
  </script>
  
  <script>
    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
      } else {
        document.exitFullscreen();
      }
    }
    
    function shareScene() {
      const shareData = {
        title: 'HoloScript Scene',
        text: 'ðŸŽ® Check out this VR scene I made with HoloScript! #HoloScript #VR #XR',
        url: window.location.href
      };
      
      if (navigator.share) {
        navigator.share(shareData);
      } else {
        // Fallback: copy to clipboard
        navigator.clipboard.writeText(window.location.href).then(() => {
          alert('Link copied to clipboard!');
        });
      }
    }
  </script>
</body>
</html>
