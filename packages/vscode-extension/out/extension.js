"use strict";var OC=Object.create;var yo=Object.defineProperty;var MC=Object.getOwnPropertyDescriptor;var NC=Object.getOwnPropertyNames;var LC=Object.getPrototypeOf,FC=Object.prototype.hasOwnProperty;var mh=(n,e)=>()=>(n&&(e=n(n=0)),e);var N=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Ec=(n,e)=>{for(var t in e)yo(n,t,{get:e[t],enumerable:!0})},gh=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of NC(e))!FC.call(n,i)&&i!==t&&yo(n,i,{get:()=>e[i],enumerable:!(r=MC(e,i))||r.enumerable});return n};var Vt=(n,e,t)=>(t=n!=null?OC(LC(n)):{},gh(e||!n||!n.__esModule?yo(t,"default",{value:n,enumerable:!0}):t,n)),yh=n=>gh(yo({},"__esModule",{value:!0}),n);var _n=N(dt=>{"use strict";Object.defineProperty(dt,"__esModule",{value:!0});dt.asPromise=dt.thenable=dt.typedArray=dt.stringArray=dt.array=dt.func=dt.error=dt.number=dt.string=dt.boolean=void 0;function qC(n){return n===!0||n===!1}dt.boolean=qC;function vh(n){return typeof n=="string"||n instanceof String}dt.string=vh;function AC(n){return typeof n=="number"||n instanceof Number}dt.number=AC;function jC(n){return n instanceof Error}dt.error=jC;function bh(n){return typeof n=="function"}dt.func=bh;function Ch(n){return Array.isArray(n)}dt.array=Ch;function HC(n){return Ch(n)&&n.every(e=>vh(e))}dt.stringArray=HC;function $C(n,e){return Array.isArray(n)&&n.every(e)}dt.typedArray=$C;function wh(n){return n&&bh(n.then)}dt.thenable=wh;function UC(n){return n instanceof Promise?n:wh(n)?new Promise((e,t)=>{n.then(r=>e(r),r=>t(r))}):Promise.resolve(n)}dt.asPromise=UC});var Ni=N(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.stringArray=At.array=At.func=At.error=At.number=At.string=At.boolean=void 0;function zC(n){return n===!0||n===!1}At.boolean=zC;function _h(n){return typeof n=="string"||n instanceof String}At.string=_h;function WC(n){return typeof n=="number"||n instanceof Number}At.number=WC;function BC(n){return n instanceof Error}At.error=BC;function KC(n){return typeof n=="function"}At.func=KC;function Sh(n){return Array.isArray(n)}At.array=Sh;function GC(n){return Sh(n)&&n.every(e=>_h(e))}At.stringArray=GC});var Xc=N(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.Message=ie.NotificationType9=ie.NotificationType8=ie.NotificationType7=ie.NotificationType6=ie.NotificationType5=ie.NotificationType4=ie.NotificationType3=ie.NotificationType2=ie.NotificationType1=ie.NotificationType0=ie.NotificationType=ie.RequestType9=ie.RequestType8=ie.RequestType7=ie.RequestType6=ie.RequestType5=ie.RequestType4=ie.RequestType3=ie.RequestType2=ie.RequestType1=ie.RequestType=ie.RequestType0=ie.AbstractMessageSignature=ie.ParameterStructures=ie.ResponseError=ie.ErrorCodes=void 0;var Qr=Ni(),Rc;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=-32099,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.PendingResponseRejected=-32097,n.ConnectionInactive=-32096,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=-32e3})(Rc||(ie.ErrorCodes=Rc={}));var Dc=class n extends Error{constructor(e,t,r){super(t),this.code=Qr.number(e)?e:Rc.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,n.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};ie.ResponseError=Dc;var tn=class n{constructor(e){this.kind=e}static is(e){return e===n.auto||e===n.byName||e===n.byPosition}toString(){return this.kind}};ie.ParameterStructures=tn;tn.auto=new tn("auto");tn.byPosition=new tn("byPosition");tn.byName=new tn("byName");var Je=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return tn.auto}};ie.AbstractMessageSignature=Je;var xc=class extends Je{constructor(e){super(e,0)}};ie.RequestType0=xc;var Pc=class extends Je{constructor(e,t=tn.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};ie.RequestType=Pc;var kc=class extends Je{constructor(e,t=tn.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};ie.RequestType1=kc;var Ic=class extends Je{constructor(e){super(e,2)}};ie.RequestType2=Ic;var Oc=class extends Je{constructor(e){super(e,3)}};ie.RequestType3=Oc;var Mc=class extends Je{constructor(e){super(e,4)}};ie.RequestType4=Mc;var Nc=class extends Je{constructor(e){super(e,5)}};ie.RequestType5=Nc;var Lc=class extends Je{constructor(e){super(e,6)}};ie.RequestType6=Lc;var Fc=class extends Je{constructor(e){super(e,7)}};ie.RequestType7=Fc;var qc=class extends Je{constructor(e){super(e,8)}};ie.RequestType8=qc;var Ac=class extends Je{constructor(e){super(e,9)}};ie.RequestType9=Ac;var jc=class extends Je{constructor(e,t=tn.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};ie.NotificationType=jc;var Hc=class extends Je{constructor(e){super(e,0)}};ie.NotificationType0=Hc;var $c=class extends Je{constructor(e,t=tn.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};ie.NotificationType1=$c;var Uc=class extends Je{constructor(e){super(e,2)}};ie.NotificationType2=Uc;var zc=class extends Je{constructor(e){super(e,3)}};ie.NotificationType3=zc;var Wc=class extends Je{constructor(e){super(e,4)}};ie.NotificationType4=Wc;var Bc=class extends Je{constructor(e){super(e,5)}};ie.NotificationType5=Bc;var Kc=class extends Je{constructor(e){super(e,6)}};ie.NotificationType6=Kc;var Gc=class extends Je{constructor(e){super(e,7)}};ie.NotificationType7=Gc;var Vc=class extends Je{constructor(e){super(e,8)}};ie.NotificationType8=Vc;var Zc=class extends Je{constructor(e){super(e,9)}};ie.NotificationType9=Zc;var Th;(function(n){function e(i){let s=i;return s&&Qr.string(s.method)&&(Qr.string(s.id)||Qr.number(s.id))}n.isRequest=e;function t(i){let s=i;return s&&Qr.string(s.method)&&i.id===void 0}n.isNotification=t;function r(i){let s=i;return s&&(s.result!==void 0||!!s.error)&&(Qr.string(s.id)||Qr.number(s.id)||s.id===null)}n.isResponse=r})(Th||(ie.Message=Th={}))});var Yc=N(kr=>{"use strict";var Eh;Object.defineProperty(kr,"__esModule",{value:!0});kr.LRUCache=kr.LinkedMap=kr.Touch=void 0;var jt;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(jt||(kr.Touch=jt={}));var vo=class{constructor(){this[Eh]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=jt.None){let r=this._map.get(e);if(r)return t!==jt.None&&this.touch(r,t),r.value}set(e,t,r=jt.None){let i=this._map.get(e);if(i)i.value=t,r!==jt.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case jt.None:this.addItemLast(i);break;case jt.First:this.addItemFirst(i);break;case jt.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}[(Eh=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==jt.First&&t!==jt.Last)){if(t===jt.First){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===jt.Last){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(let[t,r]of e)this.set(t,r)}};kr.LinkedMap=vo;var Jc=class extends vo{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=jt.AsNew){return super.get(e,t)}peek(e){return super.get(e,jt.None)}set(e,t){return super.set(e,t,jt.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};kr.LRUCache=Jc});var Dh=N(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});bo.Disposable=void 0;var Rh;(function(n){function e(t){return{dispose:t}}n.create=e})(Rh||(bo.Disposable=Rh={}))});var Ir=N(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});var Qc;function eu(){if(Qc===void 0)throw new Error("No runtime abstraction layer installed");return Qc}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");Qc=t}n.install=e})(eu||(eu={}));tu.default=eu});var Fi=N(Li=>{"use strict";Object.defineProperty(Li,"__esModule",{value:!0});Li.Emitter=Li.Event=void 0;var VC=Ir(),xh;(function(n){let e={dispose(){}};n.None=function(){return e}})(xh||(Li.Event=xh={}));var nu=class{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let i=0,s=this._callbacks.length;i<s;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let s=0,o=r.length;s<o;s++)try{t.push(r[s].apply(i[s],e))}catch(a){(0,VC.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},Co=class n{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new nu),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=n._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};Li.Emitter=Co;Co._noop=function(){}});var So=N(qi=>{"use strict";Object.defineProperty(qi,"__esModule",{value:!0});qi.CancellationTokenSource=qi.CancellationToken=void 0;var ZC=Ir(),XC=Ni(),ru=Fi(),wo;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ru.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:ru.Event.None});function e(t){let r=t;return r&&(r===n.None||r===n.Cancelled||XC.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=e})(wo||(qi.CancellationToken=wo={}));var JC=Object.freeze(function(n,e){let t=(0,ZC.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}}),_o=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?JC:(this._emitter||(this._emitter=new ru.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},iu=class{get token(){return this._token||(this._token=new _o),this._token}cancel(){this._token?this._token.cancel():this._token=wo.Cancelled}dispose(){this._token?this._token instanceof _o&&this._token.dispose():this._token=wo.None}};qi.CancellationTokenSource=iu});var Ph=N(Ai=>{"use strict";Object.defineProperty(Ai,"__esModule",{value:!0});Ai.SharedArrayReceiverStrategy=Ai.SharedArraySenderStrategy=void 0;var YC=So(),Rs;(function(n){n.Continue=0,n.Cancelled=1})(Rs||(Rs={}));var su=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let t=new SharedArrayBuffer(4),r=new Int32Array(t,0,1);r[0]=Rs.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){let r=this.buffers.get(t);if(r===void 0)return;let i=new Int32Array(r,0,1);Atomics.store(i,0,Rs.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};Ai.SharedArraySenderStrategy=su;var ou=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===Rs.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},au=class{constructor(e){this.token=new ou(e)}cancel(){}dispose(){}},cu=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let t=e.$cancellationData;return t===void 0?new YC.CancellationTokenSource:new au(t)}};Ai.SharedArrayReceiverStrategy=cu});var lu=N(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.Semaphore=void 0;var QC=Ir(),uu=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,QC.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};To.Semaphore=uu});var Ih=N(Or=>{"use strict";Object.defineProperty(Or,"__esModule",{value:!0});Or.ReadableStreamMessageReader=Or.AbstractMessageReader=Or.MessageReader=void 0;var fu=Ir(),ji=Ni(),du=Fi(),ew=lu(),kh;(function(n){function e(t){let r=t;return r&&ji.func(r.listen)&&ji.func(r.dispose)&&ji.func(r.onError)&&ji.func(r.onClose)&&ji.func(r.onPartialMessage)}n.is=e})(kh||(Or.MessageReader=kh={}));var Eo=class{constructor(){this.errorEmitter=new du.Emitter,this.closeEmitter=new du.Emitter,this.partialMessageEmitter=new du.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${ji.string(e.message)?e.message:"unknown"}`)}};Or.AbstractMessageReader=Eo;var hu;(function(n){function e(t){let r,i,s,o=new Map,a,c=new Map;if(t===void 0||typeof t=="string")r=t??"utf-8";else{if(r=t.charset??"utf-8",t.contentDecoder!==void 0&&(s=t.contentDecoder,o.set(s.name,s)),t.contentDecoders!==void 0)for(let u of t.contentDecoders)o.set(u.name,u);if(t.contentTypeDecoder!==void 0&&(a=t.contentTypeDecoder,c.set(a.name,a)),t.contentTypeDecoders!==void 0)for(let u of t.contentTypeDecoders)c.set(u.name,u)}return a===void 0&&(a=(0,fu.default)().applicationJson.decoder,c.set(a.name,a)),{charset:r,contentDecoder:s,contentDecoders:o,contentTypeDecoder:a,contentTypeDecoders:c}}n.fromOptions=e})(hu||(hu={}));var pu=class extends Eo{constructor(e,t){super(),this.readable=e,this.options=hu.fromOptions(t),this.buffer=(0,fu.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new ew.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),t}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let r=this.buffer.tryReadHeaders(!0);if(!r)return;let i=r.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(r))}`));return}let s=parseInt(i);if(isNaN(s)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=s}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,i=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(i)}).catch(r=>{this.fireError(r)})}}catch(t){this.fireError(t)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,fu.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};Or.ReadableStreamMessageReader=pu});var Fh=N(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.WriteableStreamMessageWriter=Mr.AbstractMessageWriter=Mr.MessageWriter=void 0;var Oh=Ir(),Ds=Ni(),tw=lu(),Mh=Fi(),nw="Content-Length: ",Nh=`\r
`,Lh;(function(n){function e(t){let r=t;return r&&Ds.func(r.dispose)&&Ds.func(r.onClose)&&Ds.func(r.onError)&&Ds.func(r.write)}n.is=e})(Lh||(Mr.MessageWriter=Lh={}));var Ro=class{constructor(){this.errorEmitter=new Mh.Emitter,this.closeEmitter=new Mh.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${Ds.string(e.message)?e.message:"unknown"}`)}};Mr.AbstractMessageWriter=Ro;var mu;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,Oh.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,Oh.default)().applicationJson.encoder}}n.fromOptions=e})(mu||(mu={}));var gu=class extends Ro{constructor(e,t){super(),this.writable=e,this.options=mu.fromOptions(t),this.errorCount=0,this.writeSemaphore=new tw.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(nw,r.byteLength.toString(),Nh),i.push(Nh),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};Mr.WriteableStreamMessageWriter=gu});var qh=N(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.AbstractMessageBuffer=void 0;var rw=13,iw=10,sw=`\r
`,yu=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,r=0,i=0,s=0;e:for(;r<this._chunks.length;){let u=this._chunks[r];for(i=0;i<u.length;){switch(u[i]){case rw:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case iw:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}s+=u.byteLength,r++}if(t!==4)return;let o=this._read(s+i),a=new Map,c=this.toString(o,"ascii").split(sw);if(c.length<2)return a;for(let u=0;u<c.length-2;u++){let d=c[u],v=d.indexOf(":");if(v===-1)throw new Error(`Message header must separate key and value using ':'
${d}`);let b=d.substr(0,v),g=d.substr(v+1).trim();a.set(e?b.toLowerCase():b,g)}return a}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let s=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(s)}if(this._chunks[0].byteLength>e){let s=this._chunks[0],o=this.asNative(s,e);return this._chunks[0]=s.slice(e),this._totalLength-=e,o}let t=this.allocNative(e),r=0,i=0;for(;e>0;){let s=this._chunks[i];if(s.byteLength>e){let o=s.slice(0,e);t.set(o,r),r+=e,this._chunks[i]=s.slice(e),this._totalLength-=e,e-=e}else t.set(s,r),r+=s.byteLength,this._chunks.shift(),this._totalLength-=s.byteLength,e-=s.byteLength}return t}};Do.AbstractMessageBuffer=yu});var Uh=N(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.createMessageConnection=he.ConnectionOptions=he.MessageStrategy=he.CancellationStrategy=he.CancellationSenderStrategy=he.CancellationReceiverStrategy=he.RequestCancellationReceiverStrategy=he.IdCancellationReceiverStrategy=he.ConnectionStrategy=he.ConnectionError=he.ConnectionErrors=he.LogTraceNotification=he.SetTraceNotification=he.TraceFormat=he.TraceValues=he.Trace=he.NullLogger=he.ProgressType=he.ProgressToken=void 0;var Ah=Ir(),rt=Ni(),ae=Xc(),jh=Yc(),xs=Fi(),vu=So(),Is;(function(n){n.type=new ae.NotificationType("$/cancelRequest")})(Is||(Is={}));var bu;(function(n){function e(t){return typeof t=="string"||typeof t=="number"}n.is=e})(bu||(he.ProgressToken=bu={}));var Ps;(function(n){n.type=new ae.NotificationType("$/progress")})(Ps||(Ps={}));var Cu=class{constructor(){}};he.ProgressType=Cu;var wu;(function(n){function e(t){return rt.func(t)}n.is=e})(wu||(wu={}));he.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var Ne;(function(n){n[n.Off=0]="Off",n[n.Messages=1]="Messages",n[n.Compact=2]="Compact",n[n.Verbose=3]="Verbose"})(Ne||(he.Trace=Ne={}));var Hh;(function(n){n.Off="off",n.Messages="messages",n.Compact="compact",n.Verbose="verbose"})(Hh||(he.TraceValues=Hh={}));(function(n){function e(r){if(!rt.string(r))return n.Off;switch(r=r.toLowerCase(),r){case"off":return n.Off;case"messages":return n.Messages;case"compact":return n.Compact;case"verbose":return n.Verbose;default:return n.Off}}n.fromString=e;function t(r){switch(r){case n.Off:return"off";case n.Messages:return"messages";case n.Compact:return"compact";case n.Verbose:return"verbose";default:return"off"}}n.toString=t})(Ne||(he.Trace=Ne={}));var hn;(function(n){n.Text="text",n.JSON="json"})(hn||(he.TraceFormat=hn={}));(function(n){function e(t){return rt.string(t)?(t=t.toLowerCase(),t==="json"?n.JSON:n.Text):n.Text}n.fromString=e})(hn||(he.TraceFormat=hn={}));var _u;(function(n){n.type=new ae.NotificationType("$/setTrace")})(_u||(he.SetTraceNotification=_u={}));var xo;(function(n){n.type=new ae.NotificationType("$/logTrace")})(xo||(he.LogTraceNotification=xo={}));var ks;(function(n){n[n.Closed=1]="Closed",n[n.Disposed=2]="Disposed",n[n.AlreadyListening=3]="AlreadyListening"})(ks||(he.ConnectionErrors=ks={}));var Hi=class n extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,n.prototype)}};he.ConnectionError=Hi;var Su;(function(n){function e(t){let r=t;return r&&rt.func(r.cancelUndispatched)}n.is=e})(Su||(he.ConnectionStrategy=Su={}));var Po;(function(n){function e(t){let r=t;return r&&(r.kind===void 0||r.kind==="id")&&rt.func(r.createCancellationTokenSource)&&(r.dispose===void 0||rt.func(r.dispose))}n.is=e})(Po||(he.IdCancellationReceiverStrategy=Po={}));var Tu;(function(n){function e(t){let r=t;return r&&r.kind==="request"&&rt.func(r.createCancellationTokenSource)&&(r.dispose===void 0||rt.func(r.dispose))}n.is=e})(Tu||(he.RequestCancellationReceiverStrategy=Tu={}));var ko;(function(n){n.Message=Object.freeze({createCancellationTokenSource(t){return new vu.CancellationTokenSource}});function e(t){return Po.is(t)||Tu.is(t)}n.is=e})(ko||(he.CancellationReceiverStrategy=ko={}));var Io;(function(n){n.Message=Object.freeze({sendCancellation(t,r){return t.sendNotification(Is.type,{id:r})},cleanup(t){}});function e(t){let r=t;return r&&rt.func(r.sendCancellation)&&rt.func(r.cleanup)}n.is=e})(Io||(he.CancellationSenderStrategy=Io={}));var Oo;(function(n){n.Message=Object.freeze({receiver:ko.Message,sender:Io.Message});function e(t){let r=t;return r&&ko.is(r.receiver)&&Io.is(r.sender)}n.is=e})(Oo||(he.CancellationStrategy=Oo={}));var Mo;(function(n){function e(t){let r=t;return r&&rt.func(r.handleMessage)}n.is=e})(Mo||(he.MessageStrategy=Mo={}));var $h;(function(n){function e(t){let r=t;return r&&(Oo.is(r.cancellationStrategy)||Su.is(r.connectionStrategy)||Mo.is(r.messageStrategy))}n.is=e})($h||(he.ConnectionOptions=$h={}));var jn;(function(n){n[n.New=1]="New",n[n.Listening=2]="Listening",n[n.Closed=3]="Closed",n[n.Disposed=4]="Disposed"})(jn||(jn={}));function ow(n,e,t,r){let i=t!==void 0?t:he.NullLogger,s=0,o=0,a=0,c="2.0",u,d=new Map,v,b=new Map,g=new Map,h,w=new jh.LinkedMap,_=new Map,D=new Set,k=new Map,y=Ne.Off,x=hn.Text,O,U=jn.New,F=new xs.Emitter,G=new xs.Emitter,Y=new xs.Emitter,ve=new xs.Emitter,oe=new xs.Emitter,qe=r&&r.cancellationStrategy?r.cancellationStrategy:Oo.Message;function Xe(T){if(T===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+T.toString()}function bt(T){return T===null?"res-unknown-"+(++a).toString():"res-"+T.toString()}function Ct(){return"not-"+(++o).toString()}function yt(T,A){ae.Message.isRequest(A)?T.set(Xe(A.id),A):ae.Message.isResponse(A)?T.set(bt(A.id),A):T.set(Ct(),A)}function Mn(T){}function Kn(){return U===jn.Listening}function Ve(){return U===jn.Closed}function Yt(){return U===jn.Disposed}function Kt(){(U===jn.New||U===jn.Listening)&&(U=jn.Closed,G.fire(void 0))}function It(T){F.fire([T,void 0,void 0])}function Er(T){F.fire(T)}n.onClose(Kt),n.onError(It),e.onClose(Kt),e.onError(Er);function Gn(){h||w.size===0||(h=(0,Ah.default)().timer.setImmediate(()=>{h=void 0,lr()}))}function Vn(T){ae.Message.isRequest(T)?Zn(T):ae.Message.isNotification(T)?Ln(T):ae.Message.isResponse(T)?Nn(T):Xn(T)}function lr(){if(w.size===0)return;let T=w.shift();try{let A=r?.messageStrategy;Mo.is(A)?A.handleMessage(T,Vn):Vn(T)}finally{Gn()}}let Rr=T=>{try{if(ae.Message.isNotification(T)&&T.method===Is.type.method){let A=T.params.id,B=Xe(A),Z=w.get(B);if(ae.Message.isRequest(Z)){let xe=r?.connectionStrategy,Ae=xe&&xe.cancelUndispatched?xe.cancelUndispatched(Z,Mn):void 0;if(Ae&&(Ae.error!==void 0||Ae.result!==void 0)){w.delete(B),k.delete(A),Ae.id=Z.id,Cn(Ae,T.method,Date.now()),e.write(Ae).catch(()=>i.error("Sending response for canceled message failed."));return}}let ke=k.get(A);if(ke!==void 0){ke.cancel(),wn(T);return}else D.add(A)}yt(w,T)}finally{Gn()}};function Zn(T){if(Yt())return;function A(ge,Oe,Se){let ze={jsonrpc:c,id:T.id};ge instanceof ae.ResponseError?ze.error=ge.toJson():ze.result=ge===void 0?null:ge,Cn(ze,Oe,Se),e.write(ze).catch(()=>i.error("Sending response failed."))}function B(ge,Oe,Se){let ze={jsonrpc:c,id:T.id,error:ge.toJson()};Cn(ze,Oe,Se),e.write(ze).catch(()=>i.error("Sending response failed."))}function Z(ge,Oe,Se){ge===void 0&&(ge=null);let ze={jsonrpc:c,id:T.id,result:ge};Cn(ze,Oe,Se),e.write(ze).catch(()=>i.error("Sending response failed."))}Dr(T);let ke=d.get(T.method),xe,Ae;ke&&(xe=ke.type,Ae=ke.handler);let Ue=Date.now();if(Ae||u){let ge=T.id??String(Date.now()),Oe=Po.is(qe.receiver)?qe.receiver.createCancellationTokenSource(ge):qe.receiver.createCancellationTokenSource(T);T.id!==null&&D.has(T.id)&&Oe.cancel(),T.id!==null&&k.set(ge,Oe);try{let Se;if(Ae)if(T.params===void 0){if(xe!==void 0&&xe.numberOfParams!==0){B(new ae.ResponseError(ae.ErrorCodes.InvalidParams,`Request ${T.method} defines ${xe.numberOfParams} params but received none.`),T.method,Ue);return}Se=Ae(Oe.token)}else if(Array.isArray(T.params)){if(xe!==void 0&&xe.parameterStructures===ae.ParameterStructures.byName){B(new ae.ResponseError(ae.ErrorCodes.InvalidParams,`Request ${T.method} defines parameters by name but received parameters by position`),T.method,Ue);return}Se=Ae(...T.params,Oe.token)}else{if(xe!==void 0&&xe.parameterStructures===ae.ParameterStructures.byPosition){B(new ae.ResponseError(ae.ErrorCodes.InvalidParams,`Request ${T.method} defines parameters by position but received parameters by name`),T.method,Ue);return}Se=Ae(T.params,Oe.token)}else u&&(Se=u(T.method,T.params,Oe.token));let ze=Se;Se?ze.then?ze.then(lt=>{k.delete(ge),A(lt,T.method,Ue)},lt=>{k.delete(ge),lt instanceof ae.ResponseError?B(lt,T.method,Ue):lt&&rt.string(lt.message)?B(new ae.ResponseError(ae.ErrorCodes.InternalError,`Request ${T.method} failed with message: ${lt.message}`),T.method,Ue):B(new ae.ResponseError(ae.ErrorCodes.InternalError,`Request ${T.method} failed unexpectedly without providing any details.`),T.method,Ue)}):(k.delete(ge),A(Se,T.method,Ue)):(k.delete(ge),Z(Se,T.method,Ue))}catch(Se){k.delete(ge),Se instanceof ae.ResponseError?A(Se,T.method,Ue):Se&&rt.string(Se.message)?B(new ae.ResponseError(ae.ErrorCodes.InternalError,`Request ${T.method} failed with message: ${Se.message}`),T.method,Ue):B(new ae.ResponseError(ae.ErrorCodes.InternalError,`Request ${T.method} failed unexpectedly without providing any details.`),T.method,Ue)}}else B(new ae.ResponseError(ae.ErrorCodes.MethodNotFound,`Unhandled method ${T.method}`),T.method,Ue)}function Nn(T){if(!Yt())if(T.id===null)T.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(T.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let A=T.id,B=_.get(A);if(Jn(T,B),B!==void 0){_.delete(A);try{if(T.error){let Z=T.error;B.reject(new ae.ResponseError(Z.code,Z.message,Z.data))}else if(T.result!==void 0)B.resolve(T.result);else throw new Error("Should never happen.")}catch(Z){Z.message?i.error(`Response handler '${B.method}' failed with message: ${Z.message}`):i.error(`Response handler '${B.method}' failed unexpectedly.`)}}}}function Ln(T){if(Yt())return;let A,B;if(T.method===Is.type.method){let Z=T.params.id;D.delete(Z),wn(T);return}else{let Z=b.get(T.method);Z&&(B=Z.handler,A=Z.type)}if(B||v)try{if(wn(T),B)if(T.params===void 0)A!==void 0&&A.numberOfParams!==0&&A.parameterStructures!==ae.ParameterStructures.byName&&i.error(`Notification ${T.method} defines ${A.numberOfParams} params but received none.`),B();else if(Array.isArray(T.params)){let Z=T.params;T.method===Ps.type.method&&Z.length===2&&bu.is(Z[0])?B({token:Z[0],value:Z[1]}):(A!==void 0&&(A.parameterStructures===ae.ParameterStructures.byName&&i.error(`Notification ${T.method} defines parameters by name but received parameters by position`),A.numberOfParams!==T.params.length&&i.error(`Notification ${T.method} defines ${A.numberOfParams} params but received ${Z.length} arguments`)),B(...Z))}else A!==void 0&&A.parameterStructures===ae.ParameterStructures.byPosition&&i.error(`Notification ${T.method} defines parameters by position but received parameters by name`),B(T.params);else v&&v(T.method,T.params)}catch(Z){Z.message?i.error(`Notification handler '${T.method}' failed with message: ${Z.message}`):i.error(`Notification handler '${T.method}' failed unexpectedly.`)}else Y.fire(T)}function Xn(T){if(!T){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(T,null,4)}`);let A=T;if(rt.string(A.id)||rt.number(A.id)){let B=A.id,Z=_.get(B);Z&&Z.reject(new Error("The received response has neither a result nor an error property."))}}function wt(T){if(T!=null)switch(y){case Ne.Verbose:return JSON.stringify(T,null,4);case Ne.Compact:return JSON.stringify(T);default:return}}function dr(T){if(!(y===Ne.Off||!O))if(x===hn.Text){let A;(y===Ne.Verbose||y===Ne.Compact)&&T.params&&(A=`Params: ${wt(T.params)}

`),O.log(`Sending request '${T.method} - (${T.id})'.`,A)}else vt("send-request",T)}function Fn(T){if(!(y===Ne.Off||!O))if(x===hn.Text){let A;(y===Ne.Verbose||y===Ne.Compact)&&(T.params?A=`Params: ${wt(T.params)}

`:A=`No parameters provided.

`),O.log(`Sending notification '${T.method}'.`,A)}else vt("send-notification",T)}function Cn(T,A,B){if(!(y===Ne.Off||!O))if(x===hn.Text){let Z;(y===Ne.Verbose||y===Ne.Compact)&&(T.error&&T.error.data?Z=`Error data: ${wt(T.error.data)}

`:T.result?Z=`Result: ${wt(T.result)}

`:T.error===void 0&&(Z=`No result returned.

`)),O.log(`Sending response '${A} - (${T.id})'. Processing request took ${Date.now()-B}ms`,Z)}else vt("send-response",T)}function Dr(T){if(!(y===Ne.Off||!O))if(x===hn.Text){let A;(y===Ne.Verbose||y===Ne.Compact)&&T.params&&(A=`Params: ${wt(T.params)}

`),O.log(`Received request '${T.method} - (${T.id})'.`,A)}else vt("receive-request",T)}function wn(T){if(!(y===Ne.Off||!O||T.method===xo.type.method))if(x===hn.Text){let A;(y===Ne.Verbose||y===Ne.Compact)&&(T.params?A=`Params: ${wt(T.params)}

`:A=`No parameters provided.

`),O.log(`Received notification '${T.method}'.`,A)}else vt("receive-notification",T)}function Jn(T,A){if(!(y===Ne.Off||!O))if(x===hn.Text){let B;if((y===Ne.Verbose||y===Ne.Compact)&&(T.error&&T.error.data?B=`Error data: ${wt(T.error.data)}

`:T.result?B=`Result: ${wt(T.result)}

`:T.error===void 0&&(B=`No result returned.

`)),A){let Z=T.error?` Request failed: ${T.error.message} (${T.error.code}).`:"";O.log(`Received response '${A.method} - (${T.id})' in ${Date.now()-A.timerStart}ms.${Z}`,B)}else O.log(`Received response ${T.id} without active response promise.`,B)}else vt("receive-response",T)}function vt(T,A){if(!O||y===Ne.Off)return;let B={isLSPMessage:!0,type:T,message:A,timestamp:Date.now()};O.log(B)}function qt(){if(Ve())throw new Hi(ks.Closed,"Connection is closed.");if(Yt())throw new Hi(ks.Disposed,"Connection is disposed.")}function Ot(){if(Kn())throw new Hi(ks.AlreadyListening,"Connection is already listening")}function dn(){if(!Kn())throw new Error("Call listen() first.")}function Qt(T){return T===void 0?null:T}function Yn(T){if(T!==null)return T}function fr(T){return T!=null&&!Array.isArray(T)&&typeof T=="object"}function qn(T,A){switch(T){case ae.ParameterStructures.auto:return fr(A)?Yn(A):[Qt(A)];case ae.ParameterStructures.byName:if(!fr(A))throw new Error("Received parameters by name but param is not an object literal.");return Yn(A);case ae.ParameterStructures.byPosition:return[Qt(A)];default:throw new Error(`Unknown parameter structure ${T.toString()}`)}}function hr(T,A){let B,Z=T.numberOfParams;switch(Z){case 0:B=void 0;break;case 1:B=qn(T.parameterStructures,A[0]);break;default:B=[];for(let ke=0;ke<A.length&&ke<Z;ke++)B.push(Qt(A[ke]));if(A.length<Z)for(let ke=A.length;ke<Z;ke++)B.push(null);break}return B}let Gt={sendNotification:(T,...A)=>{qt();let B,Z;if(rt.string(T)){B=T;let xe=A[0],Ae=0,Ue=ae.ParameterStructures.auto;ae.ParameterStructures.is(xe)&&(Ae=1,Ue=xe);let ge=A.length,Oe=ge-Ae;switch(Oe){case 0:Z=void 0;break;case 1:Z=qn(Ue,A[Ae]);break;default:if(Ue===ae.ParameterStructures.byName)throw new Error(`Received ${Oe} parameters for 'by Name' notification parameter structure.`);Z=A.slice(Ae,ge).map(Se=>Qt(Se));break}}else{let xe=A;B=T.method,Z=hr(T,xe)}let ke={jsonrpc:c,method:B,params:Z};return Fn(ke),e.write(ke).catch(xe=>{throw i.error("Sending notification failed."),xe})},onNotification:(T,A)=>{qt();let B;return rt.func(T)?v=T:A&&(rt.string(T)?(B=T,b.set(T,{type:void 0,handler:A})):(B=T.method,b.set(T.method,{type:T,handler:A}))),{dispose:()=>{B!==void 0?b.delete(B):v=void 0}}},onProgress:(T,A,B)=>{if(g.has(A))throw new Error(`Progress handler for token ${A} already registered`);return g.set(A,B),{dispose:()=>{g.delete(A)}}},sendProgress:(T,A,B)=>Gt.sendNotification(Ps.type,{token:A,value:B}),onUnhandledProgress:ve.event,sendRequest:(T,...A)=>{qt(),dn();let B,Z,ke;if(rt.string(T)){B=T;let ge=A[0],Oe=A[A.length-1],Se=0,ze=ae.ParameterStructures.auto;ae.ParameterStructures.is(ge)&&(Se=1,ze=ge);let lt=A.length;vu.CancellationToken.is(Oe)&&(lt=lt-1,ke=Oe);let Rt=lt-Se;switch(Rt){case 0:Z=void 0;break;case 1:Z=qn(ze,A[Se]);break;default:if(ze===ae.ParameterStructures.byName)throw new Error(`Received ${Rt} parameters for 'by Name' request parameter structure.`);Z=A.slice(Se,lt).map(xr=>Qt(xr));break}}else{let ge=A;B=T.method,Z=hr(T,ge);let Oe=T.numberOfParams;ke=vu.CancellationToken.is(ge[Oe])?ge[Oe]:void 0}let xe=s++,Ae;ke&&(Ae=ke.onCancellationRequested(()=>{let ge=qe.sender.sendCancellation(Gt,xe);return ge===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${xe}`),Promise.resolve()):ge.catch(()=>{i.log(`Sending cancellation messages for id ${xe} failed`)})}));let Ue={jsonrpc:c,id:xe,method:B,params:Z};return dr(Ue),typeof qe.sender.enableCancellation=="function"&&qe.sender.enableCancellation(Ue),new Promise(async(ge,Oe)=>{let Se=Rt=>{ge(Rt),qe.sender.cleanup(xe),Ae?.dispose()},ze=Rt=>{Oe(Rt),qe.sender.cleanup(xe),Ae?.dispose()},lt={method:B,timerStart:Date.now(),resolve:Se,reject:ze};try{await e.write(Ue),_.set(xe,lt)}catch(Rt){throw i.error("Sending request failed."),lt.reject(new ae.ResponseError(ae.ErrorCodes.MessageWriteError,Rt.message?Rt.message:"Unknown reason")),Rt}})},onRequest:(T,A)=>{qt();let B=null;return wu.is(T)?(B=void 0,u=T):rt.string(T)?(B=null,A!==void 0&&(B=T,d.set(T,{handler:A,type:void 0}))):A!==void 0&&(B=T.method,d.set(T.method,{type:T,handler:A})),{dispose:()=>{B!==null&&(B!==void 0?d.delete(B):u=void 0)}}},hasPendingResponse:()=>_.size>0,trace:async(T,A,B)=>{let Z=!1,ke=hn.Text;B!==void 0&&(rt.boolean(B)?Z=B:(Z=B.sendNotification||!1,ke=B.traceFormat||hn.Text)),y=T,x=ke,y===Ne.Off?O=void 0:O=A,Z&&!Ve()&&!Yt()&&await Gt.sendNotification(_u.type,{value:Ne.toString(T)})},onError:F.event,onClose:G.event,onUnhandledNotification:Y.event,onDispose:oe.event,end:()=>{e.end()},dispose:()=>{if(Yt())return;U=jn.Disposed,oe.fire(void 0);let T=new ae.ResponseError(ae.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let A of _.values())A.reject(T);_=new Map,k=new Map,D=new Set,w=new jh.LinkedMap,rt.func(e.dispose)&&e.dispose(),rt.func(n.dispose)&&n.dispose()},listen:()=>{qt(),Ot(),U=jn.Listening,n.listen(Rr)},inspect:()=>{(0,Ah.default)().console.log("inspect")}};return Gt.onNotification(xo.type,T=>{if(y===Ne.Off||!O)return;let A=y===Ne.Verbose||y===Ne.Compact;O.log(T.message,A?T.verbose:void 0)}),Gt.onNotification(Ps.type,T=>{let A=g.get(T.token);A?A(T.value):ve.fire(T)}),Gt}he.createMessageConnection=ow});var No=N(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.ProgressType=q.ProgressToken=q.createMessageConnection=q.NullLogger=q.ConnectionOptions=q.ConnectionStrategy=q.AbstractMessageBuffer=q.WriteableStreamMessageWriter=q.AbstractMessageWriter=q.MessageWriter=q.ReadableStreamMessageReader=q.AbstractMessageReader=q.MessageReader=q.SharedArrayReceiverStrategy=q.SharedArraySenderStrategy=q.CancellationToken=q.CancellationTokenSource=q.Emitter=q.Event=q.Disposable=q.LRUCache=q.Touch=q.LinkedMap=q.ParameterStructures=q.NotificationType9=q.NotificationType8=q.NotificationType7=q.NotificationType6=q.NotificationType5=q.NotificationType4=q.NotificationType3=q.NotificationType2=q.NotificationType1=q.NotificationType0=q.NotificationType=q.ErrorCodes=q.ResponseError=q.RequestType9=q.RequestType8=q.RequestType7=q.RequestType6=q.RequestType5=q.RequestType4=q.RequestType3=q.RequestType2=q.RequestType1=q.RequestType0=q.RequestType=q.Message=q.RAL=void 0;q.MessageStrategy=q.CancellationStrategy=q.CancellationSenderStrategy=q.CancellationReceiverStrategy=q.ConnectionError=q.ConnectionErrors=q.LogTraceNotification=q.SetTraceNotification=q.TraceFormat=q.TraceValues=q.Trace=void 0;var Ze=Xc();Object.defineProperty(q,"Message",{enumerable:!0,get:function(){return Ze.Message}});Object.defineProperty(q,"RequestType",{enumerable:!0,get:function(){return Ze.RequestType}});Object.defineProperty(q,"RequestType0",{enumerable:!0,get:function(){return Ze.RequestType0}});Object.defineProperty(q,"RequestType1",{enumerable:!0,get:function(){return Ze.RequestType1}});Object.defineProperty(q,"RequestType2",{enumerable:!0,get:function(){return Ze.RequestType2}});Object.defineProperty(q,"RequestType3",{enumerable:!0,get:function(){return Ze.RequestType3}});Object.defineProperty(q,"RequestType4",{enumerable:!0,get:function(){return Ze.RequestType4}});Object.defineProperty(q,"RequestType5",{enumerable:!0,get:function(){return Ze.RequestType5}});Object.defineProperty(q,"RequestType6",{enumerable:!0,get:function(){return Ze.RequestType6}});Object.defineProperty(q,"RequestType7",{enumerable:!0,get:function(){return Ze.RequestType7}});Object.defineProperty(q,"RequestType8",{enumerable:!0,get:function(){return Ze.RequestType8}});Object.defineProperty(q,"RequestType9",{enumerable:!0,get:function(){return Ze.RequestType9}});Object.defineProperty(q,"ResponseError",{enumerable:!0,get:function(){return Ze.ResponseError}});Object.defineProperty(q,"ErrorCodes",{enumerable:!0,get:function(){return Ze.ErrorCodes}});Object.defineProperty(q,"NotificationType",{enumerable:!0,get:function(){return Ze.NotificationType}});Object.defineProperty(q,"NotificationType0",{enumerable:!0,get:function(){return Ze.NotificationType0}});Object.defineProperty(q,"NotificationType1",{enumerable:!0,get:function(){return Ze.NotificationType1}});Object.defineProperty(q,"NotificationType2",{enumerable:!0,get:function(){return Ze.NotificationType2}});Object.defineProperty(q,"NotificationType3",{enumerable:!0,get:function(){return Ze.NotificationType3}});Object.defineProperty(q,"NotificationType4",{enumerable:!0,get:function(){return Ze.NotificationType4}});Object.defineProperty(q,"NotificationType5",{enumerable:!0,get:function(){return Ze.NotificationType5}});Object.defineProperty(q,"NotificationType6",{enumerable:!0,get:function(){return Ze.NotificationType6}});Object.defineProperty(q,"NotificationType7",{enumerable:!0,get:function(){return Ze.NotificationType7}});Object.defineProperty(q,"NotificationType8",{enumerable:!0,get:function(){return Ze.NotificationType8}});Object.defineProperty(q,"NotificationType9",{enumerable:!0,get:function(){return Ze.NotificationType9}});Object.defineProperty(q,"ParameterStructures",{enumerable:!0,get:function(){return Ze.ParameterStructures}});var Eu=Yc();Object.defineProperty(q,"LinkedMap",{enumerable:!0,get:function(){return Eu.LinkedMap}});Object.defineProperty(q,"LRUCache",{enumerable:!0,get:function(){return Eu.LRUCache}});Object.defineProperty(q,"Touch",{enumerable:!0,get:function(){return Eu.Touch}});var aw=Dh();Object.defineProperty(q,"Disposable",{enumerable:!0,get:function(){return aw.Disposable}});var zh=Fi();Object.defineProperty(q,"Event",{enumerable:!0,get:function(){return zh.Event}});Object.defineProperty(q,"Emitter",{enumerable:!0,get:function(){return zh.Emitter}});var Wh=So();Object.defineProperty(q,"CancellationTokenSource",{enumerable:!0,get:function(){return Wh.CancellationTokenSource}});Object.defineProperty(q,"CancellationToken",{enumerable:!0,get:function(){return Wh.CancellationToken}});var Bh=Ph();Object.defineProperty(q,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return Bh.SharedArraySenderStrategy}});Object.defineProperty(q,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return Bh.SharedArrayReceiverStrategy}});var Ru=Ih();Object.defineProperty(q,"MessageReader",{enumerable:!0,get:function(){return Ru.MessageReader}});Object.defineProperty(q,"AbstractMessageReader",{enumerable:!0,get:function(){return Ru.AbstractMessageReader}});Object.defineProperty(q,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return Ru.ReadableStreamMessageReader}});var Du=Fh();Object.defineProperty(q,"MessageWriter",{enumerable:!0,get:function(){return Du.MessageWriter}});Object.defineProperty(q,"AbstractMessageWriter",{enumerable:!0,get:function(){return Du.AbstractMessageWriter}});Object.defineProperty(q,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return Du.WriteableStreamMessageWriter}});var cw=qh();Object.defineProperty(q,"AbstractMessageBuffer",{enumerable:!0,get:function(){return cw.AbstractMessageBuffer}});var Nt=Uh();Object.defineProperty(q,"ConnectionStrategy",{enumerable:!0,get:function(){return Nt.ConnectionStrategy}});Object.defineProperty(q,"ConnectionOptions",{enumerable:!0,get:function(){return Nt.ConnectionOptions}});Object.defineProperty(q,"NullLogger",{enumerable:!0,get:function(){return Nt.NullLogger}});Object.defineProperty(q,"createMessageConnection",{enumerable:!0,get:function(){return Nt.createMessageConnection}});Object.defineProperty(q,"ProgressToken",{enumerable:!0,get:function(){return Nt.ProgressToken}});Object.defineProperty(q,"ProgressType",{enumerable:!0,get:function(){return Nt.ProgressType}});Object.defineProperty(q,"Trace",{enumerable:!0,get:function(){return Nt.Trace}});Object.defineProperty(q,"TraceValues",{enumerable:!0,get:function(){return Nt.TraceValues}});Object.defineProperty(q,"TraceFormat",{enumerable:!0,get:function(){return Nt.TraceFormat}});Object.defineProperty(q,"SetTraceNotification",{enumerable:!0,get:function(){return Nt.SetTraceNotification}});Object.defineProperty(q,"LogTraceNotification",{enumerable:!0,get:function(){return Nt.LogTraceNotification}});Object.defineProperty(q,"ConnectionErrors",{enumerable:!0,get:function(){return Nt.ConnectionErrors}});Object.defineProperty(q,"ConnectionError",{enumerable:!0,get:function(){return Nt.ConnectionError}});Object.defineProperty(q,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return Nt.CancellationReceiverStrategy}});Object.defineProperty(q,"CancellationSenderStrategy",{enumerable:!0,get:function(){return Nt.CancellationSenderStrategy}});Object.defineProperty(q,"CancellationStrategy",{enumerable:!0,get:function(){return Nt.CancellationStrategy}});Object.defineProperty(q,"MessageStrategy",{enumerable:!0,get:function(){return Nt.MessageStrategy}});var uw=Ir();q.RAL=uw.default});var Vh=N(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:!0});var Kh=require("util"),pr=No(),Lo=class n extends pr.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return n.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new Kh.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}};Lo.emptyBuffer=Buffer.allocUnsafe(0);var xu=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),pr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),pr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),pr.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),pr.Disposable.create(()=>this.stream.off("data",e))}},Pu=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),pr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),pr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),pr.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((r,i)=>{let s=o=>{o==null?r():i(o)};typeof e=="string"?this.stream.write(e,t,s):this.stream.write(e,s)})}end(){this.stream.end()}},Gh=Object.freeze({messageBuffer:Object.freeze({create:n=>new Lo(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(n,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{try{return n instanceof Buffer?Promise.resolve(JSON.parse(n.toString(e.charset))):Promise.resolve(JSON.parse(new Kh.TextDecoder(e.charset).decode(n)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:n=>new xu(n),asWritableStream:n=>new Pu(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){let r=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...e){let t=setImmediate(n,...e);return{dispose:()=>clearImmediate(t)}},setInterval(n,e,...t){let r=setInterval(n,e,...t);return{dispose:()=>clearInterval(r)}}})});function ku(){return Gh}(function(n){function e(){pr.RAL.install(Gh)}n.install=e})(ku||(ku={}));Iu.default=ku});var ni=N(Re=>{"use strict";var lw=Re&&Re.__createBinding||(Object.create?(function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}):(function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]})),dw=Re&&Re.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&lw(e,n,t)};Object.defineProperty(Re,"__esModule",{value:!0});Re.createMessageConnection=Re.createServerSocketTransport=Re.createClientSocketTransport=Re.createServerPipeTransport=Re.createClientPipeTransport=Re.generateRandomPipeName=Re.StreamMessageWriter=Re.StreamMessageReader=Re.SocketMessageWriter=Re.SocketMessageReader=Re.PortMessageWriter=Re.PortMessageReader=Re.IPCMessageWriter=Re.IPCMessageReader=void 0;var $i=Vh();$i.default.install();var Zh=require("path"),fw=require("os"),hw=require("crypto"),Ao=require("net"),pn=No();dw(No(),Re);var Ou=class extends pn.AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),pn.Disposable.create(()=>this.process.off("message",e))}};Re.IPCMessageReader=Ou;var Mu=class extends pn.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0}),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};Re.IPCMessageWriter=Mu;var Nu=class extends pn.AbstractMessageReader{constructor(e){super(),this.onData=new pn.Emitter,e.on("close",()=>this.fireClose),e.on("error",t=>this.fireError(t)),e.on("message",t=>{this.onData.fire(t)})}listen(e){return this.onData.event(e)}};Re.PortMessageReader=Nu;var Lu=class extends pn.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.on("close",()=>this.fireClose()),e.on("error",t=>this.fireError(t))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};Re.PortMessageWriter=Lu;var ei=class extends pn.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,$i.default)().stream.asReadableStream(e),t)}};Re.SocketMessageReader=ei;var ti=class extends pn.WriteableStreamMessageWriter{constructor(e,t){super((0,$i.default)().stream.asWritableStream(e),t),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};Re.SocketMessageWriter=ti;var Fo=class extends pn.ReadableStreamMessageReader{constructor(e,t){super((0,$i.default)().stream.asReadableStream(e),t)}};Re.StreamMessageReader=Fo;var qo=class extends pn.WriteableStreamMessageWriter{constructor(e,t){super((0,$i.default)().stream.asWritableStream(e),t)}};Re.StreamMessageWriter=qo;var Xh=process.env.XDG_RUNTIME_DIR,pw=new Map([["linux",107],["darwin",103]]);function mw(){let n=(0,hw.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${n}-sock`;let e;Xh?e=Zh.join(Xh,`vscode-ipc-${n}.sock`):e=Zh.join(fw.tmpdir(),`vscode-${n}.sock`);let t=pw.get(process.platform);return t!==void 0&&e.length>t&&(0,$i.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${t} characters.`),e}Re.generateRandomPipeName=mw;function gw(n,e="utf-8"){let t,r=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,Ao.createServer)(a=>{o.close(),t([new ei(a,e),new ti(a,e)])});o.on("error",s),o.listen(n,()=>{o.removeListener("error",s),i({onConnected:()=>r})})})}Re.createClientPipeTransport=gw;function yw(n,e="utf-8"){let t=(0,Ao.createConnection)(n);return[new ei(t,e),new ti(t,e)]}Re.createServerPipeTransport=yw;function vw(n,e="utf-8"){let t,r=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,Ao.createServer)(a=>{o.close(),t([new ei(a,e),new ti(a,e)])});o.on("error",s),o.listen(n,"127.0.0.1",()=>{o.removeListener("error",s),i({onConnected:()=>r})})})}Re.createClientSocketTransport=vw;function bw(n,e="utf-8"){let t=(0,Ao.createConnection)(n,"127.0.0.1");return[new ei(t,e),new ti(t,e)]}Re.createServerSocketTransport=bw;function Cw(n){let e=n;return e.read!==void 0&&e.addListener!==void 0}function ww(n){let e=n;return e.write!==void 0&&e.addListener!==void 0}function _w(n,e,t,r){t||(t=pn.NullLogger);let i=Cw(n)?new Fo(n):n,s=ww(e)?new qo(e):e;return pn.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,pn.createMessageConnection)(i,s,t,r)}Re.createMessageConnection=_w});var Fu=N((zR,Jh)=>{"use strict";Jh.exports=ni()});var Ho=N((Yh,jo)=>{(function(n){if(typeof jo=="object"&&typeof jo.exports=="object"){var e=n(require,Yh);e!==void 0&&(jo.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],n)})(function(n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.WorkspaceFolder=e.InlineCompletionContext=e.SelectedCompletionInfo=e.InlineCompletionTriggerKind=e.InlineCompletionList=e.InlineCompletionItem=e.StringValue=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var t;(function(m){function E(R){return typeof R=="string"}m.is=E})(t||(e.DocumentUri=t={}));var r;(function(m){function E(R){return typeof R=="string"}m.is=E})(r||(e.URI=r={}));var i;(function(m){m.MIN_VALUE=-2147483648,m.MAX_VALUE=2147483647;function E(R){return typeof R=="number"&&m.MIN_VALUE<=R&&R<=m.MAX_VALUE}m.is=E})(i||(e.integer=i={}));var s;(function(m){m.MIN_VALUE=0,m.MAX_VALUE=2147483647;function E(R){return typeof R=="number"&&m.MIN_VALUE<=R&&R<=m.MAX_VALUE}m.is=E})(s||(e.uinteger=s={}));var o;(function(m){function E(C,f){return C===Number.MAX_VALUE&&(C=s.MAX_VALUE),f===Number.MAX_VALUE&&(f=s.MAX_VALUE),{line:C,character:f}}m.create=E;function R(C){var f=C;return I.objectLiteral(f)&&I.uinteger(f.line)&&I.uinteger(f.character)}m.is=R})(o||(e.Position=o={}));var a;(function(m){function E(C,f,M,j){if(I.uinteger(C)&&I.uinteger(f)&&I.uinteger(M)&&I.uinteger(j))return{start:o.create(C,f),end:o.create(M,j)};if(o.is(C)&&o.is(f))return{start:C,end:f};throw new Error("Range#create called with invalid arguments[".concat(C,", ").concat(f,", ").concat(M,", ").concat(j,"]"))}m.create=E;function R(C){var f=C;return I.objectLiteral(f)&&o.is(f.start)&&o.is(f.end)}m.is=R})(a||(e.Range=a={}));var c;(function(m){function E(C,f){return{uri:C,range:f}}m.create=E;function R(C){var f=C;return I.objectLiteral(f)&&a.is(f.range)&&(I.string(f.uri)||I.undefined(f.uri))}m.is=R})(c||(e.Location=c={}));var u;(function(m){function E(C,f,M,j){return{targetUri:C,targetRange:f,targetSelectionRange:M,originSelectionRange:j}}m.create=E;function R(C){var f=C;return I.objectLiteral(f)&&a.is(f.targetRange)&&I.string(f.targetUri)&&a.is(f.targetSelectionRange)&&(a.is(f.originSelectionRange)||I.undefined(f.originSelectionRange))}m.is=R})(u||(e.LocationLink=u={}));var d;(function(m){function E(C,f,M,j){return{red:C,green:f,blue:M,alpha:j}}m.create=E;function R(C){var f=C;return I.objectLiteral(f)&&I.numberRange(f.red,0,1)&&I.numberRange(f.green,0,1)&&I.numberRange(f.blue,0,1)&&I.numberRange(f.alpha,0,1)}m.is=R})(d||(e.Color=d={}));var v;(function(m){function E(C,f){return{range:C,color:f}}m.create=E;function R(C){var f=C;return I.objectLiteral(f)&&a.is(f.range)&&d.is(f.color)}m.is=R})(v||(e.ColorInformation=v={}));var b;(function(m){function E(C,f,M){return{label:C,textEdit:f,additionalTextEdits:M}}m.create=E;function R(C){var f=C;return I.objectLiteral(f)&&I.string(f.label)&&(I.undefined(f.textEdit)||O.is(f))&&(I.undefined(f.additionalTextEdits)||I.typedArray(f.additionalTextEdits,O.is))}m.is=R})(b||(e.ColorPresentation=b={}));var g;(function(m){m.Comment="comment",m.Imports="imports",m.Region="region"})(g||(e.FoldingRangeKind=g={}));var h;(function(m){function E(C,f,M,j,le,Qe){var We={startLine:C,endLine:f};return I.defined(M)&&(We.startCharacter=M),I.defined(j)&&(We.endCharacter=j),I.defined(le)&&(We.kind=le),I.defined(Qe)&&(We.collapsedText=Qe),We}m.create=E;function R(C){var f=C;return I.objectLiteral(f)&&I.uinteger(f.startLine)&&I.uinteger(f.startLine)&&(I.undefined(f.startCharacter)||I.uinteger(f.startCharacter))&&(I.undefined(f.endCharacter)||I.uinteger(f.endCharacter))&&(I.undefined(f.kind)||I.string(f.kind))}m.is=R})(h||(e.FoldingRange=h={}));var w;(function(m){function E(C,f){return{location:C,message:f}}m.create=E;function R(C){var f=C;return I.defined(f)&&c.is(f.location)&&I.string(f.message)}m.is=R})(w||(e.DiagnosticRelatedInformation=w={}));var _;(function(m){m.Error=1,m.Warning=2,m.Information=3,m.Hint=4})(_||(e.DiagnosticSeverity=_={}));var D;(function(m){m.Unnecessary=1,m.Deprecated=2})(D||(e.DiagnosticTag=D={}));var k;(function(m){function E(R){var C=R;return I.objectLiteral(C)&&I.string(C.href)}m.is=E})(k||(e.CodeDescription=k={}));var y;(function(m){function E(C,f,M,j,le,Qe){var We={range:C,message:f};return I.defined(M)&&(We.severity=M),I.defined(j)&&(We.code=j),I.defined(le)&&(We.source=le),I.defined(Qe)&&(We.relatedInformation=Qe),We}m.create=E;function R(C){var f,M=C;return I.defined(M)&&a.is(M.range)&&I.string(M.message)&&(I.number(M.severity)||I.undefined(M.severity))&&(I.integer(M.code)||I.string(M.code)||I.undefined(M.code))&&(I.undefined(M.codeDescription)||I.string((f=M.codeDescription)===null||f===void 0?void 0:f.href))&&(I.string(M.source)||I.undefined(M.source))&&(I.undefined(M.relatedInformation)||I.typedArray(M.relatedInformation,w.is))}m.is=R})(y||(e.Diagnostic=y={}));var x;(function(m){function E(C,f){for(var M=[],j=2;j<arguments.length;j++)M[j-2]=arguments[j];var le={title:C,command:f};return I.defined(M)&&M.length>0&&(le.arguments=M),le}m.create=E;function R(C){var f=C;return I.defined(f)&&I.string(f.title)&&I.string(f.command)}m.is=R})(x||(e.Command=x={}));var O;(function(m){function E(M,j){return{range:M,newText:j}}m.replace=E;function R(M,j){return{range:{start:M,end:M},newText:j}}m.insert=R;function C(M){return{range:M,newText:""}}m.del=C;function f(M){var j=M;return I.objectLiteral(j)&&I.string(j.newText)&&a.is(j.range)}m.is=f})(O||(e.TextEdit=O={}));var U;(function(m){function E(C,f,M){var j={label:C};return f!==void 0&&(j.needsConfirmation=f),M!==void 0&&(j.description=M),j}m.create=E;function R(C){var f=C;return I.objectLiteral(f)&&I.string(f.label)&&(I.boolean(f.needsConfirmation)||f.needsConfirmation===void 0)&&(I.string(f.description)||f.description===void 0)}m.is=R})(U||(e.ChangeAnnotation=U={}));var F;(function(m){function E(R){var C=R;return I.string(C)}m.is=E})(F||(e.ChangeAnnotationIdentifier=F={}));var G;(function(m){function E(M,j,le){return{range:M,newText:j,annotationId:le}}m.replace=E;function R(M,j,le){return{range:{start:M,end:M},newText:j,annotationId:le}}m.insert=R;function C(M,j){return{range:M,newText:"",annotationId:j}}m.del=C;function f(M){var j=M;return O.is(j)&&(U.is(j.annotationId)||F.is(j.annotationId))}m.is=f})(G||(e.AnnotatedTextEdit=G={}));var Y;(function(m){function E(C,f){return{textDocument:C,edits:f}}m.create=E;function R(C){var f=C;return I.defined(f)&&Ve.is(f.textDocument)&&Array.isArray(f.edits)}m.is=R})(Y||(e.TextDocumentEdit=Y={}));var ve;(function(m){function E(C,f,M){var j={kind:"create",uri:C};return f!==void 0&&(f.overwrite!==void 0||f.ignoreIfExists!==void 0)&&(j.options=f),M!==void 0&&(j.annotationId=M),j}m.create=E;function R(C){var f=C;return f&&f.kind==="create"&&I.string(f.uri)&&(f.options===void 0||(f.options.overwrite===void 0||I.boolean(f.options.overwrite))&&(f.options.ignoreIfExists===void 0||I.boolean(f.options.ignoreIfExists)))&&(f.annotationId===void 0||F.is(f.annotationId))}m.is=R})(ve||(e.CreateFile=ve={}));var oe;(function(m){function E(C,f,M,j){var le={kind:"rename",oldUri:C,newUri:f};return M!==void 0&&(M.overwrite!==void 0||M.ignoreIfExists!==void 0)&&(le.options=M),j!==void 0&&(le.annotationId=j),le}m.create=E;function R(C){var f=C;return f&&f.kind==="rename"&&I.string(f.oldUri)&&I.string(f.newUri)&&(f.options===void 0||(f.options.overwrite===void 0||I.boolean(f.options.overwrite))&&(f.options.ignoreIfExists===void 0||I.boolean(f.options.ignoreIfExists)))&&(f.annotationId===void 0||F.is(f.annotationId))}m.is=R})(oe||(e.RenameFile=oe={}));var qe;(function(m){function E(C,f,M){var j={kind:"delete",uri:C};return f!==void 0&&(f.recursive!==void 0||f.ignoreIfNotExists!==void 0)&&(j.options=f),M!==void 0&&(j.annotationId=M),j}m.create=E;function R(C){var f=C;return f&&f.kind==="delete"&&I.string(f.uri)&&(f.options===void 0||(f.options.recursive===void 0||I.boolean(f.options.recursive))&&(f.options.ignoreIfNotExists===void 0||I.boolean(f.options.ignoreIfNotExists)))&&(f.annotationId===void 0||F.is(f.annotationId))}m.is=R})(qe||(e.DeleteFile=qe={}));var Xe;(function(m){function E(R){var C=R;return C&&(C.changes!==void 0||C.documentChanges!==void 0)&&(C.documentChanges===void 0||C.documentChanges.every(function(f){return I.string(f.kind)?ve.is(f)||oe.is(f)||qe.is(f):Y.is(f)}))}m.is=E})(Xe||(e.WorkspaceEdit=Xe={}));var bt=(function(){function m(E,R){this.edits=E,this.changeAnnotations=R}return m.prototype.insert=function(E,R,C){var f,M;if(C===void 0?f=O.insert(E,R):F.is(C)?(M=C,f=G.insert(E,R,C)):(this.assertChangeAnnotations(this.changeAnnotations),M=this.changeAnnotations.manage(C),f=G.insert(E,R,M)),this.edits.push(f),M!==void 0)return M},m.prototype.replace=function(E,R,C){var f,M;if(C===void 0?f=O.replace(E,R):F.is(C)?(M=C,f=G.replace(E,R,C)):(this.assertChangeAnnotations(this.changeAnnotations),M=this.changeAnnotations.manage(C),f=G.replace(E,R,M)),this.edits.push(f),M!==void 0)return M},m.prototype.delete=function(E,R){var C,f;if(R===void 0?C=O.del(E):F.is(R)?(f=R,C=G.del(E,R)):(this.assertChangeAnnotations(this.changeAnnotations),f=this.changeAnnotations.manage(R),C=G.del(E,f)),this.edits.push(C),f!==void 0)return f},m.prototype.add=function(E){this.edits.push(E)},m.prototype.all=function(){return this.edits},m.prototype.clear=function(){this.edits.splice(0,this.edits.length)},m.prototype.assertChangeAnnotations=function(E){if(E===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},m})(),Ct=(function(){function m(E){this._annotations=E===void 0?Object.create(null):E,this._counter=0,this._size=0}return m.prototype.all=function(){return this._annotations},Object.defineProperty(m.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),m.prototype.manage=function(E,R){var C;if(F.is(E)?C=E:(C=this.nextId(),R=E),this._annotations[C]!==void 0)throw new Error("Id ".concat(C," is already in use."));if(R===void 0)throw new Error("No annotation provided for id ".concat(C));return this._annotations[C]=R,this._size++,C},m.prototype.nextId=function(){return this._counter++,this._counter.toString()},m})(),yt=(function(){function m(E){var R=this;this._textEditChanges=Object.create(null),E!==void 0?(this._workspaceEdit=E,E.documentChanges?(this._changeAnnotations=new Ct(E.changeAnnotations),E.changeAnnotations=this._changeAnnotations.all(),E.documentChanges.forEach(function(C){if(Y.is(C)){var f=new bt(C.edits,R._changeAnnotations);R._textEditChanges[C.textDocument.uri]=f}})):E.changes&&Object.keys(E.changes).forEach(function(C){var f=new bt(E.changes[C]);R._textEditChanges[C]=f})):this._workspaceEdit={}}return Object.defineProperty(m.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),m.prototype.getTextEditChange=function(E){if(Ve.is(E)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var R={uri:E.uri,version:E.version},C=this._textEditChanges[R.uri];if(!C){var f=[],M={textDocument:R,edits:f};this._workspaceEdit.documentChanges.push(M),C=new bt(f,this._changeAnnotations),this._textEditChanges[R.uri]=C}return C}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var C=this._textEditChanges[E];if(!C){var f=[];this._workspaceEdit.changes[E]=f,C=new bt(f),this._textEditChanges[E]=C}return C}},m.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new Ct,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},m.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},m.prototype.createFile=function(E,R,C){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var f;U.is(R)||F.is(R)?f=R:C=R;var M,j;if(f===void 0?M=ve.create(E,C):(j=F.is(f)?f:this._changeAnnotations.manage(f),M=ve.create(E,C,j)),this._workspaceEdit.documentChanges.push(M),j!==void 0)return j},m.prototype.renameFile=function(E,R,C,f){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var M;U.is(C)||F.is(C)?M=C:f=C;var j,le;if(M===void 0?j=oe.create(E,R,f):(le=F.is(M)?M:this._changeAnnotations.manage(M),j=oe.create(E,R,f,le)),this._workspaceEdit.documentChanges.push(j),le!==void 0)return le},m.prototype.deleteFile=function(E,R,C){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var f;U.is(R)||F.is(R)?f=R:C=R;var M,j;if(f===void 0?M=qe.create(E,C):(j=F.is(f)?f:this._changeAnnotations.manage(f),M=qe.create(E,C,j)),this._workspaceEdit.documentChanges.push(M),j!==void 0)return j},m})();e.WorkspaceChange=yt;var Mn;(function(m){function E(C){return{uri:C}}m.create=E;function R(C){var f=C;return I.defined(f)&&I.string(f.uri)}m.is=R})(Mn||(e.TextDocumentIdentifier=Mn={}));var Kn;(function(m){function E(C,f){return{uri:C,version:f}}m.create=E;function R(C){var f=C;return I.defined(f)&&I.string(f.uri)&&I.integer(f.version)}m.is=R})(Kn||(e.VersionedTextDocumentIdentifier=Kn={}));var Ve;(function(m){function E(C,f){return{uri:C,version:f}}m.create=E;function R(C){var f=C;return I.defined(f)&&I.string(f.uri)&&(f.version===null||I.integer(f.version))}m.is=R})(Ve||(e.OptionalVersionedTextDocumentIdentifier=Ve={}));var Yt;(function(m){function E(C,f,M,j){return{uri:C,languageId:f,version:M,text:j}}m.create=E;function R(C){var f=C;return I.defined(f)&&I.string(f.uri)&&I.string(f.languageId)&&I.integer(f.version)&&I.string(f.text)}m.is=R})(Yt||(e.TextDocumentItem=Yt={}));var Kt;(function(m){m.PlainText="plaintext",m.Markdown="markdown";function E(R){var C=R;return C===m.PlainText||C===m.Markdown}m.is=E})(Kt||(e.MarkupKind=Kt={}));var It;(function(m){function E(R){var C=R;return I.objectLiteral(R)&&Kt.is(C.kind)&&I.string(C.value)}m.is=E})(It||(e.MarkupContent=It={}));var Er;(function(m){m.Text=1,m.Method=2,m.Function=3,m.Constructor=4,m.Field=5,m.Variable=6,m.Class=7,m.Interface=8,m.Module=9,m.Property=10,m.Unit=11,m.Value=12,m.Enum=13,m.Keyword=14,m.Snippet=15,m.Color=16,m.File=17,m.Reference=18,m.Folder=19,m.EnumMember=20,m.Constant=21,m.Struct=22,m.Event=23,m.Operator=24,m.TypeParameter=25})(Er||(e.CompletionItemKind=Er={}));var Gn;(function(m){m.PlainText=1,m.Snippet=2})(Gn||(e.InsertTextFormat=Gn={}));var Vn;(function(m){m.Deprecated=1})(Vn||(e.CompletionItemTag=Vn={}));var lr;(function(m){function E(C,f,M){return{newText:C,insert:f,replace:M}}m.create=E;function R(C){var f=C;return f&&I.string(f.newText)&&a.is(f.insert)&&a.is(f.replace)}m.is=R})(lr||(e.InsertReplaceEdit=lr={}));var Rr;(function(m){m.asIs=1,m.adjustIndentation=2})(Rr||(e.InsertTextMode=Rr={}));var Zn;(function(m){function E(R){var C=R;return C&&(I.string(C.detail)||C.detail===void 0)&&(I.string(C.description)||C.description===void 0)}m.is=E})(Zn||(e.CompletionItemLabelDetails=Zn={}));var Nn;(function(m){function E(R){return{label:R}}m.create=E})(Nn||(e.CompletionItem=Nn={}));var Ln;(function(m){function E(R,C){return{items:R||[],isIncomplete:!!C}}m.create=E})(Ln||(e.CompletionList=Ln={}));var Xn;(function(m){function E(C){return C.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}m.fromPlainText=E;function R(C){var f=C;return I.string(f)||I.objectLiteral(f)&&I.string(f.language)&&I.string(f.value)}m.is=R})(Xn||(e.MarkedString=Xn={}));var wt;(function(m){function E(R){var C=R;return!!C&&I.objectLiteral(C)&&(It.is(C.contents)||Xn.is(C.contents)||I.typedArray(C.contents,Xn.is))&&(R.range===void 0||a.is(R.range))}m.is=E})(wt||(e.Hover=wt={}));var dr;(function(m){function E(R,C){return C?{label:R,documentation:C}:{label:R}}m.create=E})(dr||(e.ParameterInformation=dr={}));var Fn;(function(m){function E(R,C){for(var f=[],M=2;M<arguments.length;M++)f[M-2]=arguments[M];var j={label:R};return I.defined(C)&&(j.documentation=C),I.defined(f)?j.parameters=f:j.parameters=[],j}m.create=E})(Fn||(e.SignatureInformation=Fn={}));var Cn;(function(m){m.Text=1,m.Read=2,m.Write=3})(Cn||(e.DocumentHighlightKind=Cn={}));var Dr;(function(m){function E(R,C){var f={range:R};return I.number(C)&&(f.kind=C),f}m.create=E})(Dr||(e.DocumentHighlight=Dr={}));var wn;(function(m){m.File=1,m.Module=2,m.Namespace=3,m.Package=4,m.Class=5,m.Method=6,m.Property=7,m.Field=8,m.Constructor=9,m.Enum=10,m.Interface=11,m.Function=12,m.Variable=13,m.Constant=14,m.String=15,m.Number=16,m.Boolean=17,m.Array=18,m.Object=19,m.Key=20,m.Null=21,m.EnumMember=22,m.Struct=23,m.Event=24,m.Operator=25,m.TypeParameter=26})(wn||(e.SymbolKind=wn={}));var Jn;(function(m){m.Deprecated=1})(Jn||(e.SymbolTag=Jn={}));var vt;(function(m){function E(R,C,f,M,j){var le={name:R,kind:C,location:{uri:M,range:f}};return j&&(le.containerName=j),le}m.create=E})(vt||(e.SymbolInformation=vt={}));var qt;(function(m){function E(R,C,f,M){return M!==void 0?{name:R,kind:C,location:{uri:f,range:M}}:{name:R,kind:C,location:{uri:f}}}m.create=E})(qt||(e.WorkspaceSymbol=qt={}));var Ot;(function(m){function E(C,f,M,j,le,Qe){var We={name:C,detail:f,kind:M,range:j,selectionRange:le};return Qe!==void 0&&(We.children=Qe),We}m.create=E;function R(C){var f=C;return f&&I.string(f.name)&&I.number(f.kind)&&a.is(f.range)&&a.is(f.selectionRange)&&(f.detail===void 0||I.string(f.detail))&&(f.deprecated===void 0||I.boolean(f.deprecated))&&(f.children===void 0||Array.isArray(f.children))&&(f.tags===void 0||Array.isArray(f.tags))}m.is=R})(Ot||(e.DocumentSymbol=Ot={}));var dn;(function(m){m.Empty="",m.QuickFix="quickfix",m.Refactor="refactor",m.RefactorExtract="refactor.extract",m.RefactorInline="refactor.inline",m.RefactorRewrite="refactor.rewrite",m.Source="source",m.SourceOrganizeImports="source.organizeImports",m.SourceFixAll="source.fixAll"})(dn||(e.CodeActionKind=dn={}));var Qt;(function(m){m.Invoked=1,m.Automatic=2})(Qt||(e.CodeActionTriggerKind=Qt={}));var Yn;(function(m){function E(C,f,M){var j={diagnostics:C};return f!=null&&(j.only=f),M!=null&&(j.triggerKind=M),j}m.create=E;function R(C){var f=C;return I.defined(f)&&I.typedArray(f.diagnostics,y.is)&&(f.only===void 0||I.typedArray(f.only,I.string))&&(f.triggerKind===void 0||f.triggerKind===Qt.Invoked||f.triggerKind===Qt.Automatic)}m.is=R})(Yn||(e.CodeActionContext=Yn={}));var fr;(function(m){function E(C,f,M){var j={title:C},le=!0;return typeof f=="string"?(le=!1,j.kind=f):x.is(f)?j.command=f:j.edit=f,le&&M!==void 0&&(j.kind=M),j}m.create=E;function R(C){var f=C;return f&&I.string(f.title)&&(f.diagnostics===void 0||I.typedArray(f.diagnostics,y.is))&&(f.kind===void 0||I.string(f.kind))&&(f.edit!==void 0||f.command!==void 0)&&(f.command===void 0||x.is(f.command))&&(f.isPreferred===void 0||I.boolean(f.isPreferred))&&(f.edit===void 0||Xe.is(f.edit))}m.is=R})(fr||(e.CodeAction=fr={}));var qn;(function(m){function E(C,f){var M={range:C};return I.defined(f)&&(M.data=f),M}m.create=E;function R(C){var f=C;return I.defined(f)&&a.is(f.range)&&(I.undefined(f.command)||x.is(f.command))}m.is=R})(qn||(e.CodeLens=qn={}));var hr;(function(m){function E(C,f){return{tabSize:C,insertSpaces:f}}m.create=E;function R(C){var f=C;return I.defined(f)&&I.uinteger(f.tabSize)&&I.boolean(f.insertSpaces)}m.is=R})(hr||(e.FormattingOptions=hr={}));var Gt;(function(m){function E(C,f,M){return{range:C,target:f,data:M}}m.create=E;function R(C){var f=C;return I.defined(f)&&a.is(f.range)&&(I.undefined(f.target)||I.string(f.target))}m.is=R})(Gt||(e.DocumentLink=Gt={}));var T;(function(m){function E(C,f){return{range:C,parent:f}}m.create=E;function R(C){var f=C;return I.objectLiteral(f)&&a.is(f.range)&&(f.parent===void 0||m.is(f.parent))}m.is=R})(T||(e.SelectionRange=T={}));var A;(function(m){m.namespace="namespace",m.type="type",m.class="class",m.enum="enum",m.interface="interface",m.struct="struct",m.typeParameter="typeParameter",m.parameter="parameter",m.variable="variable",m.property="property",m.enumMember="enumMember",m.event="event",m.function="function",m.method="method",m.macro="macro",m.keyword="keyword",m.modifier="modifier",m.comment="comment",m.string="string",m.number="number",m.regexp="regexp",m.operator="operator",m.decorator="decorator"})(A||(e.SemanticTokenTypes=A={}));var B;(function(m){m.declaration="declaration",m.definition="definition",m.readonly="readonly",m.static="static",m.deprecated="deprecated",m.abstract="abstract",m.async="async",m.modification="modification",m.documentation="documentation",m.defaultLibrary="defaultLibrary"})(B||(e.SemanticTokenModifiers=B={}));var Z;(function(m){function E(R){var C=R;return I.objectLiteral(C)&&(C.resultId===void 0||typeof C.resultId=="string")&&Array.isArray(C.data)&&(C.data.length===0||typeof C.data[0]=="number")}m.is=E})(Z||(e.SemanticTokens=Z={}));var ke;(function(m){function E(C,f){return{range:C,text:f}}m.create=E;function R(C){var f=C;return f!=null&&a.is(f.range)&&I.string(f.text)}m.is=R})(ke||(e.InlineValueText=ke={}));var xe;(function(m){function E(C,f,M){return{range:C,variableName:f,caseSensitiveLookup:M}}m.create=E;function R(C){var f=C;return f!=null&&a.is(f.range)&&I.boolean(f.caseSensitiveLookup)&&(I.string(f.variableName)||f.variableName===void 0)}m.is=R})(xe||(e.InlineValueVariableLookup=xe={}));var Ae;(function(m){function E(C,f){return{range:C,expression:f}}m.create=E;function R(C){var f=C;return f!=null&&a.is(f.range)&&(I.string(f.expression)||f.expression===void 0)}m.is=R})(Ae||(e.InlineValueEvaluatableExpression=Ae={}));var Ue;(function(m){function E(C,f){return{frameId:C,stoppedLocation:f}}m.create=E;function R(C){var f=C;return I.defined(f)&&a.is(C.stoppedLocation)}m.is=R})(Ue||(e.InlineValueContext=Ue={}));var ge;(function(m){m.Type=1,m.Parameter=2;function E(R){return R===1||R===2}m.is=E})(ge||(e.InlayHintKind=ge={}));var Oe;(function(m){function E(C){return{value:C}}m.create=E;function R(C){var f=C;return I.objectLiteral(f)&&(f.tooltip===void 0||I.string(f.tooltip)||It.is(f.tooltip))&&(f.location===void 0||c.is(f.location))&&(f.command===void 0||x.is(f.command))}m.is=R})(Oe||(e.InlayHintLabelPart=Oe={}));var Se;(function(m){function E(C,f,M){var j={position:C,label:f};return M!==void 0&&(j.kind=M),j}m.create=E;function R(C){var f=C;return I.objectLiteral(f)&&o.is(f.position)&&(I.string(f.label)||I.typedArray(f.label,Oe.is))&&(f.kind===void 0||ge.is(f.kind))&&f.textEdits===void 0||I.typedArray(f.textEdits,O.is)&&(f.tooltip===void 0||I.string(f.tooltip)||It.is(f.tooltip))&&(f.paddingLeft===void 0||I.boolean(f.paddingLeft))&&(f.paddingRight===void 0||I.boolean(f.paddingRight))}m.is=R})(Se||(e.InlayHint=Se={}));var ze;(function(m){function E(R){return{kind:"snippet",value:R}}m.createSnippet=E})(ze||(e.StringValue=ze={}));var lt;(function(m){function E(R,C,f,M){return{insertText:R,filterText:C,range:f,command:M}}m.create=E})(lt||(e.InlineCompletionItem=lt={}));var Rt;(function(m){function E(R){return{items:R}}m.create=E})(Rt||(e.InlineCompletionList=Rt={}));var xr;(function(m){m.Invoked=0,m.Automatic=1})(xr||(e.InlineCompletionTriggerKind=xr={}));var Pr;(function(m){function E(R,C){return{range:R,text:C}}m.create=E})(Pr||(e.SelectedCompletionInfo=Pr={}));var p;(function(m){function E(R,C){return{triggerKind:R,selectedCompletionInfo:C}}m.create=E})(p||(e.InlineCompletionContext=p={}));var L;(function(m){function E(R){var C=R;return I.objectLiteral(C)&&r.is(C.uri)&&I.string(C.name)}m.is=E})(L||(e.WorkspaceFolder=L={})),e.EOL=[`
`,`\r
`,"\r"];var te;(function(m){function E(M,j,le,Qe){return new Me(M,j,le,Qe)}m.create=E;function R(M){var j=M;return!!(I.defined(j)&&I.string(j.uri)&&(I.undefined(j.languageId)||I.string(j.languageId))&&I.uinteger(j.lineCount)&&I.func(j.getText)&&I.func(j.positionAt)&&I.func(j.offsetAt))}m.is=R;function C(M,j){for(var le=M.getText(),Qe=f(j,function(Qn,l){var P=Qn.range.start.line-l.range.start.line;return P===0?Qn.range.start.character-l.range.start.character:P}),We=le.length,en=Qe.length-1;en>=0;en--){var fn=Qe[en],An=M.offsetAt(fn.range.start),we=M.offsetAt(fn.range.end);if(we<=We)le=le.substring(0,An)+fn.newText+le.substring(we,le.length);else throw new Error("Overlapping edit");We=An}return le}m.applyEdits=C;function f(M,j){if(M.length<=1)return M;var le=M.length/2|0,Qe=M.slice(0,le),We=M.slice(le);f(Qe,j),f(We,j);for(var en=0,fn=0,An=0;en<Qe.length&&fn<We.length;){var we=j(Qe[en],We[fn]);we<=0?M[An++]=Qe[en++]:M[An++]=We[fn++]}for(;en<Qe.length;)M[An++]=Qe[en++];for(;fn<We.length;)M[An++]=We[fn++];return M}})(te||(e.TextDocument=te={}));var Me=(function(){function m(E,R,C,f){this._uri=E,this._languageId=R,this._version=C,this._content=f,this._lineOffsets=void 0}return Object.defineProperty(m.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),m.prototype.getText=function(E){if(E){var R=this.offsetAt(E.start),C=this.offsetAt(E.end);return this._content.substring(R,C)}return this._content},m.prototype.update=function(E,R){this._content=E.text,this._version=R,this._lineOffsets=void 0},m.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var E=[],R=this._content,C=!0,f=0;f<R.length;f++){C&&(E.push(f),C=!1);var M=R.charAt(f);C=M==="\r"||M===`
`,M==="\r"&&f+1<R.length&&R.charAt(f+1)===`
`&&f++}C&&R.length>0&&E.push(R.length),this._lineOffsets=E}return this._lineOffsets},m.prototype.positionAt=function(E){E=Math.max(Math.min(E,this._content.length),0);var R=this.getLineOffsets(),C=0,f=R.length;if(f===0)return o.create(0,E);for(;C<f;){var M=Math.floor((C+f)/2);R[M]>E?f=M:C=M+1}var j=C-1;return o.create(j,E-R[j])},m.prototype.offsetAt=function(E){var R=this.getLineOffsets();if(E.line>=R.length)return this._content.length;if(E.line<0)return 0;var C=R[E.line],f=E.line+1<R.length?R[E.line+1]:this._content.length;return Math.max(Math.min(C+E.character,f),C)},Object.defineProperty(m.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),m})(),I;(function(m){var E=Object.prototype.toString;function R(we){return typeof we<"u"}m.defined=R;function C(we){return typeof we>"u"}m.undefined=C;function f(we){return we===!0||we===!1}m.boolean=f;function M(we){return E.call(we)==="[object String]"}m.string=M;function j(we){return E.call(we)==="[object Number]"}m.number=j;function le(we,Qn,l){return E.call(we)==="[object Number]"&&Qn<=we&&we<=l}m.numberRange=le;function Qe(we){return E.call(we)==="[object Number]"&&-2147483648<=we&&we<=2147483647}m.integer=Qe;function We(we){return E.call(we)==="[object Number]"&&0<=we&&we<=2147483647}m.uinteger=We;function en(we){return E.call(we)==="[object Function]"}m.func=en;function fn(we){return we!==null&&typeof we=="object"}m.objectLiteral=fn;function An(we,Qn){return Array.isArray(we)&&we.every(Qn)}m.typedArray=An})(I||(I={}))})});var et=N(nn=>{"use strict";Object.defineProperty(nn,"__esModule",{value:!0});nn.ProtocolNotificationType=nn.ProtocolNotificationType0=nn.ProtocolRequestType=nn.ProtocolRequestType0=nn.RegistrationType=nn.MessageDirection=void 0;var Ui=ni(),Qh;(function(n){n.clientToServer="clientToServer",n.serverToClient="serverToClient",n.both="both"})(Qh||(nn.MessageDirection=Qh={}));var qu=class{constructor(e){this.method=e}};nn.RegistrationType=qu;var Au=class extends Ui.RequestType0{constructor(e){super(e)}};nn.ProtocolRequestType0=Au;var ju=class extends Ui.RequestType{constructor(e){super(e,Ui.ParameterStructures.byName)}};nn.ProtocolRequestType=ju;var Hu=class extends Ui.NotificationType0{constructor(e){super(e)}};nn.ProtocolNotificationType0=Hu;var $u=class extends Ui.NotificationType{constructor(e){super(e,Ui.ParameterStructures.byName)}};nn.ProtocolNotificationType=$u});var $o=N(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.objectLiteral=_t.typedArray=_t.stringArray=_t.array=_t.func=_t.error=_t.number=_t.string=_t.boolean=void 0;function Sw(n){return n===!0||n===!1}_t.boolean=Sw;function ep(n){return typeof n=="string"||n instanceof String}_t.string=ep;function Tw(n){return typeof n=="number"||n instanceof Number}_t.number=Tw;function Ew(n){return n instanceof Error}_t.error=Ew;function Rw(n){return typeof n=="function"}_t.func=Rw;function tp(n){return Array.isArray(n)}_t.array=tp;function Dw(n){return tp(n)&&n.every(e=>ep(e))}_t.stringArray=Dw;function xw(n,e){return Array.isArray(n)&&n.every(e)}_t.typedArray=xw;function Pw(n){return n!==null&&typeof n=="object"}_t.objectLiteral=Pw});var ip=N(Uo=>{"use strict";Object.defineProperty(Uo,"__esModule",{value:!0});Uo.ImplementationRequest=void 0;var np=et(),rp;(function(n){n.method="textDocument/implementation",n.messageDirection=np.MessageDirection.clientToServer,n.type=new np.ProtocolRequestType(n.method)})(rp||(Uo.ImplementationRequest=rp={}))});var ap=N(zo=>{"use strict";Object.defineProperty(zo,"__esModule",{value:!0});zo.TypeDefinitionRequest=void 0;var sp=et(),op;(function(n){n.method="textDocument/typeDefinition",n.messageDirection=sp.MessageDirection.clientToServer,n.type=new sp.ProtocolRequestType(n.method)})(op||(zo.TypeDefinitionRequest=op={}))});var lp=N(zi=>{"use strict";Object.defineProperty(zi,"__esModule",{value:!0});zi.DidChangeWorkspaceFoldersNotification=zi.WorkspaceFoldersRequest=void 0;var Wo=et(),cp;(function(n){n.method="workspace/workspaceFolders",n.messageDirection=Wo.MessageDirection.serverToClient,n.type=new Wo.ProtocolRequestType0(n.method)})(cp||(zi.WorkspaceFoldersRequest=cp={}));var up;(function(n){n.method="workspace/didChangeWorkspaceFolders",n.messageDirection=Wo.MessageDirection.clientToServer,n.type=new Wo.ProtocolNotificationType(n.method)})(up||(zi.DidChangeWorkspaceFoldersNotification=up={}))});var hp=N(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.ConfigurationRequest=void 0;var dp=et(),fp;(function(n){n.method="workspace/configuration",n.messageDirection=dp.MessageDirection.serverToClient,n.type=new dp.ProtocolRequestType(n.method)})(fp||(Bo.ConfigurationRequest=fp={}))});var gp=N(Wi=>{"use strict";Object.defineProperty(Wi,"__esModule",{value:!0});Wi.ColorPresentationRequest=Wi.DocumentColorRequest=void 0;var Ko=et(),pp;(function(n){n.method="textDocument/documentColor",n.messageDirection=Ko.MessageDirection.clientToServer,n.type=new Ko.ProtocolRequestType(n.method)})(pp||(Wi.DocumentColorRequest=pp={}));var mp;(function(n){n.method="textDocument/colorPresentation",n.messageDirection=Ko.MessageDirection.clientToServer,n.type=new Ko.ProtocolRequestType(n.method)})(mp||(Wi.ColorPresentationRequest=mp={}))});var bp=N(Bi=>{"use strict";Object.defineProperty(Bi,"__esModule",{value:!0});Bi.FoldingRangeRefreshRequest=Bi.FoldingRangeRequest=void 0;var Go=et(),yp;(function(n){n.method="textDocument/foldingRange",n.messageDirection=Go.MessageDirection.clientToServer,n.type=new Go.ProtocolRequestType(n.method)})(yp||(Bi.FoldingRangeRequest=yp={}));var vp;(function(n){n.method="workspace/foldingRange/refresh",n.messageDirection=Go.MessageDirection.serverToClient,n.type=new Go.ProtocolRequestType0(n.method)})(vp||(Bi.FoldingRangeRefreshRequest=vp={}))});var _p=N(Vo=>{"use strict";Object.defineProperty(Vo,"__esModule",{value:!0});Vo.DeclarationRequest=void 0;var Cp=et(),wp;(function(n){n.method="textDocument/declaration",n.messageDirection=Cp.MessageDirection.clientToServer,n.type=new Cp.ProtocolRequestType(n.method)})(wp||(Vo.DeclarationRequest=wp={}))});var Ep=N(Zo=>{"use strict";Object.defineProperty(Zo,"__esModule",{value:!0});Zo.SelectionRangeRequest=void 0;var Sp=et(),Tp;(function(n){n.method="textDocument/selectionRange",n.messageDirection=Sp.MessageDirection.clientToServer,n.type=new Sp.ProtocolRequestType(n.method)})(Tp||(Zo.SelectionRangeRequest=Tp={}))});var Pp=N(Nr=>{"use strict";Object.defineProperty(Nr,"__esModule",{value:!0});Nr.WorkDoneProgressCancelNotification=Nr.WorkDoneProgressCreateRequest=Nr.WorkDoneProgress=void 0;var kw=ni(),Xo=et(),Rp;(function(n){n.type=new kw.ProgressType;function e(t){return t===n.type}n.is=e})(Rp||(Nr.WorkDoneProgress=Rp={}));var Dp;(function(n){n.method="window/workDoneProgress/create",n.messageDirection=Xo.MessageDirection.serverToClient,n.type=new Xo.ProtocolRequestType(n.method)})(Dp||(Nr.WorkDoneProgressCreateRequest=Dp={}));var xp;(function(n){n.method="window/workDoneProgress/cancel",n.messageDirection=Xo.MessageDirection.clientToServer,n.type=new Xo.ProtocolNotificationType(n.method)})(xp||(Nr.WorkDoneProgressCancelNotification=xp={}))});var Mp=N(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.CallHierarchyOutgoingCallsRequest=Lr.CallHierarchyIncomingCallsRequest=Lr.CallHierarchyPrepareRequest=void 0;var Ki=et(),kp;(function(n){n.method="textDocument/prepareCallHierarchy",n.messageDirection=Ki.MessageDirection.clientToServer,n.type=new Ki.ProtocolRequestType(n.method)})(kp||(Lr.CallHierarchyPrepareRequest=kp={}));var Ip;(function(n){n.method="callHierarchy/incomingCalls",n.messageDirection=Ki.MessageDirection.clientToServer,n.type=new Ki.ProtocolRequestType(n.method)})(Ip||(Lr.CallHierarchyIncomingCallsRequest=Ip={}));var Op;(function(n){n.method="callHierarchy/outgoingCalls",n.messageDirection=Ki.MessageDirection.clientToServer,n.type=new Ki.ProtocolRequestType(n.method)})(Op||(Lr.CallHierarchyOutgoingCallsRequest=Op={}))});var jp=N(rn=>{"use strict";Object.defineProperty(rn,"__esModule",{value:!0});rn.SemanticTokensRefreshRequest=rn.SemanticTokensRangeRequest=rn.SemanticTokensDeltaRequest=rn.SemanticTokensRequest=rn.SemanticTokensRegistrationType=rn.TokenFormat=void 0;var mr=et(),Np;(function(n){n.Relative="relative"})(Np||(rn.TokenFormat=Np={}));var Os;(function(n){n.method="textDocument/semanticTokens",n.type=new mr.RegistrationType(n.method)})(Os||(rn.SemanticTokensRegistrationType=Os={}));var Lp;(function(n){n.method="textDocument/semanticTokens/full",n.messageDirection=mr.MessageDirection.clientToServer,n.type=new mr.ProtocolRequestType(n.method),n.registrationMethod=Os.method})(Lp||(rn.SemanticTokensRequest=Lp={}));var Fp;(function(n){n.method="textDocument/semanticTokens/full/delta",n.messageDirection=mr.MessageDirection.clientToServer,n.type=new mr.ProtocolRequestType(n.method),n.registrationMethod=Os.method})(Fp||(rn.SemanticTokensDeltaRequest=Fp={}));var qp;(function(n){n.method="textDocument/semanticTokens/range",n.messageDirection=mr.MessageDirection.clientToServer,n.type=new mr.ProtocolRequestType(n.method),n.registrationMethod=Os.method})(qp||(rn.SemanticTokensRangeRequest=qp={}));var Ap;(function(n){n.method="workspace/semanticTokens/refresh",n.messageDirection=mr.MessageDirection.serverToClient,n.type=new mr.ProtocolRequestType0(n.method)})(Ap||(rn.SemanticTokensRefreshRequest=Ap={}))});var Up=N(Jo=>{"use strict";Object.defineProperty(Jo,"__esModule",{value:!0});Jo.ShowDocumentRequest=void 0;var Hp=et(),$p;(function(n){n.method="window/showDocument",n.messageDirection=Hp.MessageDirection.serverToClient,n.type=new Hp.ProtocolRequestType(n.method)})($p||(Jo.ShowDocumentRequest=$p={}))});var Bp=N(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.LinkedEditingRangeRequest=void 0;var zp=et(),Wp;(function(n){n.method="textDocument/linkedEditingRange",n.messageDirection=zp.MessageDirection.clientToServer,n.type=new zp.ProtocolRequestType(n.method)})(Wp||(Yo.LinkedEditingRangeRequest=Wp={}))});var Qp=N(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.WillDeleteFilesRequest=Ht.DidDeleteFilesNotification=Ht.DidRenameFilesNotification=Ht.WillRenameFilesRequest=Ht.DidCreateFilesNotification=Ht.WillCreateFilesRequest=Ht.FileOperationPatternKind=void 0;var Sn=et(),Kp;(function(n){n.file="file",n.folder="folder"})(Kp||(Ht.FileOperationPatternKind=Kp={}));var Gp;(function(n){n.method="workspace/willCreateFiles",n.messageDirection=Sn.MessageDirection.clientToServer,n.type=new Sn.ProtocolRequestType(n.method)})(Gp||(Ht.WillCreateFilesRequest=Gp={}));var Vp;(function(n){n.method="workspace/didCreateFiles",n.messageDirection=Sn.MessageDirection.clientToServer,n.type=new Sn.ProtocolNotificationType(n.method)})(Vp||(Ht.DidCreateFilesNotification=Vp={}));var Zp;(function(n){n.method="workspace/willRenameFiles",n.messageDirection=Sn.MessageDirection.clientToServer,n.type=new Sn.ProtocolRequestType(n.method)})(Zp||(Ht.WillRenameFilesRequest=Zp={}));var Xp;(function(n){n.method="workspace/didRenameFiles",n.messageDirection=Sn.MessageDirection.clientToServer,n.type=new Sn.ProtocolNotificationType(n.method)})(Xp||(Ht.DidRenameFilesNotification=Xp={}));var Jp;(function(n){n.method="workspace/didDeleteFiles",n.messageDirection=Sn.MessageDirection.clientToServer,n.type=new Sn.ProtocolNotificationType(n.method)})(Jp||(Ht.DidDeleteFilesNotification=Jp={}));var Yp;(function(n){n.method="workspace/willDeleteFiles",n.messageDirection=Sn.MessageDirection.clientToServer,n.type=new Sn.ProtocolRequestType(n.method)})(Yp||(Ht.WillDeleteFilesRequest=Yp={}))});var im=N(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.MonikerRequest=Fr.MonikerKind=Fr.UniquenessLevel=void 0;var em=et(),tm;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(tm||(Fr.UniquenessLevel=tm={}));var nm;(function(n){n.$import="import",n.$export="export",n.local="local"})(nm||(Fr.MonikerKind=nm={}));var rm;(function(n){n.method="textDocument/moniker",n.messageDirection=em.MessageDirection.clientToServer,n.type=new em.ProtocolRequestType(n.method)})(rm||(Fr.MonikerRequest=rm={}))});var cm=N(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.TypeHierarchySubtypesRequest=qr.TypeHierarchySupertypesRequest=qr.TypeHierarchyPrepareRequest=void 0;var Gi=et(),sm;(function(n){n.method="textDocument/prepareTypeHierarchy",n.messageDirection=Gi.MessageDirection.clientToServer,n.type=new Gi.ProtocolRequestType(n.method)})(sm||(qr.TypeHierarchyPrepareRequest=sm={}));var om;(function(n){n.method="typeHierarchy/supertypes",n.messageDirection=Gi.MessageDirection.clientToServer,n.type=new Gi.ProtocolRequestType(n.method)})(om||(qr.TypeHierarchySupertypesRequest=om={}));var am;(function(n){n.method="typeHierarchy/subtypes",n.messageDirection=Gi.MessageDirection.clientToServer,n.type=new Gi.ProtocolRequestType(n.method)})(am||(qr.TypeHierarchySubtypesRequest=am={}))});var dm=N(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.InlineValueRefreshRequest=Vi.InlineValueRequest=void 0;var Qo=et(),um;(function(n){n.method="textDocument/inlineValue",n.messageDirection=Qo.MessageDirection.clientToServer,n.type=new Qo.ProtocolRequestType(n.method)})(um||(Vi.InlineValueRequest=um={}));var lm;(function(n){n.method="workspace/inlineValue/refresh",n.messageDirection=Qo.MessageDirection.serverToClient,n.type=new Qo.ProtocolRequestType0(n.method)})(lm||(Vi.InlineValueRefreshRequest=lm={}))});var mm=N(Ar=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.InlayHintRefreshRequest=Ar.InlayHintResolveRequest=Ar.InlayHintRequest=void 0;var Zi=et(),fm;(function(n){n.method="textDocument/inlayHint",n.messageDirection=Zi.MessageDirection.clientToServer,n.type=new Zi.ProtocolRequestType(n.method)})(fm||(Ar.InlayHintRequest=fm={}));var hm;(function(n){n.method="inlayHint/resolve",n.messageDirection=Zi.MessageDirection.clientToServer,n.type=new Zi.ProtocolRequestType(n.method)})(hm||(Ar.InlayHintResolveRequest=hm={}));var pm;(function(n){n.method="workspace/inlayHint/refresh",n.messageDirection=Zi.MessageDirection.serverToClient,n.type=new Zi.ProtocolRequestType0(n.method)})(pm||(Ar.InlayHintRefreshRequest=pm={}))});var _m=N(Tn=>{"use strict";Object.defineProperty(Tn,"__esModule",{value:!0});Tn.DiagnosticRefreshRequest=Tn.WorkspaceDiagnosticRequest=Tn.DocumentDiagnosticRequest=Tn.DocumentDiagnosticReportKind=Tn.DiagnosticServerCancellationData=void 0;var wm=ni(),Iw=$o(),Xi=et(),gm;(function(n){function e(t){let r=t;return r&&Iw.boolean(r.retriggerRequest)}n.is=e})(gm||(Tn.DiagnosticServerCancellationData=gm={}));var ym;(function(n){n.Full="full",n.Unchanged="unchanged"})(ym||(Tn.DocumentDiagnosticReportKind=ym={}));var vm;(function(n){n.method="textDocument/diagnostic",n.messageDirection=Xi.MessageDirection.clientToServer,n.type=new Xi.ProtocolRequestType(n.method),n.partialResult=new wm.ProgressType})(vm||(Tn.DocumentDiagnosticRequest=vm={}));var bm;(function(n){n.method="workspace/diagnostic",n.messageDirection=Xi.MessageDirection.clientToServer,n.type=new Xi.ProtocolRequestType(n.method),n.partialResult=new wm.ProgressType})(bm||(Tn.WorkspaceDiagnosticRequest=bm={}));var Cm;(function(n){n.method="workspace/diagnostic/refresh",n.messageDirection=Xi.MessageDirection.serverToClient,n.type=new Xi.ProtocolRequestType0(n.method)})(Cm||(Tn.DiagnosticRefreshRequest=Cm={}))});var Pm=N(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.DidCloseNotebookDocumentNotification=ft.DidSaveNotebookDocumentNotification=ft.DidChangeNotebookDocumentNotification=ft.NotebookCellArrayChange=ft.DidOpenNotebookDocumentNotification=ft.NotebookDocumentSyncRegistrationType=ft.NotebookDocument=ft.NotebookCell=ft.ExecutionSummary=ft.NotebookCellKind=void 0;var Ms=Ho(),Hn=$o(),tr=et(),Uu;(function(n){n.Markup=1,n.Code=2;function e(t){return t===1||t===2}n.is=e})(Uu||(ft.NotebookCellKind=Uu={}));var zu;(function(n){function e(i,s){let o={executionOrder:i};return(s===!0||s===!1)&&(o.success=s),o}n.create=e;function t(i){let s=i;return Hn.objectLiteral(s)&&Ms.uinteger.is(s.executionOrder)&&(s.success===void 0||Hn.boolean(s.success))}n.is=t;function r(i,s){return i===s?!0:i==null||s===null||s===void 0?!1:i.executionOrder===s.executionOrder&&i.success===s.success}n.equals=r})(zu||(ft.ExecutionSummary=zu={}));var ea;(function(n){function e(s,o){return{kind:s,document:o}}n.create=e;function t(s){let o=s;return Hn.objectLiteral(o)&&Uu.is(o.kind)&&Ms.DocumentUri.is(o.document)&&(o.metadata===void 0||Hn.objectLiteral(o.metadata))}n.is=t;function r(s,o){let a=new Set;return s.document!==o.document&&a.add("document"),s.kind!==o.kind&&a.add("kind"),s.executionSummary!==o.executionSummary&&a.add("executionSummary"),(s.metadata!==void 0||o.metadata!==void 0)&&!i(s.metadata,o.metadata)&&a.add("metadata"),(s.executionSummary!==void 0||o.executionSummary!==void 0)&&!zu.equals(s.executionSummary,o.executionSummary)&&a.add("executionSummary"),a}n.diff=r;function i(s,o){if(s===o)return!0;if(s==null||o===null||o===void 0||typeof s!=typeof o||typeof s!="object")return!1;let a=Array.isArray(s),c=Array.isArray(o);if(a!==c)return!1;if(a&&c){if(s.length!==o.length)return!1;for(let u=0;u<s.length;u++)if(!i(s[u],o[u]))return!1}if(Hn.objectLiteral(s)&&Hn.objectLiteral(o)){let u=Object.keys(s),d=Object.keys(o);if(u.length!==d.length||(u.sort(),d.sort(),!i(u,d)))return!1;for(let v=0;v<u.length;v++){let b=u[v];if(!i(s[b],o[b]))return!1}}return!0}})(ea||(ft.NotebookCell=ea={}));var Sm;(function(n){function e(r,i,s,o){return{uri:r,notebookType:i,version:s,cells:o}}n.create=e;function t(r){let i=r;return Hn.objectLiteral(i)&&Hn.string(i.uri)&&Ms.integer.is(i.version)&&Hn.typedArray(i.cells,ea.is)}n.is=t})(Sm||(ft.NotebookDocument=Sm={}));var Ji;(function(n){n.method="notebookDocument/sync",n.messageDirection=tr.MessageDirection.clientToServer,n.type=new tr.RegistrationType(n.method)})(Ji||(ft.NotebookDocumentSyncRegistrationType=Ji={}));var Tm;(function(n){n.method="notebookDocument/didOpen",n.messageDirection=tr.MessageDirection.clientToServer,n.type=new tr.ProtocolNotificationType(n.method),n.registrationMethod=Ji.method})(Tm||(ft.DidOpenNotebookDocumentNotification=Tm={}));var Em;(function(n){function e(r){let i=r;return Hn.objectLiteral(i)&&Ms.uinteger.is(i.start)&&Ms.uinteger.is(i.deleteCount)&&(i.cells===void 0||Hn.typedArray(i.cells,ea.is))}n.is=e;function t(r,i,s){let o={start:r,deleteCount:i};return s!==void 0&&(o.cells=s),o}n.create=t})(Em||(ft.NotebookCellArrayChange=Em={}));var Rm;(function(n){n.method="notebookDocument/didChange",n.messageDirection=tr.MessageDirection.clientToServer,n.type=new tr.ProtocolNotificationType(n.method),n.registrationMethod=Ji.method})(Rm||(ft.DidChangeNotebookDocumentNotification=Rm={}));var Dm;(function(n){n.method="notebookDocument/didSave",n.messageDirection=tr.MessageDirection.clientToServer,n.type=new tr.ProtocolNotificationType(n.method),n.registrationMethod=Ji.method})(Dm||(ft.DidSaveNotebookDocumentNotification=Dm={}));var xm;(function(n){n.method="notebookDocument/didClose",n.messageDirection=tr.MessageDirection.clientToServer,n.type=new tr.ProtocolNotificationType(n.method),n.registrationMethod=Ji.method})(xm||(ft.DidCloseNotebookDocumentNotification=xm={}))});var Om=N(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.InlineCompletionRequest=void 0;var km=et(),Im;(function(n){n.method="textDocument/inlineCompletion",n.messageDirection=km.MessageDirection.clientToServer,n.type=new km.ProtocolRequestType(n.method)})(Im||(ta.InlineCompletionRequest=Im={}))});var Bg=N(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});S.WorkspaceSymbolRequest=S.CodeActionResolveRequest=S.CodeActionRequest=S.DocumentSymbolRequest=S.DocumentHighlightRequest=S.ReferencesRequest=S.DefinitionRequest=S.SignatureHelpRequest=S.SignatureHelpTriggerKind=S.HoverRequest=S.CompletionResolveRequest=S.CompletionRequest=S.CompletionTriggerKind=S.PublishDiagnosticsNotification=S.WatchKind=S.RelativePattern=S.FileChangeType=S.DidChangeWatchedFilesNotification=S.WillSaveTextDocumentWaitUntilRequest=S.WillSaveTextDocumentNotification=S.TextDocumentSaveReason=S.DidSaveTextDocumentNotification=S.DidCloseTextDocumentNotification=S.DidChangeTextDocumentNotification=S.TextDocumentContentChangeEvent=S.DidOpenTextDocumentNotification=S.TextDocumentSyncKind=S.TelemetryEventNotification=S.LogMessageNotification=S.ShowMessageRequest=S.ShowMessageNotification=S.MessageType=S.DidChangeConfigurationNotification=S.ExitNotification=S.ShutdownRequest=S.InitializedNotification=S.InitializeErrorCodes=S.InitializeRequest=S.WorkDoneProgressOptions=S.TextDocumentRegistrationOptions=S.StaticRegistrationOptions=S.PositionEncodingKind=S.FailureHandlingKind=S.ResourceOperationKind=S.UnregistrationRequest=S.RegistrationRequest=S.DocumentSelector=S.NotebookCellTextDocumentFilter=S.NotebookDocumentFilter=S.TextDocumentFilter=void 0;S.MonikerRequest=S.MonikerKind=S.UniquenessLevel=S.WillDeleteFilesRequest=S.DidDeleteFilesNotification=S.WillRenameFilesRequest=S.DidRenameFilesNotification=S.WillCreateFilesRequest=S.DidCreateFilesNotification=S.FileOperationPatternKind=S.LinkedEditingRangeRequest=S.ShowDocumentRequest=S.SemanticTokensRegistrationType=S.SemanticTokensRefreshRequest=S.SemanticTokensRangeRequest=S.SemanticTokensDeltaRequest=S.SemanticTokensRequest=S.TokenFormat=S.CallHierarchyPrepareRequest=S.CallHierarchyOutgoingCallsRequest=S.CallHierarchyIncomingCallsRequest=S.WorkDoneProgressCancelNotification=S.WorkDoneProgressCreateRequest=S.WorkDoneProgress=S.SelectionRangeRequest=S.DeclarationRequest=S.FoldingRangeRefreshRequest=S.FoldingRangeRequest=S.ColorPresentationRequest=S.DocumentColorRequest=S.ConfigurationRequest=S.DidChangeWorkspaceFoldersNotification=S.WorkspaceFoldersRequest=S.TypeDefinitionRequest=S.ImplementationRequest=S.ApplyWorkspaceEditRequest=S.ExecuteCommandRequest=S.PrepareRenameRequest=S.RenameRequest=S.PrepareSupportDefaultBehavior=S.DocumentOnTypeFormattingRequest=S.DocumentRangesFormattingRequest=S.DocumentRangeFormattingRequest=S.DocumentFormattingRequest=S.DocumentLinkResolveRequest=S.DocumentLinkRequest=S.CodeLensRefreshRequest=S.CodeLensResolveRequest=S.CodeLensRequest=S.WorkspaceSymbolResolveRequest=void 0;S.InlineCompletionRequest=S.DidCloseNotebookDocumentNotification=S.DidSaveNotebookDocumentNotification=S.DidChangeNotebookDocumentNotification=S.NotebookCellArrayChange=S.DidOpenNotebookDocumentNotification=S.NotebookDocumentSyncRegistrationType=S.NotebookDocument=S.NotebookCell=S.ExecutionSummary=S.NotebookCellKind=S.DiagnosticRefreshRequest=S.WorkspaceDiagnosticRequest=S.DocumentDiagnosticRequest=S.DocumentDiagnosticReportKind=S.DiagnosticServerCancellationData=S.InlayHintRefreshRequest=S.InlayHintResolveRequest=S.InlayHintRequest=S.InlineValueRefreshRequest=S.InlineValueRequest=S.TypeHierarchySupertypesRequest=S.TypeHierarchySubtypesRequest=S.TypeHierarchyPrepareRequest=void 0;var W=et(),Mm=Ho(),xt=$o(),Ow=ip();Object.defineProperty(S,"ImplementationRequest",{enumerable:!0,get:function(){return Ow.ImplementationRequest}});var Mw=ap();Object.defineProperty(S,"TypeDefinitionRequest",{enumerable:!0,get:function(){return Mw.TypeDefinitionRequest}});var $g=lp();Object.defineProperty(S,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return $g.WorkspaceFoldersRequest}});Object.defineProperty(S,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return $g.DidChangeWorkspaceFoldersNotification}});var Nw=hp();Object.defineProperty(S,"ConfigurationRequest",{enumerable:!0,get:function(){return Nw.ConfigurationRequest}});var Ug=gp();Object.defineProperty(S,"DocumentColorRequest",{enumerable:!0,get:function(){return Ug.DocumentColorRequest}});Object.defineProperty(S,"ColorPresentationRequest",{enumerable:!0,get:function(){return Ug.ColorPresentationRequest}});var zg=bp();Object.defineProperty(S,"FoldingRangeRequest",{enumerable:!0,get:function(){return zg.FoldingRangeRequest}});Object.defineProperty(S,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return zg.FoldingRangeRefreshRequest}});var Lw=_p();Object.defineProperty(S,"DeclarationRequest",{enumerable:!0,get:function(){return Lw.DeclarationRequest}});var Fw=Ep();Object.defineProperty(S,"SelectionRangeRequest",{enumerable:!0,get:function(){return Fw.SelectionRangeRequest}});var Vu=Pp();Object.defineProperty(S,"WorkDoneProgress",{enumerable:!0,get:function(){return Vu.WorkDoneProgress}});Object.defineProperty(S,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return Vu.WorkDoneProgressCreateRequest}});Object.defineProperty(S,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return Vu.WorkDoneProgressCancelNotification}});var Zu=Mp();Object.defineProperty(S,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return Zu.CallHierarchyIncomingCallsRequest}});Object.defineProperty(S,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return Zu.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(S,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return Zu.CallHierarchyPrepareRequest}});var Yi=jp();Object.defineProperty(S,"TokenFormat",{enumerable:!0,get:function(){return Yi.TokenFormat}});Object.defineProperty(S,"SemanticTokensRequest",{enumerable:!0,get:function(){return Yi.SemanticTokensRequest}});Object.defineProperty(S,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return Yi.SemanticTokensDeltaRequest}});Object.defineProperty(S,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return Yi.SemanticTokensRangeRequest}});Object.defineProperty(S,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return Yi.SemanticTokensRefreshRequest}});Object.defineProperty(S,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return Yi.SemanticTokensRegistrationType}});var qw=Up();Object.defineProperty(S,"ShowDocumentRequest",{enumerable:!0,get:function(){return qw.ShowDocumentRequest}});var Aw=Bp();Object.defineProperty(S,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return Aw.LinkedEditingRangeRequest}});var ri=Qp();Object.defineProperty(S,"FileOperationPatternKind",{enumerable:!0,get:function(){return ri.FileOperationPatternKind}});Object.defineProperty(S,"DidCreateFilesNotification",{enumerable:!0,get:function(){return ri.DidCreateFilesNotification}});Object.defineProperty(S,"WillCreateFilesRequest",{enumerable:!0,get:function(){return ri.WillCreateFilesRequest}});Object.defineProperty(S,"DidRenameFilesNotification",{enumerable:!0,get:function(){return ri.DidRenameFilesNotification}});Object.defineProperty(S,"WillRenameFilesRequest",{enumerable:!0,get:function(){return ri.WillRenameFilesRequest}});Object.defineProperty(S,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return ri.DidDeleteFilesNotification}});Object.defineProperty(S,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return ri.WillDeleteFilesRequest}});var Xu=im();Object.defineProperty(S,"UniquenessLevel",{enumerable:!0,get:function(){return Xu.UniquenessLevel}});Object.defineProperty(S,"MonikerKind",{enumerable:!0,get:function(){return Xu.MonikerKind}});Object.defineProperty(S,"MonikerRequest",{enumerable:!0,get:function(){return Xu.MonikerRequest}});var Ju=cm();Object.defineProperty(S,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return Ju.TypeHierarchyPrepareRequest}});Object.defineProperty(S,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return Ju.TypeHierarchySubtypesRequest}});Object.defineProperty(S,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return Ju.TypeHierarchySupertypesRequest}});var Wg=dm();Object.defineProperty(S,"InlineValueRequest",{enumerable:!0,get:function(){return Wg.InlineValueRequest}});Object.defineProperty(S,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return Wg.InlineValueRefreshRequest}});var Yu=mm();Object.defineProperty(S,"InlayHintRequest",{enumerable:!0,get:function(){return Yu.InlayHintRequest}});Object.defineProperty(S,"InlayHintResolveRequest",{enumerable:!0,get:function(){return Yu.InlayHintResolveRequest}});Object.defineProperty(S,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return Yu.InlayHintRefreshRequest}});var Ns=_m();Object.defineProperty(S,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return Ns.DiagnosticServerCancellationData}});Object.defineProperty(S,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return Ns.DocumentDiagnosticReportKind}});Object.defineProperty(S,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return Ns.DocumentDiagnosticRequest}});Object.defineProperty(S,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return Ns.WorkspaceDiagnosticRequest}});Object.defineProperty(S,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return Ns.DiagnosticRefreshRequest}});var nr=Pm();Object.defineProperty(S,"NotebookCellKind",{enumerable:!0,get:function(){return nr.NotebookCellKind}});Object.defineProperty(S,"ExecutionSummary",{enumerable:!0,get:function(){return nr.ExecutionSummary}});Object.defineProperty(S,"NotebookCell",{enumerable:!0,get:function(){return nr.NotebookCell}});Object.defineProperty(S,"NotebookDocument",{enumerable:!0,get:function(){return nr.NotebookDocument}});Object.defineProperty(S,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return nr.NotebookDocumentSyncRegistrationType}});Object.defineProperty(S,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return nr.DidOpenNotebookDocumentNotification}});Object.defineProperty(S,"NotebookCellArrayChange",{enumerable:!0,get:function(){return nr.NotebookCellArrayChange}});Object.defineProperty(S,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return nr.DidChangeNotebookDocumentNotification}});Object.defineProperty(S,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return nr.DidSaveNotebookDocumentNotification}});Object.defineProperty(S,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return nr.DidCloseNotebookDocumentNotification}});var jw=Om();Object.defineProperty(S,"InlineCompletionRequest",{enumerable:!0,get:function(){return jw.InlineCompletionRequest}});var Wu;(function(n){function e(t){let r=t;return xt.string(r)||xt.string(r.language)||xt.string(r.scheme)||xt.string(r.pattern)}n.is=e})(Wu||(S.TextDocumentFilter=Wu={}));var Bu;(function(n){function e(t){let r=t;return xt.objectLiteral(r)&&(xt.string(r.notebookType)||xt.string(r.scheme)||xt.string(r.pattern))}n.is=e})(Bu||(S.NotebookDocumentFilter=Bu={}));var Ku;(function(n){function e(t){let r=t;return xt.objectLiteral(r)&&(xt.string(r.notebook)||Bu.is(r.notebook))&&(r.language===void 0||xt.string(r.language))}n.is=e})(Ku||(S.NotebookCellTextDocumentFilter=Ku={}));var Gu;(function(n){function e(t){if(!Array.isArray(t))return!1;for(let r of t)if(!xt.string(r)&&!Wu.is(r)&&!Ku.is(r))return!1;return!0}n.is=e})(Gu||(S.DocumentSelector=Gu={}));var Nm;(function(n){n.method="client/registerCapability",n.messageDirection=W.MessageDirection.serverToClient,n.type=new W.ProtocolRequestType(n.method)})(Nm||(S.RegistrationRequest=Nm={}));var Lm;(function(n){n.method="client/unregisterCapability",n.messageDirection=W.MessageDirection.serverToClient,n.type=new W.ProtocolRequestType(n.method)})(Lm||(S.UnregistrationRequest=Lm={}));var Fm;(function(n){n.Create="create",n.Rename="rename",n.Delete="delete"})(Fm||(S.ResourceOperationKind=Fm={}));var qm;(function(n){n.Abort="abort",n.Transactional="transactional",n.TextOnlyTransactional="textOnlyTransactional",n.Undo="undo"})(qm||(S.FailureHandlingKind=qm={}));var Am;(function(n){n.UTF8="utf-8",n.UTF16="utf-16",n.UTF32="utf-32"})(Am||(S.PositionEncodingKind=Am={}));var jm;(function(n){function e(t){let r=t;return r&&xt.string(r.id)&&r.id.length>0}n.hasId=e})(jm||(S.StaticRegistrationOptions=jm={}));var Hm;(function(n){function e(t){let r=t;return r&&(r.documentSelector===null||Gu.is(r.documentSelector))}n.is=e})(Hm||(S.TextDocumentRegistrationOptions=Hm={}));var $m;(function(n){function e(r){let i=r;return xt.objectLiteral(i)&&(i.workDoneProgress===void 0||xt.boolean(i.workDoneProgress))}n.is=e;function t(r){let i=r;return i&&xt.boolean(i.workDoneProgress)}n.hasWorkDoneProgress=t})($m||(S.WorkDoneProgressOptions=$m={}));var Um;(function(n){n.method="initialize",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(Um||(S.InitializeRequest=Um={}));var zm;(function(n){n.unknownProtocolVersion=1})(zm||(S.InitializeErrorCodes=zm={}));var Wm;(function(n){n.method="initialized",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolNotificationType(n.method)})(Wm||(S.InitializedNotification=Wm={}));var Bm;(function(n){n.method="shutdown",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType0(n.method)})(Bm||(S.ShutdownRequest=Bm={}));var Km;(function(n){n.method="exit",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolNotificationType0(n.method)})(Km||(S.ExitNotification=Km={}));var Gm;(function(n){n.method="workspace/didChangeConfiguration",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolNotificationType(n.method)})(Gm||(S.DidChangeConfigurationNotification=Gm={}));var Vm;(function(n){n.Error=1,n.Warning=2,n.Info=3,n.Log=4,n.Debug=5})(Vm||(S.MessageType=Vm={}));var Zm;(function(n){n.method="window/showMessage",n.messageDirection=W.MessageDirection.serverToClient,n.type=new W.ProtocolNotificationType(n.method)})(Zm||(S.ShowMessageNotification=Zm={}));var Xm;(function(n){n.method="window/showMessageRequest",n.messageDirection=W.MessageDirection.serverToClient,n.type=new W.ProtocolRequestType(n.method)})(Xm||(S.ShowMessageRequest=Xm={}));var Jm;(function(n){n.method="window/logMessage",n.messageDirection=W.MessageDirection.serverToClient,n.type=new W.ProtocolNotificationType(n.method)})(Jm||(S.LogMessageNotification=Jm={}));var Ym;(function(n){n.method="telemetry/event",n.messageDirection=W.MessageDirection.serverToClient,n.type=new W.ProtocolNotificationType(n.method)})(Ym||(S.TelemetryEventNotification=Ym={}));var Qm;(function(n){n.None=0,n.Full=1,n.Incremental=2})(Qm||(S.TextDocumentSyncKind=Qm={}));var eg;(function(n){n.method="textDocument/didOpen",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolNotificationType(n.method)})(eg||(S.DidOpenTextDocumentNotification=eg={}));var tg;(function(n){function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}n.isIncremental=e;function t(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}n.isFull=t})(tg||(S.TextDocumentContentChangeEvent=tg={}));var ng;(function(n){n.method="textDocument/didChange",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolNotificationType(n.method)})(ng||(S.DidChangeTextDocumentNotification=ng={}));var rg;(function(n){n.method="textDocument/didClose",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolNotificationType(n.method)})(rg||(S.DidCloseTextDocumentNotification=rg={}));var ig;(function(n){n.method="textDocument/didSave",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolNotificationType(n.method)})(ig||(S.DidSaveTextDocumentNotification=ig={}));var sg;(function(n){n.Manual=1,n.AfterDelay=2,n.FocusOut=3})(sg||(S.TextDocumentSaveReason=sg={}));var og;(function(n){n.method="textDocument/willSave",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolNotificationType(n.method)})(og||(S.WillSaveTextDocumentNotification=og={}));var ag;(function(n){n.method="textDocument/willSaveWaitUntil",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(ag||(S.WillSaveTextDocumentWaitUntilRequest=ag={}));var cg;(function(n){n.method="workspace/didChangeWatchedFiles",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolNotificationType(n.method)})(cg||(S.DidChangeWatchedFilesNotification=cg={}));var ug;(function(n){n.Created=1,n.Changed=2,n.Deleted=3})(ug||(S.FileChangeType=ug={}));var lg;(function(n){function e(t){let r=t;return xt.objectLiteral(r)&&(Mm.URI.is(r.baseUri)||Mm.WorkspaceFolder.is(r.baseUri))&&xt.string(r.pattern)}n.is=e})(lg||(S.RelativePattern=lg={}));var dg;(function(n){n.Create=1,n.Change=2,n.Delete=4})(dg||(S.WatchKind=dg={}));var fg;(function(n){n.method="textDocument/publishDiagnostics",n.messageDirection=W.MessageDirection.serverToClient,n.type=new W.ProtocolNotificationType(n.method)})(fg||(S.PublishDiagnosticsNotification=fg={}));var hg;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.TriggerForIncompleteCompletions=3})(hg||(S.CompletionTriggerKind=hg={}));var pg;(function(n){n.method="textDocument/completion",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(pg||(S.CompletionRequest=pg={}));var mg;(function(n){n.method="completionItem/resolve",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(mg||(S.CompletionResolveRequest=mg={}));var gg;(function(n){n.method="textDocument/hover",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(gg||(S.HoverRequest=gg={}));var yg;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.ContentChange=3})(yg||(S.SignatureHelpTriggerKind=yg={}));var vg;(function(n){n.method="textDocument/signatureHelp",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(vg||(S.SignatureHelpRequest=vg={}));var bg;(function(n){n.method="textDocument/definition",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(bg||(S.DefinitionRequest=bg={}));var Cg;(function(n){n.method="textDocument/references",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(Cg||(S.ReferencesRequest=Cg={}));var wg;(function(n){n.method="textDocument/documentHighlight",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(wg||(S.DocumentHighlightRequest=wg={}));var _g;(function(n){n.method="textDocument/documentSymbol",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(_g||(S.DocumentSymbolRequest=_g={}));var Sg;(function(n){n.method="textDocument/codeAction",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(Sg||(S.CodeActionRequest=Sg={}));var Tg;(function(n){n.method="codeAction/resolve",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(Tg||(S.CodeActionResolveRequest=Tg={}));var Eg;(function(n){n.method="workspace/symbol",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(Eg||(S.WorkspaceSymbolRequest=Eg={}));var Rg;(function(n){n.method="workspaceSymbol/resolve",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(Rg||(S.WorkspaceSymbolResolveRequest=Rg={}));var Dg;(function(n){n.method="textDocument/codeLens",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(Dg||(S.CodeLensRequest=Dg={}));var xg;(function(n){n.method="codeLens/resolve",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(xg||(S.CodeLensResolveRequest=xg={}));var Pg;(function(n){n.method="workspace/codeLens/refresh",n.messageDirection=W.MessageDirection.serverToClient,n.type=new W.ProtocolRequestType0(n.method)})(Pg||(S.CodeLensRefreshRequest=Pg={}));var kg;(function(n){n.method="textDocument/documentLink",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(kg||(S.DocumentLinkRequest=kg={}));var Ig;(function(n){n.method="documentLink/resolve",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(Ig||(S.DocumentLinkResolveRequest=Ig={}));var Og;(function(n){n.method="textDocument/formatting",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(Og||(S.DocumentFormattingRequest=Og={}));var Mg;(function(n){n.method="textDocument/rangeFormatting",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(Mg||(S.DocumentRangeFormattingRequest=Mg={}));var Ng;(function(n){n.method="textDocument/rangesFormatting",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(Ng||(S.DocumentRangesFormattingRequest=Ng={}));var Lg;(function(n){n.method="textDocument/onTypeFormatting",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(Lg||(S.DocumentOnTypeFormattingRequest=Lg={}));var Fg;(function(n){n.Identifier=1})(Fg||(S.PrepareSupportDefaultBehavior=Fg={}));var qg;(function(n){n.method="textDocument/rename",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(qg||(S.RenameRequest=qg={}));var Ag;(function(n){n.method="textDocument/prepareRename",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(Ag||(S.PrepareRenameRequest=Ag={}));var jg;(function(n){n.method="workspace/executeCommand",n.messageDirection=W.MessageDirection.clientToServer,n.type=new W.ProtocolRequestType(n.method)})(jg||(S.ExecuteCommandRequest=jg={}));var Hg;(function(n){n.method="workspace/applyEdit",n.messageDirection=W.MessageDirection.serverToClient,n.type=new W.ProtocolRequestType("workspace/applyEdit")})(Hg||(S.ApplyWorkspaceEditRequest=Hg={}))});var Gg=N(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.createProtocolConnection=void 0;var Kg=ni();function Hw(n,e,t,r){return Kg.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Kg.createMessageConnection)(n,e,t,r)}na.createProtocolConnection=Hw});var Zg=N(sn=>{"use strict";var $w=sn&&sn.__createBinding||(Object.create?(function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}):(function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]})),ra=sn&&sn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&$w(e,n,t)};Object.defineProperty(sn,"__esModule",{value:!0});sn.LSPErrorCodes=sn.createProtocolConnection=void 0;ra(ni(),sn);ra(Ho(),sn);ra(et(),sn);ra(Bg(),sn);var Uw=Gg();Object.defineProperty(sn,"createProtocolConnection",{enumerable:!0,get:function(){return Uw.createProtocolConnection}});var Vg;(function(n){n.lspReservedErrorRangeStart=-32899,n.RequestFailed=-32803,n.ServerCancelled=-32802,n.ContentModified=-32801,n.RequestCancelled=-32800,n.lspReservedErrorRangeEnd=-32800})(Vg||(sn.LSPErrorCodes=Vg={}))});var de=N(rr=>{"use strict";var zw=rr&&rr.__createBinding||(Object.create?(function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}):(function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]})),Xg=rr&&rr.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&zw(e,n,t)};Object.defineProperty(rr,"__esModule",{value:!0});rr.createProtocolConnection=void 0;var Ww=Fu();Xg(Fu(),rr);Xg(Zg(),rr);function Bw(n,e,t,r){return(0,Ww.createMessageConnection)(n,e,t,r)}rr.createProtocolConnection=Bw});var ia=N($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.forEach=$t.mapAsync=$t.map=$t.clearTestMode=$t.setTestMode=$t.Semaphore=$t.Delayer=void 0;var Fs=de(),Qu=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,Fs.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};$t.Delayer=Qu;var el=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Fs.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};$t.Semaphore=el;var tl=!1;function Kw(){tl=!0}$t.setTestMode=Kw;function Gw(){tl=!1}$t.clearTestMode=Gw;var Jg=15,Ls=class{constructor(e=Jg){this.yieldAfter=tl===!0?Math.max(e,2):Math.max(e,Jg),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function Vw(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),s=new Ls(r?.yieldAfter);function o(c){s.start();for(let u=c;u<n.length;u++)if(i[u]=e(n[u]),s.shouldYield())return r?.yieldCallback&&r.yieldCallback(),u+1;return-1}let a=o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,Fs.RAL)().timer.setImmediate(()=>{c(o(a))})});return i}$t.map=Vw;async function Zw(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),s=new Ls(r?.yieldAfter);async function o(c){s.start();for(let u=c;u<n.length;u++)if(i[u]=await e(n[u],t),s.shouldYield())return r?.yieldCallback&&r.yieldCallback(),u+1;return-1}let a=await o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,Fs.RAL)().timer.setImmediate(()=>{c(o(a))})});return i}$t.mapAsync=Zw;async function Xw(n,e,t,r){if(n.length===0)return;let i=new Ls(r?.yieldAfter);function s(a){i.start();for(let c=a;c<n.length;c++)if(e(n[c]),i.shouldYield())return r?.yieldCallback&&r.yieldCallback(),c+1;return-1}let o=s(0);for(;o!==-1&&!(t!==void 0&&t.isCancellationRequested);)o=await new Promise(a=>{(0,Fs.RAL)().timer.setImmediate(()=>{a(s(o))})})}$t.forEach=Xw});var il=N(rl=>{"use strict";Object.defineProperty(rl,"__esModule",{value:!0});var Jw=require("vscode"),nl=class extends Jw.CompletionItem{constructor(e){super(e)}};rl.default=nl});var al=N(ol=>{"use strict";Object.defineProperty(ol,"__esModule",{value:!0});var Yw=require("vscode"),sl=class extends Yw.CodeLens{constructor(e){super(e)}};ol.default=sl});var ll=N(ul=>{"use strict";Object.defineProperty(ul,"__esModule",{value:!0});var Qw=require("vscode"),cl=class extends Qw.DocumentLink{constructor(e,t){super(e,t)}};ul.default=cl});var hl=N(fl=>{"use strict";Object.defineProperty(fl,"__esModule",{value:!0});var e_=require("vscode"),dl=class extends e_.CodeAction{constructor(e,t){super(e),this.data=t}};fl.default=dl});var gl=N(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});Qi.ProtocolDiagnostic=Qi.DiagnosticCode=void 0;var t_=require("vscode"),pl=_n(),Yg;(function(n){function e(t){let r=t;return r!=null&&(pl.number(r.value)||pl.string(r.value))&&pl.string(r.target)}n.is=e})(Yg||(Qi.DiagnosticCode=Yg={}));var ml=class extends t_.Diagnostic{constructor(e,t,r,i){super(e,t,r),this.data=i,this.hasDiagnosticCode=!1}};Qi.ProtocolDiagnostic=ml});var bl=N(vl=>{"use strict";Object.defineProperty(vl,"__esModule",{value:!0});var n_=require("vscode"),yl=class extends n_.CallHierarchyItem{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,o),a!==void 0&&(this.data=a)}};vl.default=yl});var _l=N(wl=>{"use strict";Object.defineProperty(wl,"__esModule",{value:!0});var r_=require("vscode"),Cl=class extends r_.TypeHierarchyItem{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,o),a!==void 0&&(this.data=a)}};wl.default=Cl});var El=N(Tl=>{"use strict";Object.defineProperty(Tl,"__esModule",{value:!0});var sa=require("vscode"),Sl=class extends sa.SymbolInformation{constructor(e,t,r,i,s){let o=!(i instanceof sa.Uri);super(e,t,r,o?i:new sa.Location(i,new sa.Range(0,0,0,0))),this.hasRange=o,s!==void 0&&(this.data=s)}};Tl.default=Sl});var xl=N(Dl=>{"use strict";Object.defineProperty(Dl,"__esModule",{value:!0});var i_=require("vscode"),Rl=class extends i_.InlayHint{constructor(e,t,r){super(e,t,r)}};Dl.default=Rl});var ny=N(oa=>{"use strict";Object.defineProperty(oa,"__esModule",{value:!0});oa.createConverter=void 0;var St=require("vscode"),fe=de(),ii=_n(),Qg=ia(),s_=il(),o_=al(),a_=ll(),ey=hl(),ty=gl(),c_=bl(),u_=_l(),l_=El(),d_=xl(),Pl;(function(n){function e(t){let r=t;return r&&!!r.inserting&&!!r.replacing}n.is=e})(Pl||(Pl={}));function f_(n){let t=n||(p=>p.toString());function r(p){return t(p)}function i(p){return{uri:t(p.uri)}}function s(p){return{uri:t(p.uri),languageId:p.languageId,version:p.version,text:p.getText()}}function o(p){return{uri:t(p.uri),version:p.version}}function a(p){return{textDocument:s(p)}}function c(p){let L=p;return!!L.document&&!!L.contentChanges}function u(p){let L=p;return!!L.uri&&!!L.version}function d(p,L,te){if(u(p))return{textDocument:{uri:t(p.uri),version:p.version},contentChanges:[{text:p.getText()}]};if(c(p)){let Me=L,I=te;return{textDocument:{uri:t(Me),version:I},contentChanges:p.contentChanges.map(E=>{let R=E.range;return{range:{start:{line:R.start.line,character:R.start.character},end:{line:R.end.line,character:R.end.character}},rangeLength:E.rangeLength,text:E.text}})}}else throw Error("Unsupported text document change parameter")}function v(p){return{textDocument:i(p)}}function b(p,L=!1){let te={textDocument:i(p)};return L&&(te.text=p.getText()),te}function g(p){switch(p){case St.TextDocumentSaveReason.Manual:return fe.TextDocumentSaveReason.Manual;case St.TextDocumentSaveReason.AfterDelay:return fe.TextDocumentSaveReason.AfterDelay;case St.TextDocumentSaveReason.FocusOut:return fe.TextDocumentSaveReason.FocusOut}return fe.TextDocumentSaveReason.Manual}function h(p){return{textDocument:i(p.document),reason:g(p.reason)}}function w(p){return{files:p.files.map(L=>({uri:t(L)}))}}function _(p){return{files:p.files.map(L=>({oldUri:t(L.oldUri),newUri:t(L.newUri)}))}}function D(p){return{files:p.files.map(L=>({uri:t(L)}))}}function k(p){return{files:p.files.map(L=>({uri:t(L)}))}}function y(p){return{files:p.files.map(L=>({oldUri:t(L.oldUri),newUri:t(L.newUri)}))}}function x(p){return{files:p.files.map(L=>({uri:t(L)}))}}function O(p,L){return{textDocument:i(p),position:Ct(L)}}function U(p){switch(p){case St.CompletionTriggerKind.TriggerCharacter:return fe.CompletionTriggerKind.TriggerCharacter;case St.CompletionTriggerKind.TriggerForIncompleteCompletions:return fe.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return fe.CompletionTriggerKind.Invoked}}function F(p,L,te){return{textDocument:i(p),position:Ct(L),context:{triggerKind:U(te.triggerKind),triggerCharacter:te.triggerCharacter}}}function G(p){switch(p){case St.SignatureHelpTriggerKind.Invoke:return fe.SignatureHelpTriggerKind.Invoked;case St.SignatureHelpTriggerKind.TriggerCharacter:return fe.SignatureHelpTriggerKind.TriggerCharacter;case St.SignatureHelpTriggerKind.ContentChange:return fe.SignatureHelpTriggerKind.ContentChange}}function Y(p){return{label:p.label}}function ve(p){return p.map(Y)}function oe(p){return{label:p.label,parameters:ve(p.parameters)}}function qe(p){return p.map(oe)}function Xe(p){return p===void 0?p:{signatures:qe(p.signatures),activeSignature:p.activeSignature,activeParameter:p.activeParameter}}function bt(p,L,te){return{textDocument:i(p),position:Ct(L),context:{isRetrigger:te.isRetrigger,triggerCharacter:te.triggerCharacter,triggerKind:G(te.triggerKind),activeSignatureHelp:Xe(te.activeSignatureHelp)}}}function Ct(p){return{line:p.line,character:p.character}}function yt(p){return p==null?p:{line:p.line>fe.uinteger.MAX_VALUE?fe.uinteger.MAX_VALUE:p.line,character:p.character>fe.uinteger.MAX_VALUE?fe.uinteger.MAX_VALUE:p.character}}function Mn(p,L){return Qg.map(p,yt,L)}function Kn(p){return p.map(yt)}function Ve(p){return p==null?p:{start:yt(p.start),end:yt(p.end)}}function Yt(p){return p.map(Ve)}function Kt(p){return p==null?p:fe.Location.create(r(p.uri),Ve(p.range))}function It(p){switch(p){case St.DiagnosticSeverity.Error:return fe.DiagnosticSeverity.Error;case St.DiagnosticSeverity.Warning:return fe.DiagnosticSeverity.Warning;case St.DiagnosticSeverity.Information:return fe.DiagnosticSeverity.Information;case St.DiagnosticSeverity.Hint:return fe.DiagnosticSeverity.Hint}}function Er(p){if(!p)return;let L=[];for(let te of p){let Me=Gn(te);Me!==void 0&&L.push(Me)}return L.length>0?L:void 0}function Gn(p){switch(p){case St.DiagnosticTag.Unnecessary:return fe.DiagnosticTag.Unnecessary;case St.DiagnosticTag.Deprecated:return fe.DiagnosticTag.Deprecated;default:return}}function Vn(p){return{message:p.message,location:Kt(p.location)}}function lr(p){return p.map(Vn)}function Rr(p){if(p!=null)return ii.number(p)||ii.string(p)?p:{value:p.value,target:r(p.target)}}function Zn(p){let L=fe.Diagnostic.create(Ve(p.range),p.message),te=p instanceof ty.ProtocolDiagnostic?p:void 0;te!==void 0&&te.data!==void 0&&(L.data=te.data);let Me=Rr(p.code);return ty.DiagnosticCode.is(Me)?te!==void 0&&te.hasDiagnosticCode?L.code=Me:(L.code=Me.value,L.codeDescription={href:Me.target}):L.code=Me,ii.number(p.severity)&&(L.severity=It(p.severity)),Array.isArray(p.tags)&&(L.tags=Er(p.tags)),p.relatedInformation&&(L.relatedInformation=lr(p.relatedInformation)),p.source&&(L.source=p.source),L}function Nn(p,L){return p==null?p:Qg.map(p,Zn,L)}function Ln(p){return p==null?p:p.map(Zn)}function Xn(p,L){switch(p){case"$string":return L;case fe.MarkupKind.PlainText:return{kind:p,value:L};case fe.MarkupKind.Markdown:return{kind:p,value:L.value};default:return`Unsupported Markup content received. Kind is: ${p}`}}function wt(p){if(p===St.CompletionItemTag.Deprecated)return fe.CompletionItemTag.Deprecated}function dr(p){if(p===void 0)return p;let L=[];for(let te of p){let Me=wt(te);Me!==void 0&&L.push(Me)}return L}function Fn(p,L){return L!==void 0?L:p+1}function Cn(p,L=!1){let te,Me;ii.string(p.label)?te=p.label:(te=p.label.label,L&&(p.label.detail!==void 0||p.label.description!==void 0)&&(Me={detail:p.label.detail,description:p.label.description}));let I={label:te};Me!==void 0&&(I.labelDetails=Me);let m=p instanceof s_.default?p:void 0;p.detail&&(I.detail=p.detail),p.documentation&&(!m||m.documentationFormat==="$string"?I.documentation=p.documentation:I.documentation=Xn(m.documentationFormat,p.documentation)),p.filterText&&(I.filterText=p.filterText),Dr(I,p),ii.number(p.kind)&&(I.kind=Fn(p.kind,m&&m.originalItemKind)),p.sortText&&(I.sortText=p.sortText),p.additionalTextEdits&&(I.additionalTextEdits=vt(p.additionalTextEdits)),p.commitCharacters&&(I.commitCharacters=p.commitCharacters.slice()),p.command&&(I.command=Z(p.command)),(p.preselect===!0||p.preselect===!1)&&(I.preselect=p.preselect);let E=dr(p.tags);if(m){if(m.data!==void 0&&(I.data=m.data),m.deprecated===!0||m.deprecated===!1){if(m.deprecated===!0&&E!==void 0&&E.length>0){let R=E.indexOf(St.CompletionItemTag.Deprecated);R!==-1&&E.splice(R,1)}I.deprecated=m.deprecated}m.insertTextMode!==void 0&&(I.insertTextMode=m.insertTextMode)}return E!==void 0&&E.length>0&&(I.tags=E),I.insertTextMode===void 0&&p.keepWhitespace===!0&&(I.insertTextMode=fe.InsertTextMode.adjustIndentation),I}function Dr(p,L){let te=fe.InsertTextFormat.PlainText,Me,I;L.textEdit?(Me=L.textEdit.newText,I=L.textEdit.range):L.insertText instanceof St.SnippetString?(te=fe.InsertTextFormat.Snippet,Me=L.insertText.value):Me=L.insertText,L.range&&(I=L.range),p.insertTextFormat=te,L.fromEdit&&Me!==void 0&&I!==void 0?p.textEdit=wn(Me,I):p.insertText=Me}function wn(p,L){return Pl.is(L)?fe.InsertReplaceEdit.create(p,Ve(L.inserting),Ve(L.replacing)):{newText:p,range:Ve(L)}}function Jn(p){return{range:Ve(p.range),newText:p.newText}}function vt(p){return p==null?p:p.map(Jn)}function qt(p){return p<=St.SymbolKind.TypeParameter?p+1:fe.SymbolKind.Property}function Ot(p){return p}function dn(p){return p.map(Ot)}function Qt(p,L,te){return{textDocument:i(p),position:Ct(L),context:{includeDeclaration:te.includeDeclaration}}}async function Yn(p,L){let te=fe.CodeAction.create(p.title);if(p instanceof ey.default&&p.data!==void 0&&(te.data=p.data),p.kind!==void 0&&(te.kind=T(p.kind)),p.diagnostics!==void 0&&(te.diagnostics=await Nn(p.diagnostics,L)),p.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return p.command!==void 0&&(te.command=Z(p.command)),p.isPreferred!==void 0&&(te.isPreferred=p.isPreferred),p.disabled!==void 0&&(te.disabled={reason:p.disabled.reason}),te}function fr(p){let L=fe.CodeAction.create(p.title);if(p instanceof ey.default&&p.data!==void 0&&(L.data=p.data),p.kind!==void 0&&(L.kind=T(p.kind)),p.diagnostics!==void 0&&(L.diagnostics=Ln(p.diagnostics)),p.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return p.command!==void 0&&(L.command=Z(p.command)),p.isPreferred!==void 0&&(L.isPreferred=p.isPreferred),p.disabled!==void 0&&(L.disabled={reason:p.disabled.reason}),L}async function qn(p,L){if(p==null)return p;let te;return p.only&&ii.string(p.only.value)&&(te=[p.only.value]),fe.CodeActionContext.create(await Nn(p.diagnostics,L),te,Gt(p.triggerKind))}function hr(p){if(p==null)return p;let L;return p.only&&ii.string(p.only.value)&&(L=[p.only.value]),fe.CodeActionContext.create(Ln(p.diagnostics),L,Gt(p.triggerKind))}function Gt(p){switch(p){case St.CodeActionTriggerKind.Invoke:return fe.CodeActionTriggerKind.Invoked;case St.CodeActionTriggerKind.Automatic:return fe.CodeActionTriggerKind.Automatic;default:return}}function T(p){if(p!=null)return p.value}function A(p){return p==null?p:fe.InlineValueContext.create(p.frameId,Ve(p.stoppedLocation))}function B(p,L,te){return{context:fe.InlineCompletionContext.create(te.triggerKind,te.selectedCompletionInfo),textDocument:i(p),position:yt(L)}}function Z(p){let L=fe.Command.create(p.title,p.command);return p.arguments&&(L.arguments=p.arguments),L}function ke(p){let L=fe.CodeLens.create(Ve(p.range));return p.command&&(L.command=Z(p.command)),p instanceof o_.default&&p.data&&(L.data=p.data),L}function xe(p,L){let te={tabSize:p.tabSize,insertSpaces:p.insertSpaces};return L.trimTrailingWhitespace&&(te.trimTrailingWhitespace=!0),L.trimFinalNewlines&&(te.trimFinalNewlines=!0),L.insertFinalNewline&&(te.insertFinalNewline=!0),te}function Ae(p){return{textDocument:i(p)}}function Ue(p){return{textDocument:i(p)}}function ge(p){let L=fe.DocumentLink.create(Ve(p.range));p.target&&(L.target=r(p.target)),p.tooltip!==void 0&&(L.tooltip=p.tooltip);let te=p instanceof a_.default?p:void 0;return te&&te.data&&(L.data=te.data),L}function Oe(p){return{textDocument:i(p)}}function Se(p){let L={name:p.name,kind:qt(p.kind),uri:r(p.uri),range:Ve(p.range),selectionRange:Ve(p.selectionRange)};return p.detail!==void 0&&p.detail.length>0&&(L.detail=p.detail),p.tags!==void 0&&(L.tags=dn(p.tags)),p instanceof c_.default&&p.data!==void 0&&(L.data=p.data),L}function ze(p){let L={name:p.name,kind:qt(p.kind),uri:r(p.uri),range:Ve(p.range),selectionRange:Ve(p.selectionRange)};return p.detail!==void 0&&p.detail.length>0&&(L.detail=p.detail),p.tags!==void 0&&(L.tags=dn(p.tags)),p instanceof u_.default&&p.data!==void 0&&(L.data=p.data),L}function lt(p){let L=p instanceof l_.default?{name:p.name,kind:qt(p.kind),location:p.hasRange?Kt(p.location):{uri:t(p.location.uri)},data:p.data}:{name:p.name,kind:qt(p.kind),location:Kt(p.location)};return p.tags!==void 0&&(L.tags=dn(p.tags)),p.containerName!==""&&(L.containerName=p.containerName),L}function Rt(p){let L=typeof p.label=="string"?p.label:p.label.map(xr),te=fe.InlayHint.create(yt(p.position),L);return p.kind!==void 0&&(te.kind=p.kind),p.textEdits!==void 0&&(te.textEdits=vt(p.textEdits)),p.tooltip!==void 0&&(te.tooltip=Pr(p.tooltip)),p.paddingLeft!==void 0&&(te.paddingLeft=p.paddingLeft),p.paddingRight!==void 0&&(te.paddingRight=p.paddingRight),p instanceof d_.default&&p.data!==void 0&&(te.data=p.data),te}function xr(p){let L=fe.InlayHintLabelPart.create(p.value);return p.location!==void 0&&(L.location=Kt(p.location)),p.command!==void 0&&(L.command=Z(p.command)),p.tooltip!==void 0&&(L.tooltip=Pr(p.tooltip)),L}function Pr(p){return typeof p=="string"?p:{kind:fe.MarkupKind.Markdown,value:p.value}}return{asUri:r,asTextDocumentIdentifier:i,asTextDocumentItem:s,asVersionedTextDocumentIdentifier:o,asOpenTextDocumentParams:a,asChangeTextDocumentParams:d,asCloseTextDocumentParams:v,asSaveTextDocumentParams:b,asWillSaveTextDocumentParams:h,asDidCreateFilesParams:w,asDidRenameFilesParams:_,asDidDeleteFilesParams:D,asWillCreateFilesParams:k,asWillRenameFilesParams:y,asWillDeleteFilesParams:x,asTextDocumentPositionParams:O,asCompletionParams:F,asSignatureHelpParams:bt,asWorkerPosition:Ct,asRange:Ve,asRanges:Yt,asPosition:yt,asPositions:Mn,asPositionsSync:Kn,asLocation:Kt,asDiagnosticSeverity:It,asDiagnosticTag:Gn,asDiagnostic:Zn,asDiagnostics:Nn,asDiagnosticsSync:Ln,asCompletionItem:Cn,asTextEdit:Jn,asSymbolKind:qt,asSymbolTag:Ot,asSymbolTags:dn,asReferenceParams:Qt,asCodeAction:Yn,asCodeActionSync:fr,asCodeActionContext:qn,asCodeActionContextSync:hr,asInlineValueContext:A,asCommand:Z,asCodeLens:ke,asFormattingOptions:xe,asDocumentSymbolParams:Ae,asCodeLensParams:Ue,asDocumentLink:ge,asDocumentLinkParams:Oe,asCallHierarchyItem:Se,asTypeHierarchyItem:ze,asInlayHint:Rt,asWorkspaceSymbol:lt,asInlineCompletionParams:B}}oa.createConverter=f_});var sy=N(ca=>{"use strict";Object.defineProperty(ca,"__esModule",{value:!0});ca.createConverter=void 0;var K=require("vscode"),ce=de(),En=_n(),Ie=ia(),h_=il(),p_=al(),m_=ll(),g_=hl(),ry=gl(),y_=bl(),v_=_l(),b_=El(),C_=xl(),iy=de(),aa;(function(n){function e(t){let r=t;return r&&En.string(r.language)&&En.string(r.value)}n.is=e})(aa||(aa={}));function w_(n,e,t){let i=n||(l=>K.Uri.parse(l));function s(l){return i(l)}function o(l){let P=[];for(let H of l)if(typeof H=="string")P.push(H);else if(iy.NotebookCellTextDocumentFilter.is(H))if(typeof H.notebook=="string")P.push({notebookType:H.notebook,language:H.language});else{let ne=H.notebook.notebookType??"*";P.push({notebookType:ne,scheme:H.notebook.scheme,pattern:H.notebook.pattern,language:H.language})}else iy.TextDocumentFilter.is(H)&&P.push({language:H.language,scheme:H.scheme,pattern:H.pattern});return P}async function a(l,P){return Ie.map(l,u,P)}function c(l){let P=new Array(l.length);for(let H=0;H<l.length;H++)P[H]=u(l[H]);return P}function u(l){let P=new ry.ProtocolDiagnostic(h(l.range),l.message,_(l.severity),l.data);if(l.code!==void 0){if(typeof l.code=="string"||typeof l.code=="number")ce.CodeDescription.is(l.codeDescription)?P.code={value:l.code,target:s(l.codeDescription.href)}:P.code=l.code;else if(ry.DiagnosticCode.is(l.code)){P.hasDiagnosticCode=!0;let H=l.code;P.code={value:H.value,target:s(H.target)}}}return l.source&&(P.source=l.source),l.relatedInformation&&(P.relatedInformation=d(l.relatedInformation)),Array.isArray(l.tags)&&(P.tags=v(l.tags)),P}function d(l){let P=new Array(l.length);for(let H=0;H<l.length;H++){let ne=l[H];P[H]=new K.DiagnosticRelatedInformation(It(ne.location),ne.message)}return P}function v(l){if(!l)return;let P=[];for(let H of l){let ne=b(H);ne!==void 0&&P.push(ne)}return P.length>0?P:void 0}function b(l){switch(l){case ce.DiagnosticTag.Unnecessary:return K.DiagnosticTag.Unnecessary;case ce.DiagnosticTag.Deprecated:return K.DiagnosticTag.Deprecated;default:return}}function g(l){return l?new K.Position(l.line,l.character):void 0}function h(l){return l?new K.Range(l.start.line,l.start.character,l.end.line,l.end.character):void 0}async function w(l,P){return Ie.map(l,H=>new K.Range(H.start.line,H.start.character,H.end.line,H.end.character),P)}function _(l){if(l==null)return K.DiagnosticSeverity.Error;switch(l){case ce.DiagnosticSeverity.Error:return K.DiagnosticSeverity.Error;case ce.DiagnosticSeverity.Warning:return K.DiagnosticSeverity.Warning;case ce.DiagnosticSeverity.Information:return K.DiagnosticSeverity.Information;case ce.DiagnosticSeverity.Hint:return K.DiagnosticSeverity.Hint}return K.DiagnosticSeverity.Error}function D(l){if(En.string(l))return y(l);if(aa.is(l))return y().appendCodeblock(l.value,l.language);if(Array.isArray(l)){let P=[];for(let H of l){let ne=y();aa.is(H)?ne.appendCodeblock(H.value,H.language):ne.appendMarkdown(H),P.push(ne)}return P}else return y(l)}function k(l){if(En.string(l))return l;switch(l.kind){case ce.MarkupKind.Markdown:return y(l.value);case ce.MarkupKind.PlainText:return l.value;default:return`Unsupported Markup content received. Kind is: ${l.kind}`}}function y(l){let P;if(l===void 0||typeof l=="string")P=new K.MarkdownString(l);else switch(l.kind){case ce.MarkupKind.Markdown:P=new K.MarkdownString(l.value);break;case ce.MarkupKind.PlainText:P=new K.MarkdownString,P.appendText(l.value);break;default:P=new K.MarkdownString,P.appendText(`Unsupported Markup content received. Kind is: ${l.kind}`);break}return P.isTrusted=e,P.supportHtml=t,P}function x(l){if(l)return new K.Hover(D(l.contents),h(l.range))}async function O(l,P,H){if(!l)return;if(Array.isArray(l))return Ie.map(l,er=>ve(er,P),H);let ne=l,{defaultRange:Dt,commitCharacters:Mt}=U(ne,P),He=await Ie.map(ne.items,er=>ve(er,Mt,Dt,ne.itemDefaults?.insertTextMode,ne.itemDefaults?.insertTextFormat,ne.itemDefaults?.data),H);return new K.CompletionList(He,ne.isIncomplete)}function U(l,P){let H=l.itemDefaults?.editRange,ne=l.itemDefaults?.commitCharacters??P;return ce.Range.is(H)?{defaultRange:h(H),commitCharacters:ne}:H!==void 0?{defaultRange:{inserting:h(H.insert),replacing:h(H.replace)},commitCharacters:ne}:{defaultRange:void 0,commitCharacters:ne}}function F(l){return ce.CompletionItemKind.Text<=l&&l<=ce.CompletionItemKind.TypeParameter?[l-1,void 0]:[K.CompletionItemKind.Text,l]}function G(l){if(l===ce.CompletionItemTag.Deprecated)return K.CompletionItemTag.Deprecated}function Y(l){if(l==null)return[];let P=[];for(let H of l){let ne=G(H);ne!==void 0&&P.push(ne)}return P}function ve(l,P,H,ne,Dt,Mt){let He=Y(l.tags),er=oe(l),Be=new h_.default(er);l.detail&&(Be.detail=l.detail),l.documentation&&(Be.documentation=k(l.documentation),Be.documentationFormat=En.string(l.documentation)?"$string":l.documentation.kind),l.filterText&&(Be.filterText=l.filterText);let go=qe(l,H,Dt);if(go&&(Be.insertText=go.text,Be.range=go.range,Be.fromEdit=go.fromEdit),En.number(l.kind)){let[IC,ph]=F(l.kind);Be.kind=IC,ph&&(Be.originalItemKind=ph)}l.sortText&&(Be.sortText=l.sortText),l.additionalTextEdits&&(Be.additionalTextEdits=yt(l.additionalTextEdits));let fh=l.commitCharacters!==void 0?En.stringArray(l.commitCharacters)?l.commitCharacters:void 0:P;fh&&(Be.commitCharacters=fh.slice()),l.command&&(Be.command=vt(l.command)),(l.deprecated===!0||l.deprecated===!1)&&(Be.deprecated=l.deprecated,l.deprecated===!0&&He.push(K.CompletionItemTag.Deprecated)),(l.preselect===!0||l.preselect===!1)&&(Be.preselect=l.preselect);let hh=l.data??Mt;hh!==void 0&&(Be.data=hh),He.length>0&&(Be.tags=He);let Tc=l.insertTextMode??ne;return Tc!==void 0&&(Be.insertTextMode=Tc,Tc===ce.InsertTextMode.asIs&&(Be.keepWhitespace=!0)),Be}function oe(l){return ce.CompletionItemLabelDetails.is(l.labelDetails)?{label:l.label,detail:l.labelDetails.detail,description:l.labelDetails.description}:l.label}function qe(l,P,H){let ne=l.insertTextFormat??H;if(l.textEdit!==void 0||P!==void 0){let[Dt,Mt]=l.textEdit!==void 0?Xe(l.textEdit):[P,l.textEditText??l.label];return ne===ce.InsertTextFormat.Snippet?{text:new K.SnippetString(Mt),range:Dt,fromEdit:!0}:{text:Mt,range:Dt,fromEdit:!0}}else return l.insertText?ne===ce.InsertTextFormat.Snippet?{text:new K.SnippetString(l.insertText),fromEdit:!1}:{text:l.insertText,fromEdit:!1}:void 0}function Xe(l){return ce.InsertReplaceEdit.is(l)?[{inserting:h(l.insert),replacing:h(l.replace)},l.newText]:[h(l.range),l.newText]}function bt(l){if(l)return new K.TextEdit(h(l.range),l.newText)}async function Ct(l,P){if(l)return Ie.map(l,bt,P)}function yt(l){if(!l)return;let P=new Array(l.length);for(let H=0;H<l.length;H++)P[H]=bt(l[H]);return P}async function Mn(l,P){if(!l)return;let H=new K.SignatureHelp;return En.number(l.activeSignature)?H.activeSignature=l.activeSignature:H.activeSignature=0,En.number(l.activeParameter)?H.activeParameter=l.activeParameter:H.activeParameter=0,l.signatures&&(H.signatures=await Kn(l.signatures,P)),H}async function Kn(l,P){return Ie.mapAsync(l,Ve,P)}async function Ve(l,P){let H=new K.SignatureInformation(l.label);return l.documentation!==void 0&&(H.documentation=k(l.documentation)),l.parameters!==void 0&&(H.parameters=await Yt(l.parameters,P)),l.activeParameter!==void 0&&(H.activeParameter=l.activeParameter),H}function Yt(l,P){return Ie.map(l,Kt,P)}function Kt(l){let P=new K.ParameterInformation(l.label);return l.documentation&&(P.documentation=k(l.documentation)),P}function It(l){return l?new K.Location(i(l.uri),h(l.range)):void 0}async function Er(l,P){if(l)return lr(l,P)}async function Gn(l,P){if(l)return lr(l,P)}function Vn(l){if(!l)return;let P={targetUri:i(l.targetUri),targetRange:h(l.targetRange),originSelectionRange:h(l.originSelectionRange),targetSelectionRange:h(l.targetSelectionRange)};if(!P.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return P}async function lr(l,P){if(l)if(En.array(l)){if(l.length===0)return[];if(ce.LocationLink.is(l[0])){let H=l;return Ie.map(H,Vn,P)}else{let H=l;return Ie.map(H,It,P)}}else return ce.LocationLink.is(l)?[Vn(l)]:It(l)}async function Rr(l,P){if(l)return Ie.map(l,It,P)}async function Zn(l,P){if(l)return Ie.map(l,Nn,P)}function Nn(l){let P=new K.DocumentHighlight(h(l.range));return En.number(l.kind)&&(P.kind=Ln(l.kind)),P}function Ln(l){switch(l){case ce.DocumentHighlightKind.Text:return K.DocumentHighlightKind.Text;case ce.DocumentHighlightKind.Read:return K.DocumentHighlightKind.Read;case ce.DocumentHighlightKind.Write:return K.DocumentHighlightKind.Write}return K.DocumentHighlightKind.Text}async function Xn(l,P){if(l)return Ie.map(l,Cn,P)}function wt(l){return l<=ce.SymbolKind.TypeParameter?l-1:K.SymbolKind.Property}function dr(l){if(l===ce.SymbolTag.Deprecated)return K.SymbolTag.Deprecated}function Fn(l){if(l==null)return;let P=[];for(let H of l){let ne=dr(H);ne!==void 0&&P.push(ne)}return P.length===0?void 0:P}function Cn(l){let P=l.data,H=l.location,ne=H.range===void 0||P!==void 0?new b_.default(l.name,wt(l.kind),l.containerName??"",H.range===void 0?i(H.uri):new K.Location(i(l.location.uri),h(H.range)),P):new K.SymbolInformation(l.name,wt(l.kind),l.containerName??"",new K.Location(i(l.location.uri),h(H.range)));return Jn(ne,l),ne}async function Dr(l,P){if(l!=null)return Ie.map(l,wn,P)}function wn(l){let P=new K.DocumentSymbol(l.name,l.detail||"",wt(l.kind),h(l.range),h(l.selectionRange));if(Jn(P,l),l.children!==void 0&&l.children.length>0){let H=[];for(let ne of l.children)H.push(wn(ne));P.children=H}return P}function Jn(l,P){l.tags=Fn(P.tags),P.deprecated&&(l.tags?l.tags.includes(K.SymbolTag.Deprecated)||(l.tags=l.tags.concat(K.SymbolTag.Deprecated)):l.tags=[K.SymbolTag.Deprecated])}function vt(l){let P={title:l.title,command:l.command};return l.arguments&&(P.arguments=l.arguments),P}async function qt(l,P){if(l)return Ie.map(l,vt,P)}let Ot=new Map;Ot.set(ce.CodeActionKind.Empty,K.CodeActionKind.Empty),Ot.set(ce.CodeActionKind.QuickFix,K.CodeActionKind.QuickFix),Ot.set(ce.CodeActionKind.Refactor,K.CodeActionKind.Refactor),Ot.set(ce.CodeActionKind.RefactorExtract,K.CodeActionKind.RefactorExtract),Ot.set(ce.CodeActionKind.RefactorInline,K.CodeActionKind.RefactorInline),Ot.set(ce.CodeActionKind.RefactorRewrite,K.CodeActionKind.RefactorRewrite),Ot.set(ce.CodeActionKind.Source,K.CodeActionKind.Source),Ot.set(ce.CodeActionKind.SourceOrganizeImports,K.CodeActionKind.SourceOrganizeImports);function dn(l){if(l==null)return;let P=Ot.get(l);if(P)return P;let H=l.split(".");P=K.CodeActionKind.Empty;for(let ne of H)P=P.append(ne);return P}function Qt(l){if(l!=null)return l.map(P=>dn(P))}async function Yn(l,P){if(l==null)return;let H=new g_.default(l.title,l.data);return l.kind!==void 0&&(H.kind=dn(l.kind)),l.diagnostics!==void 0&&(H.diagnostics=c(l.diagnostics)),l.edit!==void 0&&(H.edit=await Gt(l.edit,P)),l.command!==void 0&&(H.command=vt(l.command)),l.isPreferred!==void 0&&(H.isPreferred=l.isPreferred),l.disabled!==void 0&&(H.disabled={reason:l.disabled.reason}),H}function fr(l,P){return Ie.mapAsync(l,async H=>ce.Command.is(H)?vt(H):Yn(H,P),P)}function qn(l){if(!l)return;let P=new p_.default(h(l.range));return l.command&&(P.command=vt(l.command)),l.data!==void 0&&l.data!==null&&(P.data=l.data),P}async function hr(l,P){if(l)return Ie.map(l,qn,P)}async function Gt(l,P){if(!l)return;let H=new Map;if(l.changeAnnotations!==void 0){let Mt=l.changeAnnotations;await Ie.forEach(Object.keys(Mt),He=>{let er=T(Mt[He]);H.set(He,er)},P)}let ne=Mt=>{if(Mt!==void 0)return H.get(Mt)},Dt=new K.WorkspaceEdit;if(l.documentChanges){let Mt=l.documentChanges;await Ie.forEach(Mt,He=>{if(ce.CreateFile.is(He))Dt.createFile(i(He.uri),He.options,ne(He.annotationId));else if(ce.RenameFile.is(He))Dt.renameFile(i(He.oldUri),i(He.newUri),He.options,ne(He.annotationId));else if(ce.DeleteFile.is(He))Dt.deleteFile(i(He.uri),He.options,ne(He.annotationId));else if(ce.TextDocumentEdit.is(He)){let er=i(He.textDocument.uri);for(let Be of He.edits)ce.AnnotatedTextEdit.is(Be)?Dt.replace(er,h(Be.range),Be.newText,ne(Be.annotationId)):Dt.replace(er,h(Be.range),Be.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(He,void 0,4)}`)},P)}else if(l.changes){let Mt=l.changes;await Ie.forEach(Object.keys(Mt),He=>{Dt.set(i(He),yt(Mt[He]))},P)}return Dt}function T(l){if(l!==void 0)return{label:l.label,needsConfirmation:!!l.needsConfirmation,description:l.description}}function A(l){let P=h(l.range),H=l.target?s(l.target):void 0,ne=new m_.default(P,H);return l.tooltip!==void 0&&(ne.tooltip=l.tooltip),l.data!==void 0&&l.data!==null&&(ne.data=l.data),ne}async function B(l,P){if(l)return Ie.map(l,A,P)}function Z(l){return new K.Color(l.red,l.green,l.blue,l.alpha)}function ke(l){return new K.ColorInformation(h(l.range),Z(l.color))}async function xe(l,P){if(l)return Ie.map(l,ke,P)}function Ae(l){let P=new K.ColorPresentation(l.label);return P.additionalTextEdits=yt(l.additionalTextEdits),l.textEdit&&(P.textEdit=bt(l.textEdit)),P}async function Ue(l,P){if(l)return Ie.map(l,Ae,P)}function ge(l){if(l)switch(l){case ce.FoldingRangeKind.Comment:return K.FoldingRangeKind.Comment;case ce.FoldingRangeKind.Imports:return K.FoldingRangeKind.Imports;case ce.FoldingRangeKind.Region:return K.FoldingRangeKind.Region}}function Oe(l){return new K.FoldingRange(l.startLine,l.endLine,ge(l.kind))}async function Se(l,P){if(l)return Ie.map(l,Oe,P)}function ze(l){return new K.SelectionRange(h(l.range),l.parent?ze(l.parent):void 0)}async function lt(l,P){return Array.isArray(l)?Ie.map(l,ze,P):[]}function Rt(l){return ce.InlineValueText.is(l)?new K.InlineValueText(h(l.range),l.text):ce.InlineValueVariableLookup.is(l)?new K.InlineValueVariableLookup(h(l.range),l.variableName,l.caseSensitiveLookup):new K.InlineValueEvaluatableExpression(h(l.range),l.expression)}async function xr(l,P){return Array.isArray(l)?Ie.map(l,Rt,P):[]}async function Pr(l,P){let H=typeof l.label=="string"?l.label:await Ie.map(l.label,p,P),ne=new C_.default(g(l.position),H);return l.kind!==void 0&&(ne.kind=l.kind),l.textEdits!==void 0&&(ne.textEdits=await Ct(l.textEdits,P)),l.tooltip!==void 0&&(ne.tooltip=L(l.tooltip)),l.paddingLeft!==void 0&&(ne.paddingLeft=l.paddingLeft),l.paddingRight!==void 0&&(ne.paddingRight=l.paddingRight),l.data!==void 0&&(ne.data=l.data),ne}function p(l){let P=new K.InlayHintLabelPart(l.value);return l.location!==void 0&&(P.location=It(l.location)),l.tooltip!==void 0&&(P.tooltip=L(l.tooltip)),l.command!==void 0&&(P.command=vt(l.command)),P}function L(l){return typeof l=="string"?l:y(l)}async function te(l,P){if(Array.isArray(l))return Ie.mapAsync(l,Pr,P)}function Me(l){if(l===null)return;let P=new y_.default(wt(l.kind),l.name,l.detail||"",s(l.uri),h(l.range),h(l.selectionRange),l.data);return l.tags!==void 0&&(P.tags=Fn(l.tags)),P}async function I(l,P){if(l!==null)return Ie.map(l,Me,P)}async function m(l,P){return new K.CallHierarchyIncomingCall(Me(l.from),await w(l.fromRanges,P))}async function E(l,P){if(l!==null)return Ie.mapAsync(l,m,P)}async function R(l,P){return new K.CallHierarchyOutgoingCall(Me(l.to),await w(l.fromRanges,P))}async function C(l,P){if(l!==null)return Ie.mapAsync(l,R,P)}async function f(l,P){if(l!=null)return new K.SemanticTokens(new Uint32Array(l.data),l.resultId)}function M(l){return new K.SemanticTokensEdit(l.start,l.deleteCount,l.data!==void 0?new Uint32Array(l.data):void 0)}async function j(l,P){if(l!=null)return new K.SemanticTokensEdits(l.edits.map(M),l.resultId)}function le(l){return l}async function Qe(l,P){if(l!=null)return new K.LinkedEditingRanges(await w(l.ranges,P),We(l.wordPattern))}function We(l){if(l!=null)return new RegExp(l)}function en(l){if(l===null)return;let P=new v_.default(wt(l.kind),l.name,l.detail||"",s(l.uri),h(l.range),h(l.selectionRange),l.data);return l.tags!==void 0&&(P.tags=Fn(l.tags)),P}async function fn(l,P){if(l!==null)return Ie.map(l,en,P)}function An(l){if(En.string(l))return l;if(ce.RelativePattern.is(l)){if(ce.URI.is(l.baseUri))return new K.RelativePattern(s(l.baseUri),l.pattern);if(ce.WorkspaceFolder.is(l.baseUri)){let P=K.workspace.getWorkspaceFolder(s(l.baseUri.uri));return P!==void 0?new K.RelativePattern(P,l.pattern):void 0}}}async function we(l,P){if(!l)return;if(Array.isArray(l))return Ie.map(l,Dt=>Qn(Dt),P);let H=l,ne=await Ie.map(H.items,Dt=>Qn(Dt),P);return new K.InlineCompletionList(ne)}function Qn(l){let P;typeof l.insertText=="string"?P=l.insertText:P=new K.SnippetString(l.insertText.value);let H;l.command&&(H=vt(l.command));let ne=new K.InlineCompletionItem(P,h(l.range),H);return l.filterText&&(ne.filterText=l.filterText),ne}return{asUri:s,asDocumentSelector:o,asDiagnostics:a,asDiagnostic:u,asRange:h,asRanges:w,asPosition:g,asDiagnosticSeverity:_,asDiagnosticTag:b,asHover:x,asCompletionResult:O,asCompletionItem:ve,asTextEdit:bt,asTextEdits:Ct,asSignatureHelp:Mn,asSignatureInformations:Kn,asSignatureInformation:Ve,asParameterInformations:Yt,asParameterInformation:Kt,asDeclarationResult:Er,asDefinitionResult:Gn,asLocation:It,asReferences:Rr,asDocumentHighlights:Zn,asDocumentHighlight:Nn,asDocumentHighlightKind:Ln,asSymbolKind:wt,asSymbolTag:dr,asSymbolTags:Fn,asSymbolInformations:Xn,asSymbolInformation:Cn,asDocumentSymbols:Dr,asDocumentSymbol:wn,asCommand:vt,asCommands:qt,asCodeAction:Yn,asCodeActionKind:dn,asCodeActionKinds:Qt,asCodeActionResult:fr,asCodeLens:qn,asCodeLenses:hr,asWorkspaceEdit:Gt,asDocumentLink:A,asDocumentLinks:B,asFoldingRangeKind:ge,asFoldingRange:Oe,asFoldingRanges:Se,asColor:Z,asColorInformation:ke,asColorInformations:xe,asColorPresentation:Ae,asColorPresentations:Ue,asSelectionRange:ze,asSelectionRanges:lt,asInlineValue:Rt,asInlineValues:xr,asInlayHint:Pr,asInlayHints:te,asSemanticTokensLegend:le,asSemanticTokens:f,asSemanticTokensEdit:M,asSemanticTokensEdits:j,asCallHierarchyItem:Me,asCallHierarchyItems:I,asCallHierarchyIncomingCall:m,asCallHierarchyIncomingCalls:E,asCallHierarchyOutgoingCall:R,asCallHierarchyOutgoingCalls:C,asLinkedEditingRanges:Qe,asTypeHierarchyItem:en,asTypeHierarchyItems:fn,asGlobPattern:An,asInlineCompletionResult:we,asInlineCompletionItem:Qn}}ca.createConverter=w_});var tt=N(Rn=>{"use strict";Object.defineProperty(Rn,"__esModule",{value:!0});Rn.generateUuid=Rn.parse=Rn.isUUID=Rn.v4=Rn.empty=void 0;var qs=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},As=class n extends qs{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return n._oneOf(n._chars)}constructor(){super([n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),"-",n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),"-","4",n._randomHex(),n._randomHex(),n._randomHex(),"-",n._oneOf(n._timeHighBits),n._randomHex(),n._randomHex(),n._randomHex(),"-",n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex()].join(""))}};As._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];As._timeHighBits=["8","9","a","b"];Rn.empty=new qs("00000000-0000-0000-0000-000000000000");function oy(){return new As}Rn.v4=oy;var __=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function ay(n){return __.test(n)}Rn.isUUID=ay;function S_(n){if(!ay(n))throw new Error("invalid uuid");return new qs(n)}Rn.parse=S_;function T_(){return oy().asHex()}Rn.generateUuid=T_});var Il=N(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.ProgressPart=void 0;var cy=require("vscode"),uy=de(),ly=_n(),kl=class{constructor(e,t,r){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(uy.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&cy.window.withProgress({location:cy.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(uy.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,s)=>{this._resolve=i,this._reject=s})})}report(e){if(this._infinite&&ly.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(ly.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,t-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};ua.ProgressPart=kl});var Pe=N(Pt=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});Pt.WorkspaceFeature=Pt.TextDocumentLanguageFeature=Pt.TextDocumentEventFeature=Pt.DynamicDocumentFeature=Pt.DynamicFeature=Pt.StaticFeature=Pt.ensure=Pt.LSPCancellationError=void 0;var si=require("vscode"),Ol=de(),Zt=_n(),dy=tt(),Ml=class extends si.CancellationError{constructor(e){super(),this.data=e}};Pt.LSPCancellationError=Ml;function E_(n,e){return n[e]===void 0&&(n[e]={}),n[e]}Pt.ensure=E_;var fy;(function(n){function e(t){let r=t;return r!=null&&Zt.func(r.fillClientCapabilities)&&Zt.func(r.initialize)&&Zt.func(r.getState)&&Zt.func(r.clear)&&(r.fillInitializeParams===void 0||Zt.func(r.fillInitializeParams))}n.is=e})(fy||(Pt.StaticFeature=fy={}));var hy;(function(n){function e(t){let r=t;return r!=null&&Zt.func(r.fillClientCapabilities)&&Zt.func(r.initialize)&&Zt.func(r.getState)&&Zt.func(r.clear)&&(r.fillInitializeParams===void 0||Zt.func(r.fillInitializeParams))&&Zt.func(r.register)&&Zt.func(r.unregister)&&r.registrationType!==void 0}n.is=e})(hy||(Pt.DynamicFeature=hy={}));var js=class{constructor(e){this._client=e}getState(){let e=this.getDocumentSelectors(),t=0;for(let i of e){t++;for(let s of si.workspace.textDocuments)if(si.languages.match(i,s)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}let r=t>0;return{kind:"document",id:this.registrationType.method,registrations:r,matches:!1}}};Pt.DynamicDocumentFeature=js;var Nl=class extends js{static textDocumentFilter(e,t){for(let r of e)if(si.languages.match(r,t)>0)return!0;return!1}constructor(e,t,r,i,s,o,a){super(e),this._event=t,this._type=r,this._middleware=i,this._createParams=s,this._textDocument=o,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new si.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async r=>{let i=this._createParams(r);await this._client.sendNotification(this._type,i),this.notificationSent(this.getTextDocument(r),this._type,i)};if(this.matches(e)){let r=this._middleware();return r?r(e,i=>t(i)):t(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(si.languages.match(t,e)>0)return{send:r=>this.callback(r)}}};Pt.TextDocumentEventFeature=Nl;var Ll=class extends js{constructor(e,t){super(e),this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(let e of this._registrations.values()){let t=e.data.registerOptions.documentSelector;t!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(Ol.TextDocumentRegistrationOptions.is(t)){let r=Ol.StaticRegistrationOptions.hasId(t)?t.id:dy.generateUuid(),i=t.documentSelector??e;if(i)return[r,Object.assign({},t,{documentSelector:i})]}else if(Zt.boolean(t)&&t===!0||Ol.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let r=Zt.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[dy.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return Zt.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&si.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e)>0)return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};Pt.TextDocumentLanguageFeature=Ll;var Fl=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){let e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};Pt.WorkspaceFeature=Fl});var my=N((OD,py)=>{var R_=typeof process=="object"&&process&&process.platform==="win32";py.exports=R_?{sep:"\\"}:{sep:"/"}});var Cy=N((MD,by)=>{"use strict";by.exports=yy;function yy(n,e,t){n instanceof RegExp&&(n=gy(n,t)),e instanceof RegExp&&(e=gy(e,t));var r=vy(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function gy(n,e){var t=e.match(n);return t?t[0]:null}yy.range=vy;function vy(n,e,t){var r,i,s,o,a,c=t.indexOf(n),u=t.indexOf(e,c+1),d=c;if(c>=0&&u>0){if(n===e)return[c,u];for(r=[],s=t.length;d>=0&&!a;)d==c?(r.push(d),c=t.indexOf(n,d+1)):r.length==1?a=[r.pop(),u]:(i=r.pop(),i<s&&(s=i,o=u),u=t.indexOf(e,d+1)),d=c<u&&c>=0?c:u;r.length&&(a=[s,o])}return a}});var xy=N((ND,Dy)=>{var wy=Cy();Dy.exports=P_;var _y="\0SLASH"+Math.random()+"\0",Sy="\0OPEN"+Math.random()+"\0",Al="\0CLOSE"+Math.random()+"\0",Ty="\0COMMA"+Math.random()+"\0",Ey="\0PERIOD"+Math.random()+"\0";function ql(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function D_(n){return n.split("\\\\").join(_y).split("\\{").join(Sy).split("\\}").join(Al).split("\\,").join(Ty).split("\\.").join(Ey)}function x_(n){return n.split(_y).join("\\").split(Sy).join("{").split(Al).join("}").split(Ty).join(",").split(Ey).join(".")}function Ry(n){if(!n)return[""];var e=[],t=wy("{","}",n);if(!t)return n.split(",");var r=t.pre,i=t.body,s=t.post,o=r.split(",");o[o.length-1]+="{"+i+"}";var a=Ry(s);return s.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),e.push.apply(e,o),e}function P_(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),Hs(D_(n),!0).map(x_)):[]}function k_(n){return"{"+n+"}"}function I_(n){return/^-?0\d/.test(n)}function O_(n,e){return n<=e}function M_(n,e){return n>=e}function Hs(n,e){var t=[],r=wy("{","}",n);if(!r)return[n];var i=r.pre,s=r.post.length?Hs(r.post,!1):[""];if(/\$$/.test(r.pre))for(var o=0;o<s.length;o++){var a=i+"{"+r.body+"}"+s[o];t.push(a)}else{var c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),d=c||u,v=r.body.indexOf(",")>=0;if(!d&&!v)return r.post.match(/,(?!,).*\}/)?(n=r.pre+"{"+r.body+Al+r.post,Hs(n)):[n];var b;if(d)b=r.body.split(/\.\./);else if(b=Ry(r.body),b.length===1&&(b=Hs(b[0],!1).map(k_),b.length===1))return s.map(function(ve){return r.pre+b[0]+ve});var g;if(d){var h=ql(b[0]),w=ql(b[1]),_=Math.max(b[0].length,b[1].length),D=b.length==3?Math.abs(ql(b[2])):1,k=O_,y=w<h;y&&(D*=-1,k=M_);var x=b.some(I_);g=[];for(var O=h;k(O,w);O+=D){var U;if(u)U=String.fromCharCode(O),U==="\\"&&(U="");else if(U=String(O),x){var F=_-U.length;if(F>0){var G=new Array(F+1).join("0");O<0?U="-"+G+U.slice(1):U=G+U}}g.push(U)}}else{g=[];for(var Y=0;Y<b.length;Y++)g.push.apply(g,Hs(b[Y],!1))}for(var Y=0;Y<g.length;Y++)for(var o=0;o<s.length;o++){var a=i+g[Y]+s[o];(!e||d||a)&&t.push(a)}}return t}});var da=N((FD,zl)=>{var mn=zl.exports=(n,e,t={})=>(la(e),!t.nocomment&&e.charAt(0)==="#"?!1:new es(e,t).match(n));zl.exports=mn;var $l=my();mn.sep=$l.sep;var $n=Symbol("globstar **");mn.GLOBSTAR=$n;var N_=xy(),Py={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Ul="[^/]",jl=Ul+"*?",L_="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",F_="(?:(?!(?:\\/|^)\\.).)*?",Oy=n=>n.split("").reduce((e,t)=>(e[t]=!0,e),{}),ky=Oy("().*{}+?[]^$\\!"),q_=Oy("[.("),Iy=/\/+/;mn.filter=(n,e={})=>(t,r,i)=>mn(t,n,e);var jr=(n,e={})=>{let t={};return Object.keys(n).forEach(r=>t[r]=n[r]),Object.keys(e).forEach(r=>t[r]=e[r]),t};mn.defaults=n=>{if(!n||typeof n!="object"||!Object.keys(n).length)return mn;let e=mn,t=(r,i,s)=>e(r,i,jr(n,s));return t.Minimatch=class extends e.Minimatch{constructor(i,s){super(i,jr(n,s))}},t.Minimatch.defaults=r=>e.defaults(jr(n,r)).Minimatch,t.filter=(r,i)=>e.filter(r,jr(n,i)),t.defaults=r=>e.defaults(jr(n,r)),t.makeRe=(r,i)=>e.makeRe(r,jr(n,i)),t.braceExpand=(r,i)=>e.braceExpand(r,jr(n,i)),t.match=(r,i,s)=>e.match(r,i,jr(n,s)),t};mn.braceExpand=(n,e)=>My(n,e);var My=(n,e={})=>(la(n),e.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:N_(n)),A_=1024*64,la=n=>{if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>A_)throw new TypeError("pattern is too long")},Hl=Symbol("subparse");mn.makeRe=(n,e)=>new es(n,e||{}).makeRe();mn.match=(n,e,t={})=>{let r=new es(e,t);return n=n.filter(i=>r.match(i)),r.options.nonull&&!n.length&&n.push(e),n};var j_=n=>n.replace(/\\(.)/g,"$1"),H_=n=>n.replace(/\\([^-\]])/g,"$1"),$_=n=>n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),U_=n=>n.replace(/[[\]\\]/g,"\\$&"),es=class{constructor(e,t){la(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let r=this.globSet=this.braceExpand();t.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,r),r=this.globParts=r.map(i=>i.split(Iy)),this.debug(this.pattern,r),r=r.map((i,s,o)=>i.map(this.parse,this)),this.debug(this.pattern,r),r=r.filter(i=>i.indexOf(!1)===-1),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,t=!1,r=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.slice(r)),this.negate=t}matchOne(e,t,r){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var s=0,o=0,a=e.length,c=t.length;s<a&&o<c;s++,o++){this.debug("matchOne loop");var u=t[o],d=e[s];if(this.debug(t,u,d),u===!1)return!1;if(u===$n){this.debug("GLOBSTAR",[t,u,d]);var v=s,b=o+1;if(b===c){for(this.debug("** at the end");s<a;s++)if(e[s]==="."||e[s]===".."||!i.dot&&e[s].charAt(0)===".")return!1;return!0}for(;v<a;){var g=e[v];if(this.debug(`
globstar while`,e,v,t,b,g),this.matchOne(e.slice(v),t.slice(b),r))return this.debug("globstar found match!",v,a,g),!0;if(g==="."||g===".."||!i.dot&&g.charAt(0)==="."){this.debug("dot detected!",e,v,t,b);break}this.debug("globstar swallow a segment, and continue"),v++}return!!(r&&(this.debug(`
>>> no match, partial?`,e,v,t,b),v===a))}var h;if(typeof u=="string"?(h=d===u,this.debug("string match",u,d,h)):(h=d.match(u),this.debug("pattern match",u,d,h)),!h)return!1}if(s===a&&o===c)return!0;if(s===a)return r;if(o===c)return s===a-1&&e[s]==="";throw new Error("wtf?")}braceExpand(){return My(this.pattern,this.options)}parse(e,t){la(e);let r=this.options;if(e==="**")if(r.noglobstar)e="*";else return $n;if(e==="")return"";let i="",s=!1,o=!1,a=[],c=[],u,d=!1,v=-1,b=-1,g,h,w,_=e.charAt(0)===".",D=r.dot||_,k=()=>_?"":D?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",y=F=>F.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",x=()=>{if(u){switch(u){case"*":i+=jl,s=!0;break;case"?":i+=Ul,s=!0;break;default:i+="\\"+u;break}this.debug("clearStateChar %j %j",u,i),u=!1}};for(let F=0,G;F<e.length&&(G=e.charAt(F));F++){if(this.debug("%s	%s %s %j",e,F,i,G),o){if(G==="/")return!1;ky[G]&&(i+="\\"),i+=G,o=!1;continue}switch(G){case"/":return!1;case"\\":if(d&&e.charAt(F+1)==="-"){i+=G;continue}x(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,F,i,G),d){this.debug("  in class"),G==="!"&&F===b+1&&(G="^"),i+=G;continue}this.debug("call clearStateChar %j",u),x(),u=G,r.noext&&x();continue;case"(":{if(d){i+="(";continue}if(!u){i+="\\(";continue}let Y={type:u,start:F-1,reStart:i.length,open:Py[u].open,close:Py[u].close};this.debug(this.pattern,"	",Y),a.push(Y),i+=Y.open,Y.start===0&&Y.type!=="!"&&(_=!0,i+=y(e.slice(F+1))),this.debug("plType %j %j",u,i),u=!1;continue}case")":{let Y=a[a.length-1];if(d||!Y){i+="\\)";continue}a.pop(),x(),s=!0,h=Y,i+=h.close,h.type==="!"&&c.push(Object.assign(h,{reEnd:i.length}));continue}case"|":{let Y=a[a.length-1];if(d||!Y){i+="\\|";continue}x(),i+="|",Y.start===0&&Y.type!=="!"&&(_=!0,i+=y(e.slice(F+1)));continue}case"[":if(x(),d){i+="\\"+G;continue}d=!0,b=F,v=i.length,i+=G;continue;case"]":if(F===b+1||!d){i+="\\"+G;continue}g=e.substring(b+1,F);try{RegExp("["+U_(H_(g))+"]"),i+=G}catch{i=i.substring(0,v)+"(?:$.)"}s=!0,d=!1;continue;default:x(),ky[G]&&!(G==="^"&&d)&&(i+="\\"),i+=G;break}}for(d&&(g=e.slice(b+1),w=this.parse(g,Hl),i=i.substring(0,v)+"\\["+w[0],s=s||w[1]),h=a.pop();h;h=a.pop()){let F;F=i.slice(h.reStart+h.open.length),this.debug("setting tail",i,h),F=F.replace(/((?:\\{2}){0,64})(\\?)\|/g,(Y,ve,oe)=>(oe||(oe="\\"),ve+ve+oe+"|")),this.debug(`tail=%j
   %s`,F,F,h,i);let G=h.type==="*"?jl:h.type==="?"?Ul:"\\"+h.type;s=!0,i=i.slice(0,h.reStart)+G+"\\("+F}x(),o&&(i+="\\\\");let O=q_[i.charAt(0)];for(let F=c.length-1;F>-1;F--){let G=c[F],Y=i.slice(0,G.reStart),ve=i.slice(G.reStart,G.reEnd-8),oe=i.slice(G.reEnd),qe=i.slice(G.reEnd-8,G.reEnd)+oe,Xe=Y.split(")").length,bt=Y.split("(").length-Xe,Ct=oe;for(let Mn=0;Mn<bt;Mn++)Ct=Ct.replace(/\)[+*?]?/,"");oe=Ct;let yt=oe===""&&t!==Hl?"(?:$|\\/)":"";i=Y+ve+oe+yt+qe}if(i!==""&&s&&(i="(?=.)"+i),O&&(i=k()+i),t===Hl)return[i,s];if(r.nocase&&!s&&(s=e.toUpperCase()!==e.toLowerCase()),!s)return j_(e);let U=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",U),{_glob:e,_src:i})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,r=t.noglobstar?jl:t.dot?L_:F_,i=t.nocase?"i":"",s=e.map(o=>(o=o.map(a=>typeof a=="string"?$_(a):a===$n?$n:a._src).reduce((a,c)=>(a[a.length-1]===$n&&c===$n||a.push(c),a),[]),o.forEach((a,c)=>{a!==$n||o[c-1]===$n||(c===0?o.length>1?o[c+1]="(?:\\/|"+r+"\\/)?"+o[c+1]:o[c]=r:c===o.length-1?o[c-1]+="(?:\\/|"+r+")?":(o[c-1]+="(?:\\/|\\/"+r+"\\/)"+o[c+1],o[c+1]=$n))}),o.filter(a=>a!==$n).join("/"))).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,i)}catch{this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;let r=this.options;$l.sep!=="/"&&(e=e.split($l.sep).join("/")),e=e.split(Iy),this.debug(this.pattern,"split",e);let i=this.set;this.debug(this.pattern,"set",i);let s;for(let o=e.length-1;o>=0&&(s=e[o],!s);o--);for(let o=0;o<i.length;o++){let a=i[o],c=e;if(r.matchBase&&a.length===1&&(c=[s]),this.matchOne(c,a,t))return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate}static defaults(e){return mn.defaults(e).Minimatch}};mn.Minimatch=es});var Jl=N(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.DiagnosticFeature=Hr.DiagnosticPullMode=Hr.vsdiag=void 0;var z_=da(),Te=require("vscode"),ht=de(),W_=tt(),Wl=Pe();function fa(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Dn;(function(n){let e;(function(t){t.full="full",t.unChanged="unChanged"})(e=n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={}))})(Dn||(Hr.vsdiag=Dn={}));var ha;(function(n){n.onType="onType",n.onSave="onSave"})(ha||(Hr.DiagnosticPullMode=ha={}));var Ut;(function(n){n.active="open",n.reschedule="reschedule",n.outDated="drop"})(Ut||(Ut={}));var Bl=class n{constructor(){this.open=new Set,this._onOpen=new Te.EventEmitter,this._onClose=new Te.EventEmitter,n.fillTabResources(this.open);let e=t=>{if(t.closed.length===0&&t.opened.length===0)return;let r=this.open,i=new Set;n.fillTabResources(i);let s=new Set,o=new Set(i);for(let a of r.values())i.has(a)?o.delete(a):s.add(a);if(this.open=i,s.size>0){let a=new Set;for(let c of s)a.add(Te.Uri.parse(c));this._onClose.fire(a)}if(o.size>0){let a=new Set;for(let c of o)a.add(Te.Uri.parse(c));this._onOpen.fire(a)}};Te.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=Te.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){return e instanceof Te.Uri?Te.window.activeTextEditor?.document.uri===e:Te.window.activeTextEditor?.document===e}isVisible(e){let t=e instanceof Te.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){let e=new Set;return n.fillTabResources(new Set,e),e}static fillTabResources(e,t){let r=e??new Set;for(let i of Te.window.tabGroups.all)for(let s of i.tabs){let o=s.input,a;o instanceof Te.TabInputText?a=o.uri:o instanceof Te.TabInputTextDiff?a=o.modified:o instanceof Te.TabInputCustom&&(a=o.uri),a!==void 0&&!r.has(a.toString())&&(r.add(a.toString()),t!==void 0&&t.add(a))}}},Tt;(function(n){n[n.document=1]="document",n[n.workspace=2]="workspace"})(Tt||(Tt={}));var gr;(function(n){function e(t){return t instanceof Te.Uri?t.toString():t.uri.toString()}n.asKey=e})(gr||(gr={}));var Kl=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,r){let i=e===Tt.document?this.documentPullStates:this.workspacePullStates,[s,o,a]=t instanceof Te.Uri?[t.toString(),t,r]:[t.uri.toString(),t.uri,t.version],c=i.get(s);return c===void 0&&(c={document:o,pulledVersion:a,resultId:void 0},i.set(s,c)),c}update(e,t,r,i){let s=e===Tt.document?this.documentPullStates:this.workspacePullStates,[o,a,c,u]=t instanceof Te.Uri?[t.toString(),t,r,i]:[t.uri.toString(),t.uri,t.version,r],d=s.get(o);d===void 0?(d={document:a,pulledVersion:c,resultId:u},s.set(o,d)):(d.pulledVersion=c,d.resultId=u)}unTrack(e,t){let r=gr.asKey(t);(e===Tt.document?this.documentPullStates:this.workspacePullStates).delete(r)}tracks(e,t){let r=gr.asKey(t);return(e===Tt.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,t){let r=gr.asKey(t);return(e===Tt.document?this.documentPullStates:this.workspacePullStates).get(r)?.resultId}getAllResultIds(){let e=[];for(let[t,r]of this.workspacePullStates)this.documentPullStates.has(t)&&(r=this.documentPullStates.get(t)),r.resultId!==void 0&&e.push({uri:t,value:r.resultId});return e}},Gl=class{constructor(e,t,r){this.client=e,this.tabs=t,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new Te.EventEmitter,this.provider=this.createProvider(),this.diagnostics=Te.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new Kl,this.workspaceErrorCounter=0}knows(e,t){let r=t instanceof Te.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(r.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;let r=e instanceof Te.Uri?e:e.uri;this.pullAsync(e).then(()=>{t&&t()},i=>{this.client.error(`Document pull failed for text document ${r.toString()}`,i,!1)})}async pullAsync(e,t){if(this.isDisposed)return;let r=e instanceof Te.Uri,i=r?e:e.uri,s=i.toString();t=r?t:e.version;let o=this.openRequests.get(s),a=r?this.documentStates.track(Tt.document,e,t):this.documentStates.track(Tt.document,e);if(o===void 0){let c=new Te.CancellationTokenSource;this.openRequests.set(s,{state:Ut.active,document:e,version:t,tokenSource:c});let u,d;try{u=await this.provider.provideDiagnostics(e,a.resultId,c.token)??{kind:Dn.DocumentDiagnosticReportKind.full,items:[]}}catch(v){if(v instanceof Wl.LSPCancellationError&&ht.DiagnosticServerCancellationData.is(v.data)&&v.data.retriggerRequest===!1&&(d={state:Ut.outDated,document:e}),d===void 0&&v instanceof Te.CancellationError)d={state:Ut.reschedule,document:e};else throw v}if(d=d??this.openRequests.get(s),d===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${s}`),this.diagnostics.delete(i);return}if(this.openRequests.delete(s),!this.tabs.isVisible(e)){this.documentStates.unTrack(Tt.document,e);return}if(d.state===Ut.outDated)return;u!==void 0&&(u.kind===Dn.DocumentDiagnosticReportKind.full&&this.diagnostics.set(i,u.items),a.pulledVersion=t,a.resultId=u.resultId),d.state===Ut.reschedule&&this.pull(e)}else o.state===Ut.active?(o.tokenSource.cancel(),this.openRequests.set(s,{state:Ut.reschedule,document:o.document})):o.state===Ut.outDated&&this.openRequests.set(s,{state:Ut.reschedule,document:o.document})}forgetDocument(e){let t=e instanceof Te.Uri?e:e.uri,r=t.toString(),i=this.openRequests.get(r);this.options.workspaceDiagnostics?i!==void 0?this.openRequests.set(r,{state:Ut.reschedule,document:e}):this.pull(e,()=>{this.forget(Tt.document,e)}):(i!==void 0&&(i.state===Ut.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:Ut.outDated,document:e})),this.diagnostics.delete(t),this.forget(Tt.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,ht.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof Wl.LSPCancellationError)&&!ht.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,ht.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new Te.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(let r of t.items)r.kind===Dn.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(Tt.document,r.uri)||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(Tt.workspace,r.uri,r.version??void 0,r.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,r,i)=>{let s=(a,c,u)=>{let d={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a instanceof Te.Uri?a:a.uri)},previousResultId:c};return this.isDisposed===!0||!this.client.isRunning()?{kind:Dn.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(ht.DocumentDiagnosticRequest.type,d,u).then(async v=>v==null||this.isDisposed||u.isCancellationRequested?{kind:Dn.DocumentDiagnosticReportKind.full,items:[]}:v.kind===ht.DocumentDiagnosticReportKind.Full?{kind:Dn.DocumentDiagnosticReportKind.full,resultId:v.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(v.items,u)}:{kind:Dn.DocumentDiagnosticReportKind.unChanged,resultId:v.resultId},v=>this.client.handleFailedRequest(ht.DocumentDiagnosticRequest.type,u,v,{kind:Dn.DocumentDiagnosticReportKind.full,items:[]}))},o=this.client.middleware;return o.provideDiagnostics?o.provideDiagnostics(t,r,i,s):s(t,r,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,r,i)=>{let s=async u=>u.kind===ht.DocumentDiagnosticReportKind.Full?{kind:Dn.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(u.uri),resultId:u.resultId,version:u.version,items:await this.client.protocol2CodeConverter.asDiagnostics(u.items,r)}:{kind:Dn.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(u.uri),resultId:u.resultId,version:u.version},o=u=>{let d=[];for(let v of u)d.push({uri:this.client.code2ProtocolConverter.asUri(v.uri),value:v.value});return d},a=(u,d)=>{let v=(0,W_.generateUuid)(),b=this.client.onProgress(ht.WorkspaceDiagnosticRequest.partialResult,v,async h=>{if(h==null){i(null);return}let w={items:[]};for(let _ of h.items)try{w.items.push(await s(_))}catch(D){this.client.error("Converting workspace diagnostics failed.",D)}i(w)}),g={identifier:this.options.identifier,previousResultIds:o(u),partialResultToken:v};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(ht.WorkspaceDiagnosticRequest.type,g,d).then(async h=>{if(d.isCancellationRequested)return{items:[]};let w={items:[]};for(let _ of h.items)w.items.push(await s(_));return b.dispose(),i(w),{items:[]}},h=>(b.dispose(),this.client.handleFailedRequest(ht.DocumentDiagnosticRequest.type,d,h,{items:[]})))},c=this.client.middleware;return c.provideWorkspaceDiagnostics?c.provideWorkspaceDiagnostics(t,r,i,a):a(t,r,i)}),e}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(let[e,t]of this.openRequests)t.state===Ut.active&&t.tokenSource.cancel(),this.openRequests.set(e,{state:Ut.outDated,document:t.document});this.diagnostics.dispose()}},Vl=class{constructor(e){this.diagnosticRequestor=e,this.documents=new ht.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;let t=gr.asKey(e);this.documents.has(t)||(this.documents.set(t,e,ht.Touch.Last),this.trigger())}remove(e){let t=gr.asKey(e);this.documents.delete(t),this.documents.size===0?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,ht.RAL)().timer.setInterval(()=>{let e=this.documents.first;if(e!==void 0){let t=gr.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,ht.Touch.Last),t===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?gr.asKey(this.endDocument):void 0}},Zl=class{constructor(e,t,r){let i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},s=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),o=[],a=h=>{let w=r.documentSelector;if(i.match!==void 0)return i.match(w,h);for(let _ of w)if(ht.TextDocumentFilter.is(_)){if(typeof _=="string"||_.language!==void 0&&_.language!=="*"||_.scheme!==void 0&&_.scheme!=="*"&&_.scheme!==h.scheme)return!1;if(_.pattern!==void 0){let D=new z_.Minimatch(_.pattern,{noext:!0});if(!D.makeRe()||!D.match(h.fsPath))return!1}}return!0},c=h=>h instanceof Te.Uri?a(h):Te.languages.match(s,h)>0&&t.isVisible(h),u=h=>h instanceof Te.Uri?this.activeTextDocument?.uri.toString()===h.toString():this.activeTextDocument===h;this.diagnosticRequestor=new Gl(e,t,r),this.backgroundScheduler=new Vl(this.diagnosticRequestor);let d=h=>{!c(h)||!r.interFileDependencies||u(h)||this.backgroundScheduler.add(h)};this.activeTextDocument=Te.window.activeTextEditor?.document,Te.window.onDidChangeActiveTextEditor(h=>{let w=this.activeTextDocument;this.activeTextDocument=h?.document,w!==void 0&&d(w),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let v=e.getFeature(ht.DidOpenTextDocumentNotification.method);o.push(v.onNotificationSent(h=>{let w=h.textDocument;this.diagnosticRequestor.knows(Tt.document,w)||c(w)&&this.diagnosticRequestor.pull(w,()=>{d(w)})})),o.push(t.onOpen(h=>{for(let w of h){if(this.diagnosticRequestor.knows(Tt.document,w))continue;let _=w.toString(),D;for(let k of Te.workspace.textDocuments)if(_===k.uri.toString()){D=k;break}D!==void 0&&c(D)&&this.diagnosticRequestor.pull(D,()=>{d(D)})}}));let b=new Set;for(let h of Te.workspace.textDocuments)c(h)&&(this.diagnosticRequestor.pull(h,()=>{d(h)}),b.add(h.uri.toString()));if(i.onTabs===!0)for(let h of t.getTabResources())!b.has(h.toString())&&c(h)&&this.diagnosticRequestor.pull(h,()=>{d(h)});if(i.onChange===!0){let h=e.getFeature(ht.DidChangeTextDocumentNotification.method);o.push(h.onNotificationSent(async w=>{let _=w.textDocument;(i.filter===void 0||!i.filter(_,ha.onType))&&this.diagnosticRequestor.knows(Tt.document,_)&&this.diagnosticRequestor.pull(_,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave===!0){let h=e.getFeature(ht.DidSaveTextDocumentNotification.method);o.push(h.onNotificationSent(w=>{let _=w.textDocument;(i.filter===void 0||!i.filter(_,ha.onSave))&&this.diagnosticRequestor.knows(Tt.document,_)&&this.diagnosticRequestor.pull(w.textDocument,()=>{this.backgroundScheduler.trigger()})}))}let g=e.getFeature(ht.DidCloseTextDocumentNotification.method);o.push(g.onNotificationSent(h=>{this.cleanUpDocument(h.textDocument)})),t.onClose(h=>{for(let w of h)this.cleanUpDocument(w)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let h of Te.workspace.textDocuments)c(h)&&this.diagnosticRequestor.pull(h)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=Te.Disposable.from(...o,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(Tt.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}},Xl=class extends Wl.TextDocumentLanguageFeature{constructor(e){super(e,ht.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=fa(fa(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,fa(fa(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(ht.DiagnosticRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeDiagnosticsEmitter.fire()});let[i,s]=this.getRegistration(t,e.diagnosticProvider);!i||!s||this.register({id:i,registerOptions:s})}clear(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new Bl);let t=new Zl(this._client,this.tabs,e);return[t.disposable,t]}};Hr.DiagnosticFeature=Xl});var Fy=N(ya=>{"use strict";Object.defineProperty(ya,"__esModule",{value:!0});ya.NotebookDocumentSyncFeature=void 0;var zt=require("vscode"),B_=da(),yr=de(),K_=tt(),Ny=_n();function Ly(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var ts;(function(n){let e;(function(t){function r(b,g){return{version:b.version,uri:g.asUri(b.uri)}}t.asVersionedNotebookDocumentIdentifier=r;function i(b,g,h){let w=yr.NotebookDocument.create(h.asUri(b.uri),b.notebookType,b.version,s(g,h));return Object.keys(b.metadata).length>0&&(w.metadata=o(b.metadata)),w}t.asNotebookDocument=i;function s(b,g){return b.map(h=>a(h,g))}t.asNotebookCells=s;function o(b){return u(new Set,b)}t.asMetadata=o;function a(b,g){let h=yr.NotebookCell.create(c(b.kind),g.asUri(b.document.uri));return Object.keys(b.metadata).length>0&&(h.metadata=o(b.metadata)),b.executionSummary!==void 0&&Ny.number(b.executionSummary.executionOrder)&&Ny.boolean(b.executionSummary.success)&&(h.executionSummary={executionOrder:b.executionSummary.executionOrder,success:b.executionSummary.success}),h}t.asNotebookCell=a;function c(b){switch(b){case zt.NotebookCellKind.Markup:return yr.NotebookCellKind.Markup;case zt.NotebookCellKind.Code:return yr.NotebookCellKind.Code}}function u(b,g){if(b.has(g))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(g)){let h=[];for(let w of g)if(w!==null&&typeof w=="object"||Array.isArray(w))h.push(u(b,w));else{if(w instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");h.push(w)}return h}else{let h=Object.keys(g),w=Object.create(null);for(let _ of h){let D=g[_];if(D!==null&&typeof D=="object"||Array.isArray(D))w[_]=u(b,D);else{if(D instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");w[_]=D}}return w}}function d(b,g){let h=g.asChangeTextDocumentParams(b,b.document.uri,b.document.version);return{document:h.textDocument,changes:h.contentChanges}}t.asTextContentChange=d;function v(b,g){let h=Object.create(null);if(b.metadata&&(h.metadata=n.c2p.asMetadata(b.metadata)),b.cells!==void 0){let w=Object.create(null),_=b.cells;_.structure&&(w.structure={array:{start:_.structure.array.start,deleteCount:_.structure.array.deleteCount,cells:_.structure.array.cells!==void 0?_.structure.array.cells.map(D=>n.c2p.asNotebookCell(D,g)):void 0},didOpen:_.structure.didOpen!==void 0?_.structure.didOpen.map(D=>g.asOpenTextDocumentParams(D.document).textDocument):void 0,didClose:_.structure.didClose!==void 0?_.structure.didClose.map(D=>g.asCloseTextDocumentParams(D.document).textDocument):void 0}),_.data!==void 0&&(w.data=_.data.map(D=>n.c2p.asNotebookCell(D,g))),_.textContent!==void 0&&(w.textContent=_.textContent.map(D=>n.c2p.asTextContentChange(D,g))),Object.keys(w).length>0&&(h.cells=w)}return h}t.asNotebookDocumentChangeEvent=v})(e=n.c2p||(n.c2p={}))})(ts||(ts={}));var Yl;(function(n){function e(a,c,u){let d=a.length,v=c.length,b=0;for(;b<v&&b<d&&t(a[b],c[b],u);)b++;if(b<v&&b<d){let g=d-1,h=v-1;for(;g>=0&&h>=0&&t(a[g],c[h],u);)g--,h--;let w=g+1-b,_=b===h+1?void 0:c.slice(b,h+1);return _!==void 0?{start:b,deleteCount:w,cells:_}:{start:b,deleteCount:w}}else return b<v?{start:b,deleteCount:0,cells:c.slice(b)}:b<d?{start:b,deleteCount:d-b}:void 0}n.computeDiff=e;function t(a,c,u=!0){return a.kind!==c.kind||a.document.uri.toString()!==c.document.uri.toString()||a.document.languageId!==c.document.languageId||!r(a.executionSummary,c.executionSummary)?!1:!u||u&&s(a.metadata,c.metadata)}function r(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.executionOrder===c.executionOrder&&a.success===c.success&&i(a.timing,c.timing)}function i(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.startTime===c.startTime&&a.endTime===c.endTime}function s(a,c){if(a===c)return!0;if(a==null||c===null||c===void 0||typeof a!=typeof c||typeof a!="object")return!1;let u=Array.isArray(a),d=Array.isArray(c);if(u!==d)return!1;if(u&&d){if(a.length!==c.length)return!1;for(let v=0;v<a.length;v++)if(!s(a[v],c[v]))return!1}if(o(a)&&o(c)){let v=Object.keys(a),b=Object.keys(c);if(v.length!==b.length||(v.sort(),b.sort(),!s(v,b)))return!1;for(let g=0;g<v.length;g++){let h=v[g];if(!s(a[h],c[h]))return!1}return!0}return!1}function o(a){return a!==null&&typeof a=="object"}n.isObjectLiteral=o})(Yl||(Yl={}));var Ql;(function(n){function e(t,r){if(typeof t=="string")return t==="*"||r.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&r.notebookType!==t.notebookType)return!1;let i=r.uri;if(t.scheme!==void 0&&t.scheme!=="*"&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){let s=new B_.Minimatch(t.pattern,{noext:!0});if(!s.makeRe()||!s.match(i.fsPath))return!1}return!0}n.matchNotebook=e})(Ql||(Ql={}));var pa;(function(n){function e(r){let i=r.notebookSelector,s=[];for(let o of i){let a=(typeof o.notebook=="string"?o.notebook:o.notebook?.notebookType)??"*",c=typeof o.notebook=="string"?void 0:o.notebook?.scheme,u=typeof o.notebook=="string"?void 0:o.notebook?.pattern;if(o.cells!==void 0)for(let d of o.cells)s.push(t(a,c,u,d.language));else s.push(t(a,c,u,void 0))}return s}n.asDocumentSelector=e;function t(r,i,s,o){return i===void 0&&s===void 0?{notebook:r,language:o}:{notebook:{notebookType:r,scheme:i,pattern:s},language:o}}})(pa||(pa={}));var ma;(function(n){function e(t){return{cells:t,uris:new Set(t.map(r=>r.document.uri.toString()))}}n.create=e})(ma||(ma={}));var ns=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(pa.asDocumentSelector(t)),zt.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(let r of zt.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);zt.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&zt.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),zt.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}getState(){for(let e of zt.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return zt.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(zt.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){let s=r.uris.has(t.document.uri.toString());if(i&&s||!i&&!s)return;if(i){let o=this.getMatchingCells(e);if(o!==void 0){let a=this.asNotebookDocumentChangeEvent(e,void 0,r,o);a!==void 0&&this.doSendChange(a,o).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){zt.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;let i=t.document.uri,s=r.cells.findIndex(o=>o.document.uri.toString()===i.toString());if(s!==-1)if(s===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{let o=r.cells.slice(),a=o.splice(s,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:s,deleteCount:1},didClose:a}}},o).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(t!==void 0){let i=this.asNotebookDocumentChangeEvent(e,void 0,r,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,r=this.notebookSyncInfo.get(t.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;let i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,r)}else{let i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,r);return}let s=this.asNotebookDocumentChangeEvent(e.notebook,e,r,i);s!==void 0&&this.doSendChange(s,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let r=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){let r=async(s,o)=>{let a=ts.c2p.asNotebookDocument(s,o,this.client.code2ProtocolConverter),c=o.map(u=>this.client.code2ProtocolConverter.asTextDocumentItem(u.document));try{await this.client.sendNotification(yr.DidOpenNotebookDocumentNotification.type,{notebookDocument:a,cellTextDocuments:c})}catch(u){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",u),u}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),ma.create(t)),i?.didOpen!==void 0?i.didOpen(e,t,r):r(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){let r=async s=>{try{await this.client.sendNotification(yr.DidChangeNotebookDocumentNotification.type,{notebookDocument:ts.c2p.asVersionedNotebookDocumentIdentifier(s.notebook,this.client.code2ProtocolConverter),change:ts.c2p.asNotebookDocumentChangeEvent(s,this.client.code2ProtocolConverter)})}catch(o){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",o),o}},i=this.client.middleware?.notebooks;return e.cells?.structure!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),ma.create(t??[])),i?.didChange!==void 0?i?.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){let t=async i=>{try{await this.client.sendNotification(yr.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(i.uri)}})}catch(s){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",s),s}},r=this.client.middleware?.notebooks;return r?.didSave!==void 0?r.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){let r=async(s,o)=>{try{await this.client.sendNotification(yr.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(s.uri)},cellTextDocuments:o.map(a=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(a.document))})}catch(a){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",a),a}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),i?.didClose!==void 0?i.didClose(e,t,r):r(e,t)}asNotebookDocumentChangeEvent(e,t,r,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");let s={notebook:e};t?.metadata!==void 0&&(s.metadata=ts.c2p.asMetadata(t.metadata));let o;if(t?.cellChanges!==void 0&&t.cellChanges.length>0){let a=[];o=new Set(i.map(c=>c.document.uri.toString()));for(let c of t.cellChanges)o.has(c.cell.document.uri.toString())&&(c.executionSummary!==void 0||c.metadata!==void 0)&&a.push(c.cell);a.length>0&&(s.cells=s.cells??{},s.cells.data=a)}if((t?.contentChanges!==void 0&&t.contentChanges.length>0||t===void 0)&&r!==void 0&&i!==void 0){let a=r.cells,c=i,u=Yl.computeDiff(a,c,!1),d,v;if(u!==void 0){d=u.cells===void 0?new Map:new Map(u.cells.map(h=>[h.document.uri.toString(),h])),v=u.deleteCount===0?new Map:new Map(a.slice(u.start,u.start+u.deleteCount).map(h=>[h.document.uri.toString(),h]));for(let h of Array.from(v.keys()))d.has(h)&&(v.delete(h),d.delete(h));s.cells=s.cells??{};let b=[],g=[];if(d.size>0||v.size>0){for(let h of d.values())b.push(h);for(let h of v.values())g.push(h)}s.cells.structure={array:u,didOpen:b,didClose:g}}}return Object.keys(s).length>1?s:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let r of this.options.notebookSelector)if(r.notebook===void 0||Ql.matchNotebook(r.notebook,e)){let i=this.filterCells(e,t,r.cells);return i.length===0?void 0:i}}}cellMatches(e,t){let r=this.getMatchingCells(e,[t]);return r!==void 0&&r[0]===t}filterCells(e,t,r){let i=r!==void 0?t.filter(s=>{let o=s.document.languageId;return r.some((a=>a.language==="*"||o===a.language))}):t;return typeof this.client.clientOptions.notebookDocumentOptions?.filterCells=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,i):i}},ga=class n{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=yr.NotebookDocumentSyncRegistrationType.type,zt.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==n.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let s of this.registrations.values())s instanceof ns&&s.didOpenNotebookCellTextDocument(r,i)}),zt.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let r=t.document;if(r.uri.scheme!==n.CellScheme)return;let[i]=this.findNotebookDocumentAndCell(r);if(i!==void 0)for(let s of this.registrations.values())s instanceof ns&&s.didChangeNotebookCellTextDocument(i,t)}),zt.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==n.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let s of this.registrations.values())s instanceof ns&&s.didCloseNotebookCellTextDocument(r,i)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(let e of this.registrations.values()){let t=e.getState();if(t.kind==="document"&&t.registrations===!0&&t.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){let t=Ly(Ly(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){let t=e.notebookDocumentSync;t!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(pa.asDocumentSelector(t)))}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let r=t.id??K_.generateUuid();this.register({id:r,registerOptions:t})}register(e){let t=new ns(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}clear(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==n.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&zt.languages.match(this.dedicatedChannel,e)>0)return!0;for(let t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(let t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let r of zt.workspace.notebookDocuments)for(let i of r.getCells())if(i.document.uri.toString()===t)return[r,i];return[void 0,void 0]}};ya.NotebookDocumentSyncFeature=ga;ga.CellScheme="vscode-notebook-cell"});var Ay=N($r=>{"use strict";Object.defineProperty($r,"__esModule",{value:!0});$r.SyncConfigurationFeature=$r.toJSONObject=$r.ConfigurationFeature=void 0;var rs=require("vscode"),$s=de(),G_=_n(),V_=tt(),qy=Pe(),ed=class{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest($s.ConfigurationRequest.type,(t,r)=>{let i=o=>{let a=[];for(let c of o.items){let u=c.scopeUri!==void 0&&c.scopeUri!==null?this._client.protocol2CodeConverter.asUri(c.scopeUri):void 0;a.push(this.getConfiguration(u,c.section!==null?c.section:void 0))}return a},s=e.middleware.workspace;return s&&s.configuration?s.configuration(t,r,i):i(t,r)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(".");if(i===-1)r=oi(rs.workspace.getConfiguration(void 0,e).get(t));else{let s=rs.workspace.getConfiguration(t.substr(0,i),e);s&&(r=oi(s.get(t.substr(i+1))))}}else{let i=rs.workspace.getConfiguration(void 0,e);r={};for(let s of Object.keys(i))i.has(s)&&(r[s]=oi(i.get(s)))}return r===void 0&&(r=null),r}clear(){}};$r.ConfigurationFeature=ed;function oi(n){if(n){if(Array.isArray(n))return n.map(oi);if(typeof n=="object"){let e=Object.create(null);for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=oi(n[t]));return e}}return n}$r.toJSONObject=oi;var td=class{constructor(e){this._client=e,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return $s.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,qy.ensure)((0,qy.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){this.isCleared=!1;let e=this._client.clientOptions.synchronize?.configurationSection;e!==void 0&&this.register({id:V_.generateUuid(),registerOptions:{section:e}})}register(e){let t=rs.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(e,t){if(this.isCleared)return;let r;if(G_.string(e)?r=[e]:r=e,r!==void 0&&t!==void 0&&!r.some(a=>t.affectsConfiguration(a)))return;let i=async o=>o===void 0?this._client.sendNotification($s.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification($s.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(o)}),s=this._client.middleware.workspace?.didChangeConfiguration;(s?s(r,i):i(r)).catch(o=>{this._client.error(`Sending notification ${$s.DidChangeConfigurationNotification.type.method} failed`,o)})}extractSettingsInformation(e){function t(s,o){let a=s;for(let c=0;c<o.length-1;c++){let u=a[o[c]];u||(u=Object.create(null),a[o[c]]=u),a=u}return a}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let s=0;s<e.length;s++){let o=e[s],a=o.indexOf("."),c=null;if(a>=0?c=rs.workspace.getConfiguration(o.substr(0,a),r).get(o.substr(a+1)):c=rs.workspace.getConfiguration(void 0,r).get(o),c){let u=e[s].split(".");t(i,u)[u[u.length-1]]=oi(c)}}return i}};$r.SyncConfigurationFeature=td});var jy=N(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});on.DidSaveTextDocumentFeature=on.WillSaveWaitUntilFeature=on.WillSaveFeature=on.DidChangeTextDocumentFeature=on.DidCloseTextDocumentFeature=on.DidOpenTextDocumentFeature=void 0;var gn=require("vscode"),Ke=de(),it=Pe(),is=tt(),nd=class extends it.TextDocumentEventFeature{constructor(e,t){super(e,gn.workspace.onDidOpenTextDocument,Ke.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),r=>r,it.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,it.ensure)((0,it.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:is.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return Ke.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);gn.workspace.textDocuments.forEach(r=>{let i=r.uri.toString();if(!this._syncedDocuments.has(i)&&gn.languages.match(t,r)>0&&!this._client.hasDedicatedTextSynchronizationFeature(r)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));(s.didOpen?s.didOpen(r,o):o(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,r)}})}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,r)}};on.DidOpenTextDocumentFeature=nd;var rd=class extends it.TextDocumentEventFeature{constructor(e,t,r){super(e,gn.workspace.onDidCloseTextDocument,Ke.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,i=>e.code2ProtocolConverter.asCloseTextDocumentParams(i),i=>i,it.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t,this._pendingTextDocumentChanges=r}get registrationType(){return Ke.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,it.ensure)((0,it.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:is.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,r)}unregister(e){let t=this._selectors.get(e);super.unregister(e);let r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(gn.languages.match(t,i)>0&&!this._selectorFilter(r,i)&&!this._client.hasDedicatedTextSynchronizationFeature(i)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(s.didClose?s.didClose(i,o):o(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}};on.DidCloseTextDocumentFeature=rd;var id=class extends it.DynamicDocumentFeature{constructor(e,t){super(e),this._changeData=new Map,this._onNotificationSent=new gn.EventEmitter,this._onPendingChangeAdded=new gn.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=Ke.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return Ke.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,it.ensure)((0,it.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.change!==void 0&&r.change!==Ke.TextDocumentSyncKind.None&&this.register({id:is.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:r.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=gn.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(let e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;let t=e.document.uri,r=e.document.version,i=[];for(let s of this._changeData.values())if(gn.languages.match(s.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let o=this._client.middleware;if(s.syncKind===Ke.TextDocumentSyncKind.Incremental){let a=async c=>{let u=this._client.code2ProtocolConverter.asChangeTextDocumentParams(c,t,r);await this._client.sendNotification(Ke.DidChangeTextDocumentNotification.type,u),this.notificationSent(c.document,Ke.DidChangeTextDocumentNotification.type,u)};i.push(o.didChange?o.didChange(e,c=>a(c)):a(e))}else if(s.syncKind===Ke.TextDocumentSyncKind.Full){let a=async c=>{let u=c.document.uri.toString();this._pendingTextDocumentChanges.set(u,c.document),this._onPendingChangeAdded.fire()};i.push(o.didChange?o.didChange(e,c=>a(c)):a(e))}}return Promise.all(i).then(void 0,s=>{throw this._client.error(`Sending document notification ${Ke.DidChangeTextDocumentNotification.type.method} failed`,s),s})}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=Ke.TextDocumentSyncKind.None;else{this._syncKind=Ke.TextDocumentSyncKind.None;for(let t of this._changeData.values())if(this.updateSyncKind(t.syncKind),this._syncKind===Ke.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=Ke.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let t;if(e.size===0)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(let r of this._pendingTextDocumentChanges)e.has(r[0])||(t.push(r[1]),this._pendingTextDocumentChanges.delete(r[0]))}return t}getProvider(e){for(let t of this._changeData.values())if(gn.languages.match(t.documentSelector,e)>0)return{send:r=>this.callback(r)}}updateSyncKind(e){if(this._syncKind!==Ke.TextDocumentSyncKind.Full)switch(e){case Ke.TextDocumentSyncKind.Full:this._syncKind=e;break;case Ke.TextDocumentSyncKind.Incremental:this._syncKind===Ke.TextDocumentSyncKind.None&&(this._syncKind=Ke.TextDocumentSyncKind.Incremental);break}}};on.DidChangeTextDocumentFeature=id;var sd=class extends it.TextDocumentEventFeature{constructor(e){super(e,gn.workspace.onWillSaveTextDocument,Ke.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),t=>t.document,(t,r)=>it.TextDocumentEventFeature.textDocumentFilter(t,r.document))}get registrationType(){return Ke.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=(0,it.ensure)((0,it.ensure)(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSave&&this.register({id:is.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}};on.WillSaveFeature=sd;var od=class extends it.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return Ke.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=(0,it.ensure)((0,it.ensure)(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSaveWaitUntil&&this.register({id:is.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=gn.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(it.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,r=i=>this._client.sendRequest(Ke.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async s=>{let o=await this._client.protocol2CodeConverter.asTextEdits(s);return o===void 0?[]:o});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}};on.WillSaveWaitUntilFeature=od;var ad=class extends it.TextDocumentEventFeature{constructor(e){super(e,gn.workspace.onDidSaveTextDocument,Ke.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),t=>t,it.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return Ke.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,it.ensure)((0,it.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;if(t&&r&&r.save){let i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:is.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}};on.DidSaveTextDocumentFeature=ad});var Hy=N(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.CompletionItemFeature=void 0;var Z_=require("vscode"),Ee=de(),cd=Pe(),X_=tt(),J_=[Ee.CompletionItemKind.Text,Ee.CompletionItemKind.Method,Ee.CompletionItemKind.Function,Ee.CompletionItemKind.Constructor,Ee.CompletionItemKind.Field,Ee.CompletionItemKind.Variable,Ee.CompletionItemKind.Class,Ee.CompletionItemKind.Interface,Ee.CompletionItemKind.Module,Ee.CompletionItemKind.Property,Ee.CompletionItemKind.Unit,Ee.CompletionItemKind.Value,Ee.CompletionItemKind.Enum,Ee.CompletionItemKind.Keyword,Ee.CompletionItemKind.Snippet,Ee.CompletionItemKind.Color,Ee.CompletionItemKind.File,Ee.CompletionItemKind.Reference,Ee.CompletionItemKind.Folder,Ee.CompletionItemKind.EnumMember,Ee.CompletionItemKind.Constant,Ee.CompletionItemKind.Struct,Ee.CompletionItemKind.Event,Ee.CompletionItemKind.Operator,Ee.CompletionItemKind.TypeParameter],ud=class extends cd.TextDocumentLanguageFeature{constructor(e){super(e,Ee.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,cd.ensure)((0,cd.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[Ee.MarkupKind.Markdown,Ee.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[Ee.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[Ee.InsertTextMode.asIs,Ee.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=Ee.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:J_},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}}initialize(e,t){let r=this.getRegistrationOptions(t,e.completionProvider);r&&this.register({id:X_.generateUuid(),registerOptions:r})}registerLanguageProvider(e,t){this.labelDetailsSupport.set(t,!!e.completionItem?.labelDetailsSupport);let r=e.triggerCharacters??[],i=e.allCommitCharacters,s=e.documentSelector,o={provideCompletionItems:(a,c,u,d)=>{let v=this._client,b=this._client.middleware,g=(h,w,_,D)=>v.sendRequest(Ee.CompletionRequest.type,v.code2ProtocolConverter.asCompletionParams(h,w,_),D).then(k=>D.isCancellationRequested?null:v.protocol2CodeConverter.asCompletionResult(k,i,D),k=>v.handleFailedRequest(Ee.CompletionRequest.type,D,k,null));return b.provideCompletionItem?b.provideCompletionItem(a,c,d,u,g):g(a,c,d,u)},resolveCompletionItem:e.resolveProvider?(a,c)=>{let u=this._client,d=this._client.middleware,v=(b,g)=>u.sendRequest(Ee.CompletionResolveRequest.type,u.code2ProtocolConverter.asCompletionItem(b,!!this.labelDetailsSupport.get(t)),g).then(h=>g.isCancellationRequested?null:u.protocol2CodeConverter.asCompletionItem(h),h=>u.handleFailedRequest(Ee.CompletionResolveRequest.type,g,h,b));return d.resolveCompletionItem?d.resolveCompletionItem(a,c,v):v(a,c)}:void 0};return[Z_.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),o,...r),o]}};va.CompletionItemFeature=ud});var $y=N(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});ba.HoverFeature=void 0;var Y_=require("vscode"),Us=de(),ld=Pe(),Q_=tt(),dd=class extends ld.TextDocumentLanguageFeature{constructor(e){super(e,Us.HoverRequest.type)}fillClientCapabilities(e){let t=(0,ld.ensure)((0,ld.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[Us.MarkupKind.Markdown,Us.MarkupKind.PlainText]}initialize(e,t){let r=this.getRegistrationOptions(t,e.hoverProvider);r&&this.register({id:Q_.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideHover:(i,s,o)=>{let a=this._client,c=(d,v,b)=>a.sendRequest(Us.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(d,v),b).then(g=>b.isCancellationRequested?null:a.protocol2CodeConverter.asHover(g),g=>a.handleFailedRequest(Us.HoverRequest.type,b,g,null)),u=a.middleware;return u.provideHover?u.provideHover(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Y_.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};ba.HoverFeature=dd});var Uy=N(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.DefinitionFeature=void 0;var e0=require("vscode"),fd=de(),hd=Pe(),t0=tt(),pd=class extends hd.TextDocumentLanguageFeature{constructor(e){super(e,fd.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,hd.ensure)((0,hd.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.definitionProvider);r&&this.register({id:t0.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDefinition:(i,s,o)=>{let a=this._client,c=(d,v,b)=>a.sendRequest(fd.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(d,v),b).then(g=>b.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(g,b),g=>a.handleFailedRequest(fd.DefinitionRequest.type,b,g,null)),u=a.middleware;return u.provideDefinition?u.provideDefinition(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return e0.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Ca.DefinitionFeature=pd});var Wy=N(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});wa.SignatureHelpFeature=void 0;var zy=require("vscode"),zs=de(),md=Pe(),n0=tt(),gd=class extends md.TextDocumentLanguageFeature{constructor(e){super(e,zs.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,md.ensure)((0,md.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[zs.MarkupKind.Markdown,zs.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.signatureHelpProvider);r&&this.register({id:n0.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t={provideSignatureHelp:(r,i,s,o)=>{let a=this._client,c=(d,v,b,g)=>a.sendRequest(zs.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(d,v,b),g).then(h=>g.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(h,g),h=>a.handleFailedRequest(zs.SignatureHelpRequest.type,g,h,null)),u=a.middleware;return u.provideSignatureHelp?u.provideSignatureHelp(r,i,o,s,c):c(r,i,o,s)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){let r=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){let i=e.triggerCharacters||[];return zy.languages.registerSignatureHelpProvider(r,t,...i)}else{let i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return zy.languages.registerSignatureHelpProvider(r,t,i)}}};wa.SignatureHelpFeature=gd});var By=N(_a=>{"use strict";Object.defineProperty(_a,"__esModule",{value:!0});_a.DocumentHighlightFeature=void 0;var r0=require("vscode"),yd=de(),vd=Pe(),i0=tt(),bd=class extends vd.TextDocumentLanguageFeature{constructor(e){super(e,yd.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,vd.ensure)((0,vd.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentHighlightProvider);r&&this.register({id:i0.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentHighlights:(i,s,o)=>{let a=this._client,c=(d,v,b)=>a.sendRequest(yd.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(d,v),b).then(g=>b.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(g,b),g=>a.handleFailedRequest(yd.DocumentHighlightRequest.type,b,g,null)),u=a.middleware;return u.provideDocumentHighlights?u.provideDocumentHighlights(i,s,o,c):c(i,s,o)}};return[r0.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};_a.DocumentHighlightFeature=bd});var _d=N(ir=>{"use strict";Object.defineProperty(ir,"__esModule",{value:!0});ir.DocumentSymbolFeature=ir.SupportedSymbolTags=ir.SupportedSymbolKinds=void 0;var s0=require("vscode"),Le=de(),Cd=Pe(),o0=tt();ir.SupportedSymbolKinds=[Le.SymbolKind.File,Le.SymbolKind.Module,Le.SymbolKind.Namespace,Le.SymbolKind.Package,Le.SymbolKind.Class,Le.SymbolKind.Method,Le.SymbolKind.Property,Le.SymbolKind.Field,Le.SymbolKind.Constructor,Le.SymbolKind.Enum,Le.SymbolKind.Interface,Le.SymbolKind.Function,Le.SymbolKind.Variable,Le.SymbolKind.Constant,Le.SymbolKind.String,Le.SymbolKind.Number,Le.SymbolKind.Boolean,Le.SymbolKind.Array,Le.SymbolKind.Object,Le.SymbolKind.Key,Le.SymbolKind.Null,Le.SymbolKind.EnumMember,Le.SymbolKind.Struct,Le.SymbolKind.Event,Le.SymbolKind.Operator,Le.SymbolKind.TypeParameter];ir.SupportedSymbolTags=[Le.SymbolTag.Deprecated];var wd=class extends Cd.TextDocumentLanguageFeature{constructor(e){super(e,Le.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Cd.ensure)((0,Cd.ensure)(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:ir.SupportedSymbolKinds},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:ir.SupportedSymbolTags},t.labelSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentSymbolProvider);r&&this.register({id:o0.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentSymbols:(s,o)=>{let a=this._client,c=async(d,v)=>{try{let b=await a.sendRequest(Le.DocumentSymbolRequest.type,a.code2ProtocolConverter.asDocumentSymbolParams(d),v);if(v.isCancellationRequested||b===void 0||b===null)return null;if(b.length===0)return[];{let g=b[0];return Le.DocumentSymbol.is(g)?await a.protocol2CodeConverter.asDocumentSymbols(b,v):await a.protocol2CodeConverter.asSymbolInformations(b,v)}}catch(b){return a.handleFailedRequest(Le.DocumentSymbolRequest.type,v,b,null)}},u=a.middleware;return u.provideDocumentSymbols?u.provideDocumentSymbols(s,o,c):c(s,o)}},i=e.label!==void 0?{label:e.label}:void 0;return[s0.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,i),r]}};ir.DocumentSymbolFeature=wd});var Gy=N(Sa=>{"use strict";Object.defineProperty(Sa,"__esModule",{value:!0});Sa.WorkspaceSymbolFeature=void 0;var a0=require("vscode"),Ws=de(),Sd=Pe(),Ky=_d(),c0=tt(),Td=class extends Sd.WorkspaceFeature{constructor(e){super(e,Ws.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Sd.ensure)((0,Sd.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:Ky.SupportedSymbolKinds},t.tagSupport={valueSet:Ky.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:c0.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(r,i)=>{let s=this._client,o=(c,u)=>s.sendRequest(Ws.WorkspaceSymbolRequest.type,{query:c},u).then(d=>u.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformations(d,u),d=>s.handleFailedRequest(Ws.WorkspaceSymbolRequest.type,u,d,null)),a=s.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(r,i,o):o(r,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,i)=>{let s=this._client,o=(c,u)=>s.sendRequest(Ws.WorkspaceSymbolResolveRequest.type,s.code2ProtocolConverter.asWorkspaceSymbol(c),u).then(d=>u.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformation(d),d=>s.handleFailedRequest(Ws.WorkspaceSymbolResolveRequest.type,u,d,null)),a=s.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(r,i,o):o(r,i)}:void 0};return[a0.languages.registerWorkspaceSymbolProvider(t),t]}};Sa.WorkspaceSymbolFeature=Td});var Vy=N(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.ReferencesFeature=void 0;var u0=require("vscode"),Ed=de(),Rd=Pe(),l0=tt(),Dd=class extends Rd.TextDocumentLanguageFeature{constructor(e){super(e,Ed.ReferencesRequest.type)}fillClientCapabilities(e){(0,Rd.ensure)((0,Rd.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.referencesProvider);r&&this.register({id:l0.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideReferences:(i,s,o,a)=>{let c=this._client,u=(v,b,g,h)=>c.sendRequest(Ed.ReferencesRequest.type,c.code2ProtocolConverter.asReferenceParams(v,b,g),h).then(w=>h.isCancellationRequested?null:c.protocol2CodeConverter.asReferences(w,h),w=>c.handleFailedRequest(Ed.ReferencesRequest.type,h,w,null)),d=c.middleware;return d.provideReferences?d.provideReferences(i,s,o,a,u):u(i,s,o,a)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return u0.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Ta.ReferencesFeature=Dd});var Zy=N(Ea=>{"use strict";Object.defineProperty(Ea,"__esModule",{value:!0});Ea.CodeActionFeature=void 0;var d0=require("vscode"),yn=de(),f0=tt(),xd=Pe(),Pd=class extends xd.TextDocumentLanguageFeature{constructor(e){super(e,yn.CodeActionRequest.type)}fillClientCapabilities(e){let t=(0,xd.ensure)((0,xd.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[yn.CodeActionKind.Empty,yn.CodeActionKind.QuickFix,yn.CodeActionKind.Refactor,yn.CodeActionKind.RefactorExtract,yn.CodeActionKind.RefactorInline,yn.CodeActionKind.RefactorRewrite,yn.CodeActionKind.Source,yn.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.codeActionProvider);r&&this.register({id:f0.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideCodeActions:(i,s,o,a)=>{let c=this._client,u=async(v,b,g,h)=>{let w={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v),range:c.code2ProtocolConverter.asRange(b),context:c.code2ProtocolConverter.asCodeActionContextSync(g)};return c.sendRequest(yn.CodeActionRequest.type,w,h).then(_=>h.isCancellationRequested||_===null||_===void 0?null:c.protocol2CodeConverter.asCodeActionResult(_,h),_=>c.handleFailedRequest(yn.CodeActionRequest.type,h,_,null))},d=c.middleware;return d.provideCodeActions?d.provideCodeActions(i,s,o,a,u):u(i,s,o,a)},resolveCodeAction:e.resolveProvider?(i,s)=>{let o=this._client,a=this._client.middleware,c=async(u,d)=>o.sendRequest(yn.CodeActionResolveRequest.type,o.code2ProtocolConverter.asCodeActionSync(u),d).then(v=>d.isCancellationRequested?u:o.protocol2CodeConverter.asCodeAction(v,d),v=>o.handleFailedRequest(yn.CodeActionResolveRequest.type,d,v,u));return a.resolveCodeAction?a.resolveCodeAction(i,s,c):c(i,s)}:void 0};return[d0.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}};Ea.CodeActionFeature=Pd});var Jy=N(Ra=>{"use strict";Object.defineProperty(Ra,"__esModule",{value:!0});Ra.CodeLensFeature=void 0;var Xy=require("vscode"),ss=de(),h0=tt(),Bs=Pe(),kd=class extends Bs.TextDocumentLanguageFeature{constructor(e){super(e,ss.CodeLensRequest.type)}fillClientCapabilities(e){(0,Bs.ensure)((0,Bs.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,Bs.ensure)((0,Bs.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(ss.CodeLensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);i&&this.register({id:h0.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new Xy.EventEmitter,i={onDidChangeCodeLenses:r.event,provideCodeLenses:(s,o)=>{let a=this._client,c=(d,v)=>a.sendRequest(ss.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(d),v).then(b=>v.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(b,v),b=>a.handleFailedRequest(ss.CodeLensRequest.type,v,b,null)),u=a.middleware;return u.provideCodeLenses?u.provideCodeLenses(s,o,c):c(s,o)},resolveCodeLens:e.resolveProvider?(s,o)=>{let a=this._client,c=(d,v)=>a.sendRequest(ss.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(d),v).then(b=>v.isCancellationRequested?d:a.protocol2CodeConverter.asCodeLens(b),b=>a.handleFailedRequest(ss.CodeLensResolveRequest.type,v,b,d)),u=a.middleware;return u.resolveCodeLens?u.resolveCodeLens(s,o,c):c(s,o)}:void 0};return[Xy.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:r}]}};Ra.CodeLensFeature=kd});var Yy=N(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});Ur.DocumentOnTypeFormattingFeature=Ur.DocumentRangeFormattingFeature=Ur.DocumentFormattingFeature=void 0;var Da=require("vscode"),Un=de(),Nd=tt(),vr=Pe(),os;(function(n){function e(t){let r=Da.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}n.fromConfiguration=e})(os||(os={}));var Id=class extends vr.TextDocumentLanguageFeature{constructor(e){super(e,Un.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,vr.ensure)((0,vr.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentFormattingProvider);r&&this.register({id:Nd.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentFormattingEdits:(i,s,o)=>{let a=this._client,c=(d,v,b)=>{let g={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(d),options:a.code2ProtocolConverter.asFormattingOptions(v,os.fromConfiguration(d))};return a.sendRequest(Un.DocumentFormattingRequest.type,g,b).then(h=>b.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(h,b),h=>a.handleFailedRequest(Un.DocumentFormattingRequest.type,b,h,null))},u=a.middleware;return u.provideDocumentFormattingEdits?u.provideDocumentFormattingEdits(i,s,o,c):c(i,s,o)}};return[Da.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Ur.DocumentFormattingFeature=Id;var Od=class extends vr.TextDocumentLanguageFeature{constructor(e){super(e,Un.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){let t=(0,vr.ensure)((0,vr.ensure)(e,"textDocument"),"rangeFormatting");t.dynamicRegistration=!0,t.rangesSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);r&&this.register({id:Nd.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentRangeFormattingEdits:(i,s,o,a)=>{let c=this._client,u=(v,b,g,h)=>{let w={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v),range:c.code2ProtocolConverter.asRange(b),options:c.code2ProtocolConverter.asFormattingOptions(g,os.fromConfiguration(v))};return c.sendRequest(Un.DocumentRangeFormattingRequest.type,w,h).then(_=>h.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(_,h),_=>c.handleFailedRequest(Un.DocumentRangeFormattingRequest.type,h,_,null))},d=c.middleware;return d.provideDocumentRangeFormattingEdits?d.provideDocumentRangeFormattingEdits(i,s,o,a,u):u(i,s,o,a)}};return e.rangesSupport&&(r.provideDocumentRangesFormattingEdits=(i,s,o,a)=>{let c=this._client,u=(v,b,g,h)=>{let w={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v),ranges:c.code2ProtocolConverter.asRanges(b),options:c.code2ProtocolConverter.asFormattingOptions(g,os.fromConfiguration(v))};return c.sendRequest(Un.DocumentRangesFormattingRequest.type,w,h).then(_=>h.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(_,h),_=>c.handleFailedRequest(Un.DocumentRangesFormattingRequest.type,h,_,null))},d=c.middleware;return d.provideDocumentRangesFormattingEdits?d.provideDocumentRangesFormattingEdits(i,s,o,a,u):u(i,s,o,a)}),[Da.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Ur.DocumentRangeFormattingFeature=Od;var Md=class extends vr.TextDocumentLanguageFeature{constructor(e){super(e,Un.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,vr.ensure)((0,vr.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);r&&this.register({id:Nd.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideOnTypeFormattingEdits:(s,o,a,c,u)=>{let d=this._client,v=(g,h,w,_,D)=>{let k={textDocument:d.code2ProtocolConverter.asTextDocumentIdentifier(g),position:d.code2ProtocolConverter.asPosition(h),ch:w,options:d.code2ProtocolConverter.asFormattingOptions(_,os.fromConfiguration(g))};return d.sendRequest(Un.DocumentOnTypeFormattingRequest.type,k,D).then(y=>D.isCancellationRequested?null:d.protocol2CodeConverter.asTextEdits(y,D),y=>d.handleFailedRequest(Un.DocumentOnTypeFormattingRequest.type,D,y,null))},b=d.middleware;return b.provideOnTypeFormattingEdits?b.provideOnTypeFormattingEdits(s,o,a,c,u,v):v(s,o,a,c,u)}},i=e.moreTriggerCharacter||[];return[Da.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.firstTriggerCharacter,...i),r]}};Ur.DocumentOnTypeFormattingFeature=Md});var ev=N(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});xa.RenameFeature=void 0;var p0=require("vscode"),ai=de(),m0=tt(),Qy=_n(),Ld=Pe(),Fd=class extends Ld.TextDocumentLanguageFeature{constructor(e){super(e,ai.RenameRequest.type)}fillClientCapabilities(e){let t=(0,Ld.ensure)((0,Ld.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=ai.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.renameProvider);r&&(Qy.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:m0.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){let t=e.documentSelector,r={provideRenameEdits:(i,s,o,a)=>{let c=this._client,u=(v,b,g,h)=>{let w={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v),position:c.code2ProtocolConverter.asPosition(b),newName:g};return c.sendRequest(ai.RenameRequest.type,w,h).then(_=>h.isCancellationRequested?null:c.protocol2CodeConverter.asWorkspaceEdit(_,h),_=>c.handleFailedRequest(ai.RenameRequest.type,h,_,null,!1))},d=c.middleware;return d.provideRenameEdits?d.provideRenameEdits(i,s,o,a,u):u(i,s,o,a)},prepareRename:e.prepareProvider?(i,s,o)=>{let a=this._client,c=(d,v,b)=>{let g={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(d),position:a.code2ProtocolConverter.asPosition(v)};return a.sendRequest(ai.PrepareRenameRequest.type,g,b).then(h=>b.isCancellationRequested?null:ai.Range.is(h)?a.protocol2CodeConverter.asRange(h):this.isDefaultBehavior(h)?h.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):h&&ai.Range.is(h.range)?{range:a.protocol2CodeConverter.asRange(h.range),placeholder:h.placeholder}:Promise.reject(new Error("The element can't be renamed.")),h=>{throw typeof h.message=="string"?new Error(h.message):new Error("The element can't be renamed.")})},u=a.middleware;return u.prepareRename?u.prepareRename(i,s,o,c):c(i,s,o)}:void 0};return[this.registerProvider(t,r),r]}registerProvider(e,t){return p0.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){let t=e;return t&&Qy.boolean(t.defaultBehavior)}};xa.RenameFeature=Fd});var tv=N(Pa=>{"use strict";Object.defineProperty(Pa,"__esModule",{value:!0});Pa.DocumentLinkFeature=void 0;var g0=require("vscode"),Ks=de(),qd=Pe(),y0=tt(),Ad=class extends qd.TextDocumentLanguageFeature{constructor(e){super(e,Ks.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=(0,qd.ensure)((0,qd.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentLinkProvider);r&&this.register({id:y0.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentLinks:(i,s)=>{let o=this._client,a=(u,d)=>o.sendRequest(Ks.DocumentLinkRequest.type,o.code2ProtocolConverter.asDocumentLinkParams(u),d).then(v=>d.isCancellationRequested?null:o.protocol2CodeConverter.asDocumentLinks(v,d),v=>o.handleFailedRequest(Ks.DocumentLinkRequest.type,d,v,null)),c=o.middleware;return c.provideDocumentLinks?c.provideDocumentLinks(i,s,a):a(i,s)},resolveDocumentLink:e.resolveProvider?(i,s)=>{let o=this._client,a=(u,d)=>o.sendRequest(Ks.DocumentLinkResolveRequest.type,o.code2ProtocolConverter.asDocumentLink(u),d).then(v=>d.isCancellationRequested?u:o.protocol2CodeConverter.asDocumentLink(v),v=>o.handleFailedRequest(Ks.DocumentLinkResolveRequest.type,d,v,u)),c=o.middleware;return c.resolveDocumentLink?c.resolveDocumentLink(i,s,a):a(i,s)}:void 0};return[g0.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Pa.DocumentLinkFeature=Ad});var rv=N(ka=>{"use strict";Object.defineProperty(ka,"__esModule",{value:!0});ka.ExecuteCommandFeature=void 0;var v0=require("vscode"),jd=de(),b0=tt(),nv=Pe(),Hd=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return jd.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,nv.ensure)((0,nv.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:b0.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,r=t.middleware,i=(s,o)=>{let a={command:s,arguments:o};return t.sendRequest(jd.ExecuteCommandRequest.type,a).then(void 0,c=>t.handleFailedRequest(jd.ExecuteCommandRequest.type,void 0,c,void 0))};if(e.registerOptions.commands){let s=[];for(let o of e.registerOptions.commands)s.push(v0.commands.registerCommand(o,(...a)=>r.executeCommand?r.executeCommand(o,a,i):i(o,a)));this._commands.set(e.id,s)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(r=>r.dispose())}clear(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}};ka.ExecuteCommandFeature=Hd});var iv=N(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});Oa.FileSystemWatcherFeature=void 0;var C0=require("vscode"),ci=de(),Ia=Pe(),$d=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return ci.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,Ia.ensure)((0,Ia.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,Ia.ensure)((0,Ia.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let r of e.registerOptions.watchers){let i=this._client.protocol2CodeConverter.asGlobPattern(r.globPattern);if(i===void 0)continue;let s=!0,o=!0,a=!0;r.kind!==void 0&&r.kind!==null&&(s=(r.kind&ci.WatchKind.Create)!==0,o=(r.kind&ci.WatchKind.Change)!==0,a=(r.kind&ci.WatchKind.Delete)!==0);let c=C0.workspace.createFileSystemWatcher(i,!s,!o,!a);this.hookListeners(c,s,o,a,t),t.push(c)}this._watchers.set(e.id,t)}registerRaw(e,t){let r=[];for(let i of t)this.hookListeners(i,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,t,r,i,s){t&&e.onDidCreate(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:ci.FileChangeType.Created}),null,s),r&&e.onDidChange(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:ci.FileChangeType.Changed}),null,s),i&&e.onDidDelete(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:ci.FileChangeType.Deleted}),null,s)}unregister(e){let t=this._watchers.get(e);if(t)for(let r of t)r.dispose()}clear(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}};Oa.FileSystemWatcherFeature=$d});var sv=N(Ma=>{"use strict";Object.defineProperty(Ma,"__esModule",{value:!0});Ma.ColorProviderFeature=void 0;var w0=require("vscode"),Gs=de(),Ud=Pe(),zd=class extends Ud.TextDocumentLanguageFeature{constructor(e){super(e,Gs.DocumentColorRequest.type)}fillClientCapabilities(e){(0,Ud.ensure)((0,Ud.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.colorProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideColorPresentations:(i,s,o)=>{let a=this._client,c=(d,v,b)=>{let g={color:d,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(v.document),range:a.code2ProtocolConverter.asRange(v.range)};return a.sendRequest(Gs.ColorPresentationRequest.type,g,b).then(h=>b.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(h,b),h=>a.handleFailedRequest(Gs.ColorPresentationRequest.type,b,h,null))},u=a.middleware;return u.provideColorPresentations?u.provideColorPresentations(i,s,o,c):c(i,s,o)},provideDocumentColors:(i,s)=>{let o=this._client,a=(u,d)=>{let v={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(u)};return o.sendRequest(Gs.DocumentColorRequest.type,v,d).then(b=>d.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(b,d),b=>o.handleFailedRequest(Gs.DocumentColorRequest.type,d,b,null))},c=o.middleware;return c.provideDocumentColors?c.provideDocumentColors(i,s,a):a(i,s)}};return[w0.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Ma.ColorProviderFeature=zd});var ov=N(Na=>{"use strict";Object.defineProperty(Na,"__esModule",{value:!0});Na.ImplementationFeature=void 0;var _0=require("vscode"),Wd=de(),Bd=Pe(),Kd=class extends Bd.TextDocumentLanguageFeature{constructor(e){super(e,Wd.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,Bd.ensure)((0,Bd.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.implementationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideImplementation:(i,s,o)=>{let a=this._client,c=(d,v,b)=>a.sendRequest(Wd.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(d,v),b).then(g=>b.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(g,b),g=>a.handleFailedRequest(Wd.ImplementationRequest.type,b,g,null)),u=a.middleware;return u.provideImplementation?u.provideImplementation(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return _0.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Na.ImplementationFeature=Kd});var av=N(La=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});La.TypeDefinitionFeature=void 0;var S0=require("vscode"),Gd=de(),Vs=Pe(),Vd=class extends Vs.TextDocumentLanguageFeature{constructor(e){super(e,Gd.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,Vs.ensure)((0,Vs.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,Vs.ensure)((0,Vs.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeDefinitionProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideTypeDefinition:(i,s,o)=>{let a=this._client,c=(d,v,b)=>a.sendRequest(Gd.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(d,v),b).then(g=>b.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(g,b),g=>a.handleFailedRequest(Gd.TypeDefinitionRequest.type,b,g,null)),u=a.middleware;return u.provideTypeDefinition?u.provideTypeDefinition(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return S0.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};La.TypeDefinitionFeature=Vd});var cv=N(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.WorkspaceFoldersFeature=as.arrayDiff=void 0;var T0=tt(),Fa=require("vscode"),Zs=de();function Zd(n,e){if(n!=null)return n[e]}function Xd(n,e){return n.filter(t=>e.indexOf(t)<0)}as.arrayDiff=Xd;var Jd=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Zs.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=Fa.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(Zs.WorkspaceFoldersRequest.type,s=>{let o=()=>{let c=Fa.workspace.workspaceFolders;return c===void 0?null:c.map(d=>this.asProtocol(d))},a=t.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(s,o):o(s)});let r=Zd(Zd(Zd(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof r=="string"?i=r:r===!0&&(i=T0.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let r=Xd(this._initialFolders,e),i=Xd(e,this._initialFolders);(i.length>0||r.length>0)&&(t=this.doSendEvent(i,r))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(r=>{this._client.error(`Sending notification ${Zs.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,t){let r={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(Zs.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let t=e.id,r=this._client,i=Fa.workspace.onDidChangeWorkspaceFolders(s=>{let o=u=>this.doSendEvent(u.added,u.removed),a=r.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(s,o):o(s)).catch(u=>{this._client.error(`Sending notification ${Zs.DidChangeWorkspaceFoldersNotification.type.method} failed`,u)})});this._listeners.set(t,i),this.sendInitialEvent(Fa.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};as.WorkspaceFoldersFeature=Jd});var lv=N(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.FoldingRangeFeature=void 0;var uv=require("vscode"),ui=de(),Xs=Pe(),Yd=class extends Xs.TextDocumentLanguageFeature{constructor(e){super(e,ui.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,Xs.ensure)((0,Xs.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[ui.FoldingRangeKind.Comment,ui.FoldingRangeKind.Imports,ui.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1},(0,Xs.ensure)((0,Xs.ensure)(e,"workspace"),"foldingRange").refreshSupport=!0}initialize(e,t){this._client.onRequest(ui.FoldingRangeRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeFoldingRange.fire()});let[r,i]=this.getRegistration(t,e.foldingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new uv.EventEmitter,i={onDidChangeFoldingRanges:r.event,provideFoldingRanges:(s,o,a)=>{let c=this._client,u=(v,b,g)=>{let h={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v)};return c.sendRequest(ui.FoldingRangeRequest.type,h,g).then(w=>g.isCancellationRequested?null:c.protocol2CodeConverter.asFoldingRanges(w,g),w=>c.handleFailedRequest(ui.FoldingRangeRequest.type,g,w,null))},d=c.middleware;return d.provideFoldingRanges?d.provideFoldingRanges(s,o,a,u):u(s,o,a)}};return[uv.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeFoldingRange:r}]}};qa.FoldingRangeFeature=Yd});var dv=N(Aa=>{"use strict";Object.defineProperty(Aa,"__esModule",{value:!0});Aa.DeclarationFeature=void 0;var E0=require("vscode"),Qd=de(),ef=Pe(),tf=class extends ef.TextDocumentLanguageFeature{constructor(e){super(e,Qd.DeclarationRequest.type)}fillClientCapabilities(e){let t=(0,ef.ensure)((0,ef.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.declarationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDeclaration:(i,s,o)=>{let a=this._client,c=(d,v,b)=>a.sendRequest(Qd.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(d,v),b).then(g=>b.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(g,b),g=>a.handleFailedRequest(Qd.DeclarationRequest.type,b,g,null)),u=a.middleware;return u.provideDeclaration?u.provideDeclaration(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return E0.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Aa.DeclarationFeature=tf});var fv=N(ja=>{"use strict";Object.defineProperty(ja,"__esModule",{value:!0});ja.SelectionRangeFeature=void 0;var R0=require("vscode"),nf=de(),rf=Pe(),sf=class extends rf.TextDocumentLanguageFeature{constructor(e){super(e,nf.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=(0,rf.ensure)((0,rf.ensure)(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.selectionRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSelectionRanges:(i,s,o)=>{let a=this._client,c=async(d,v,b)=>{let g={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(d),positions:a.code2ProtocolConverter.asPositionsSync(v,b)};return a.sendRequest(nf.SelectionRangeRequest.type,g,b).then(h=>b.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(h,b),h=>a.handleFailedRequest(nf.SelectionRangeRequest.type,b,h,null))},u=a.middleware;return u.provideSelectionRanges?u.provideSelectionRanges(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return R0.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};ja.SelectionRangeFeature=sf});var pv=N(Ha=>{"use strict";Object.defineProperty(Ha,"__esModule",{value:!0});Ha.ProgressFeature=void 0;var hv=de(),D0=Il();function x0(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var of=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:hv.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){x0(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},r=i=>{this.activeParts.add(new D0.ProgressPart(this._client,i.token,t))};e.onRequest(hv.WorkDoneProgressCreateRequest.type,r)}clear(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};Ha.ProgressFeature=of});var mv=N($a=>{"use strict";Object.defineProperty($a,"__esModule",{value:!0});$a.CallHierarchyFeature=void 0;var P0=require("vscode"),li=de(),af=Pe(),cf=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,r){let i=this.client,s=this.middleware,o=(a,c,u)=>{let d=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(li.CallHierarchyPrepareRequest.type,d,u).then(v=>u.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(v,u),v=>i.handleFailedRequest(li.CallHierarchyPrepareRequest.type,u,v,null))};return s.prepareCallHierarchy?s.prepareCallHierarchy(e,t,r,o):o(e,t,r)}provideCallHierarchyIncomingCalls(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(o)};return r.sendRequest(li.CallHierarchyIncomingCallsRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(u,a),u=>r.handleFailedRequest(li.CallHierarchyIncomingCallsRequest.type,a,u,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,s):s(e,t)}provideCallHierarchyOutgoingCalls(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(o)};return r.sendRequest(li.CallHierarchyOutgoingCallsRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(u,a),u=>r.handleFailedRequest(li.CallHierarchyOutgoingCallsRequest.type,a,u,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,s):s(e,t)}},uf=class extends af.TextDocumentLanguageFeature{constructor(e){super(e,li.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=e,r=(0,af.ensure)((0,af.ensure)(t,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.callHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new cf(t);return[P0.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};$a.CallHierarchyFeature=uf});var gv=N(za=>{"use strict";Object.defineProperty(za,"__esModule",{value:!0});za.SemanticTokensFeature=void 0;var Ua=require("vscode"),pe=de(),Js=Pe(),k0=_n(),lf=class extends Js.TextDocumentLanguageFeature{constructor(e){super(e,pe.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=(0,Js.ensure)((0,Js.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[pe.SemanticTokenTypes.namespace,pe.SemanticTokenTypes.type,pe.SemanticTokenTypes.class,pe.SemanticTokenTypes.enum,pe.SemanticTokenTypes.interface,pe.SemanticTokenTypes.struct,pe.SemanticTokenTypes.typeParameter,pe.SemanticTokenTypes.parameter,pe.SemanticTokenTypes.variable,pe.SemanticTokenTypes.property,pe.SemanticTokenTypes.enumMember,pe.SemanticTokenTypes.event,pe.SemanticTokenTypes.function,pe.SemanticTokenTypes.method,pe.SemanticTokenTypes.macro,pe.SemanticTokenTypes.keyword,pe.SemanticTokenTypes.modifier,pe.SemanticTokenTypes.comment,pe.SemanticTokenTypes.string,pe.SemanticTokenTypes.number,pe.SemanticTokenTypes.regexp,pe.SemanticTokenTypes.operator,pe.SemanticTokenTypes.decorator],t.tokenModifiers=[pe.SemanticTokenModifiers.declaration,pe.SemanticTokenModifiers.definition,pe.SemanticTokenModifiers.readonly,pe.SemanticTokenModifiers.static,pe.SemanticTokenModifiers.deprecated,pe.SemanticTokenModifiers.abstract,pe.SemanticTokenModifiers.async,pe.SemanticTokenModifiers.modification,pe.SemanticTokenModifiers.documentation,pe.SemanticTokenModifiers.defaultLibrary],t.formats=[pe.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,Js.ensure)((0,Js.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(pe.SemanticTokensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeSemanticTokensEmitter.fire()});let[i,s]=this.getRegistration(t,e.semanticTokensProvider);!i||!s||this.register({id:i,registerOptions:s})}registerLanguageProvider(e){let t=e.documentSelector,r=k0.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,s=new Ua.EventEmitter,o=r?{onDidChangeSemanticTokens:s.event,provideDocumentSemanticTokens:(g,h)=>{let w=this._client,_=w.middleware,D=(k,y)=>{let x={textDocument:w.code2ProtocolConverter.asTextDocumentIdentifier(k)};return w.sendRequest(pe.SemanticTokensRequest.type,x,y).then(O=>y.isCancellationRequested?null:w.protocol2CodeConverter.asSemanticTokens(O,y),O=>w.handleFailedRequest(pe.SemanticTokensRequest.type,y,O,null))};return _.provideDocumentSemanticTokens?_.provideDocumentSemanticTokens(g,h,D):D(g,h)},provideDocumentSemanticTokensEdits:i?(g,h,w)=>{let _=this._client,D=_.middleware,k=(y,x,O)=>{let U={textDocument:_.code2ProtocolConverter.asTextDocumentIdentifier(y),previousResultId:x};return _.sendRequest(pe.SemanticTokensDeltaRequest.type,U,O).then(async F=>O.isCancellationRequested?null:pe.SemanticTokens.is(F)?await _.protocol2CodeConverter.asSemanticTokens(F,O):await _.protocol2CodeConverter.asSemanticTokensEdits(F,O),F=>_.handleFailedRequest(pe.SemanticTokensDeltaRequest.type,O,F,null))};return D.provideDocumentSemanticTokensEdits?D.provideDocumentSemanticTokensEdits(g,h,w,k):k(g,h,w)}:void 0}:void 0,c=e.range===!0?{provideDocumentRangeSemanticTokens:(g,h,w)=>{let _=this._client,D=_.middleware,k=(y,x,O)=>{let U={textDocument:_.code2ProtocolConverter.asTextDocumentIdentifier(y),range:_.code2ProtocolConverter.asRange(x)};return _.sendRequest(pe.SemanticTokensRangeRequest.type,U,O).then(F=>O.isCancellationRequested?null:_.protocol2CodeConverter.asSemanticTokens(F,O),F=>_.handleFailedRequest(pe.SemanticTokensRangeRequest.type,O,F,null))};return D.provideDocumentRangeSemanticTokens?D.provideDocumentRangeSemanticTokens(g,h,w,k):k(g,h,w)}}:void 0,u=[],d=this._client,v=d.protocol2CodeConverter.asSemanticTokensLegend(e.legend),b=d.protocol2CodeConverter.asDocumentSelector(t);return o!==void 0&&u.push(Ua.languages.registerDocumentSemanticTokensProvider(b,o,v)),c!==void 0&&u.push(Ua.languages.registerDocumentRangeSemanticTokensProvider(b,c,v)),[new Ua.Disposable(()=>u.forEach(g=>g.dispose())),{range:c,full:o,onDidChangeSemanticTokensEmitter:s}]}};za.SemanticTokensFeature=lf});var bv=N(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});an.WillDeleteFilesFeature=an.WillRenameFilesFeature=an.WillCreateFilesFeature=an.DidDeleteFilesFeature=an.DidRenameFilesFeature=an.DidCreateFilesFeature=void 0;var xn=require("vscode"),I0=da(),br=de(),O0=tt();function yv(n,e){return n[e]===void 0&&(n[e]={}),n[e]}function M0(n,e){return n[e]}function vv(n,e,t){n[e]=t}var Ys=class n{constructor(e,t,r,i,s){this._client=e,this._event=t,this._registrationType=r,this._clientCapability=i,this._serverCapability=s,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=yv(yv(e,"workspace"),"fileOperations");vv(t,"dynamicRegistration",!0),vv(t,this._clientCapability,!0)}initialize(e){let t=e.workspace?.fileOperations,r=t!==void 0?M0(t,this._serverCapability):void 0;if(r?.filters!==void 0)try{this.register({id:O0.generateUuid(),registerOptions:{filters:r.filters}})}catch(i){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${i}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(r=>{let i=new I0.Minimatch(r.pattern.glob,n.asMinimatchOptions(r.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:i,kind:r.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return n.getFileType(e)}async filter(e,t){let r=await Promise.all(e.files.map(async s=>{let o=t(s),a=o.fsPath.replace(/\\/g,"/");for(let c of this._filters.values())for(let u of c)if(!(u.scheme!==void 0&&u.scheme!==o.scheme)){if(u.matcher.match(a)){if(u.kind===void 0)return!0;let d=await this.getFileType(o);if(d===void 0)return this._client.error(`Failed to determine file type for ${o.toString()}.`),!0;if(d===xn.FileType.File&&u.kind===br.FileOperationPatternKind.file||d===xn.FileType.Directory&&u.kind===br.FileOperationPatternKind.folder)return!0}else if(u.kind===br.FileOperationPatternKind.folder&&await n.getFileType(o)===xn.FileType.Directory&&u.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((s,o)=>r[o]);return{...e,files:i}}static async getFileType(e){try{return(await xn.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){let t={dot:!0};return e?.ignoreCase===!0&&(t.nocase=!0),t}},Wa=class extends Ys{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s),this._notificationType=r,this._accessUri=o,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,r)}}},Ba=class extends Wa{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let r=await Ys.getFileType(e);return r&&this._fsPathFileTypes.set(t,r),r}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},df=class extends Wa{constructor(e){super(e,xn.workspace.onDidCreateFiles,br.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.didCreateFiles?r.didCreateFiles(e,t):t(e)}};an.DidCreateFilesFeature=df;var ff=class extends Ba{constructor(e){super(e,xn.workspace.onDidRenameFiles,br.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=xn.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return r?.didRenameFiles?r.didRenameFiles(e,t):t(e)}};an.DidRenameFilesFeature=ff;var hf=class extends Ba{constructor(e){super(e,xn.workspace.onDidDeleteFiles,br.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=xn.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return r?.didDeleteFiles?r.didDeleteFiles(e,t):t(e)}};an.DidDeleteFilesFeature=hf;var Qs=class extends Ys{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s),this._requestType=r,this._accessUri=o,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,r)}else return}},pf=class extends Qs{constructor(e){super(e,xn.workspace.onWillCreateFiles,br.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willCreateFiles?r.willCreateFiles(e,t):t(e)}};an.WillCreateFilesFeature=pf;var mf=class extends Qs{constructor(e){super(e,xn.workspace.onWillRenameFiles,br.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willRenameFiles?r.willRenameFiles(e,t):t(e)}};an.WillRenameFilesFeature=mf;var gf=class extends Qs{constructor(e){super(e,xn.workspace.onWillDeleteFiles,br.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willDeleteFiles?r.willDeleteFiles(e,t):t(e)}};an.WillDeleteFilesFeature=gf});var Cv=N(Ka=>{"use strict";Object.defineProperty(Ka,"__esModule",{value:!0});Ka.LinkedEditingFeature=void 0;var N0=require("vscode"),yf=de(),vf=Pe(),bf=class extends vf.TextDocumentLanguageFeature{constructor(e){super(e,yf.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=(0,vf.ensure)((0,vf.ensure)(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideLinkedEditingRanges:(i,s,o)=>{let a=this._client,c=(d,v,b)=>a.sendRequest(yf.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(d,v),b).then(g=>b.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(g,b),g=>a.handleFailedRequest(yf.LinkedEditingRangeRequest.type,b,g,null)),u=a.middleware;return u.provideLinkedEditingRange?u.provideLinkedEditingRange(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return N0.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Ka.LinkedEditingFeature=bf});var wv=N(Ga=>{"use strict";Object.defineProperty(Ga,"__esModule",{value:!0});Ga.TypeHierarchyFeature=void 0;var L0=require("vscode"),di=de(),Cf=Pe(),wf=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,r){let i=this.client,s=this.middleware,o=(a,c,u)=>{let d=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(di.TypeHierarchyPrepareRequest.type,d,u).then(v=>u.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(v,u),v=>i.handleFailedRequest(di.TypeHierarchyPrepareRequest.type,u,v,null))};return s.prepareTypeHierarchy?s.prepareTypeHierarchy(e,t,r,o):o(e,t,r)}provideTypeHierarchySupertypes(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(o)};return r.sendRequest(di.TypeHierarchySupertypesRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(u,a),u=>r.handleFailedRequest(di.TypeHierarchySupertypesRequest.type,a,u,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,s):s(e,t)}provideTypeHierarchySubtypes(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(o)};return r.sendRequest(di.TypeHierarchySubtypesRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(u,a),u=>r.handleFailedRequest(di.TypeHierarchySubtypesRequest.type,a,u,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,s):s(e,t)}},_f=class extends Cf.TextDocumentLanguageFeature{constructor(e){super(e,di.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=(0,Cf.ensure)((0,Cf.ensure)(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new wf(t);return[L0.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};Ga.TypeHierarchyFeature=_f});var Sv=N(Za=>{"use strict";Object.defineProperty(Za,"__esModule",{value:!0});Za.InlineValueFeature=void 0;var _v=require("vscode"),Va=de(),eo=Pe(),Sf=class extends eo.TextDocumentLanguageFeature{constructor(e){super(e,Va.InlineValueRequest.type)}fillClientCapabilities(e){(0,eo.ensure)((0,eo.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,eo.ensure)((0,eo.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(Va.InlineValueRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlineValues.fire()});let[r,i]=this.getRegistration(t,e.inlineValueProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new _v.EventEmitter,i={onDidChangeInlineValues:r.event,provideInlineValues:(s,o,a,c)=>{let u=this._client,d=(b,g,h,w)=>{let _={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(b),range:u.code2ProtocolConverter.asRange(g),context:u.code2ProtocolConverter.asInlineValueContext(h)};return u.sendRequest(Va.InlineValueRequest.type,_,w).then(D=>w.isCancellationRequested?null:u.protocol2CodeConverter.asInlineValues(D,w),D=>u.handleFailedRequest(Va.InlineValueRequest.type,w,D,null))},v=u.middleware;return v.provideInlineValues?v.provideInlineValues(s,o,a,c,d):d(s,o,a,c)}};return[this.registerProvider(t,i),{provider:i,onDidChangeInlineValues:r}]}registerProvider(e,t){return _v.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Za.InlineValueFeature=Sf});var Ev=N(Xa=>{"use strict";Object.defineProperty(Xa,"__esModule",{value:!0});Xa.InlayHintsFeature=void 0;var Tv=require("vscode"),cs=de(),to=Pe(),Tf=class extends to.TextDocumentLanguageFeature{constructor(e){super(e,cs.InlayHintRequest.type)}fillClientCapabilities(e){let t=(0,to.ensure)((0,to.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,to.ensure)((0,to.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(cs.InlayHintRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlayHints.fire()});let[r,i]=this.getRegistration(t,e.inlayHintProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new Tv.EventEmitter,i={onDidChangeInlayHints:r.event,provideInlayHints:(s,o,a)=>{let c=this._client,u=async(v,b,g)=>{let h={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v),range:c.code2ProtocolConverter.asRange(b)};try{let w=await c.sendRequest(cs.InlayHintRequest.type,h,g);return g.isCancellationRequested?null:c.protocol2CodeConverter.asInlayHints(w,g)}catch(w){return c.handleFailedRequest(cs.InlayHintRequest.type,g,w,null)}},d=c.middleware;return d.provideInlayHints?d.provideInlayHints(s,o,a,u):u(s,o,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(s,o)=>{let a=this._client,c=async(d,v)=>{try{let b=await a.sendRequest(cs.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(d),v);if(v.isCancellationRequested)return null;let g=a.protocol2CodeConverter.asInlayHint(b,v);return v.isCancellationRequested?null:g}catch(b){return a.handleFailedRequest(cs.InlayHintResolveRequest.type,v,b,null)}},u=a.middleware;return u.resolveInlayHint?u.resolveInlayHint(s,o,c):c(s,o)}:void 0,[this.registerProvider(t,i),{provider:i,onDidChangeInlayHints:r}]}registerProvider(e,t){return Tv.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Xa.InlayHintsFeature=Tf});var Rv=N(Ja=>{"use strict";Object.defineProperty(Ja,"__esModule",{value:!0});Ja.InlineCompletionItemFeature=void 0;var F0=require("vscode"),Ef=de(),Rf=Pe(),q0=tt(),Df=class extends Rf.TextDocumentLanguageFeature{constructor(e){super(e,Ef.InlineCompletionRequest.type)}fillClientCapabilities(e){let t=(0,Rf.ensure)((0,Rf.ensure)(e,"textDocument"),"inlineCompletion");t.dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.inlineCompletionProvider);r&&this.register({id:q0.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideInlineCompletionItems:(i,s,o,a)=>{let c=this._client,u=this._client.middleware,d=(v,b,g,h)=>c.sendRequest(Ef.InlineCompletionRequest.type,c.code2ProtocolConverter.asInlineCompletionParams(v,b,g),h).then(w=>h.isCancellationRequested?null:c.protocol2CodeConverter.asInlineCompletionResult(w,h),w=>c.handleFailedRequest(Ef.InlineCompletionRequest.type,h,w,null));return u.provideInlineCompletionItems?u.provideInlineCompletionItems(i,s,o,a,d):d(i,s,o,a)}};return[F0.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Ja.InlineCompletionItemFeature=Df});var Mf=N(kt=>{"use strict";Object.defineProperty(kt,"__esModule",{value:!0});kt.ProposedFeatures=kt.BaseLanguageClient=kt.MessageTransports=kt.SuspendMode=kt.State=kt.CloseAction=kt.ErrorAction=kt.RevealOutputChannelOn=void 0;var je=require("vscode"),z=de(),A0=ny(),j0=sy(),Wn=_n(),Ya=ia(),Dv=tt(),H0=Il(),zn=Pe(),$0=Jl(),xv=Fy(),Pv=Ay(),us=jy(),U0=Hy(),z0=$y(),W0=Uy(),B0=Wy(),K0=By(),G0=_d(),V0=Gy(),Z0=Vy(),X0=Zy(),J0=Jy(),xf=Yy(),Y0=ev(),Q0=tv(),eS=rv(),tS=iv(),nS=sv(),rS=ov(),iS=av(),sS=cv(),oS=lv(),aS=dv(),cS=fv(),uS=pv(),lS=mv(),dS=gv(),ls=bv(),fS=Cv(),hS=wv(),pS=Sv(),mS=Ev(),gS=Rv(),fi;(function(n){n[n.Debug=0]="Debug",n[n.Info=1]="Info",n[n.Warn=2]="Warn",n[n.Error=3]="Error",n[n.Never=4]="Never"})(fi||(kt.RevealOutputChannelOn=fi={}));var ro;(function(n){n[n.Continue=1]="Continue",n[n.Shutdown=2]="Shutdown"})(ro||(kt.ErrorAction=ro={}));var zr;(function(n){n[n.DoNotRestart=1]="DoNotRestart",n[n.Restart=2]="Restart"})(zr||(kt.CloseAction=zr={}));var no;(function(n){n[n.Stopped=1]="Stopped",n[n.Starting=3]="Starting",n[n.Running=2]="Running"})(no||(kt.State=no={}));var kv;(function(n){n.off="off",n.on="on"})(kv||(kt.SuspendMode=kv={}));var Pf;(function(n){function e(t){return t==null?!1:typeof t=="boolean"||typeof t=="object"&&t!==null&&Wn.stringArray(t.enabledCommands)?t:!1}n.sanitizeIsTrusted=e})(Pf||(Pf={}));var kf=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,r){return r&&r<=3?{action:ro.Continue}:{action:ro.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:zr.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=180*1e3?{action:zr.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:zr.Restart})}},Ce;(function(n){n.Initial="initial",n.Starting="starting",n.StartFailed="startFailed",n.Running="running",n.Stopping="stopping",n.Stopped="stopped"})(Ce||(Ce={}));var Iv;(function(n){function e(t){return t&&z.MessageReader.is(t.reader)&&z.MessageWriter.is(t.writer)}n.is=e})(Iv||(kt.MessageTransports=Iv={}));var io=class n{constructor(e,t,r){this._traceFormat=z.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new Ya.Semaphore(1),this._id=e,this._name=t,r=r||{};let i={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(i.isTrusted=Pf.sanitizeIsTrusted(r.markdown.isTrusted),i.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??fi.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler(r.connectionOptions?.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:i,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=Ce.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new Ya.Semaphore(1),this._pendingChangeDelayer=new Ya.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new Ya.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new z.Emitter,this._stateChangeEmitter=new z.Emitter,this._trace=z.Trace.Off,this._tracer={log:(s,o)=>{Wn.string(s)?this.logTrace(s,o):this.logObjectTrace(s)}},this._c2p=A0.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=j0.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=je.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let r=this.getPublicState();r!==t&&this._stateChangeEmitter.fire({oldState:t,newState:r})}getPublicState(){switch(this.$state){case Ce.Starting:return no.Starting;case Ce.Running:return no.Running;default:return no.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===Ce.StartFailed||this.$state===Ce.Stopping||this.$state===Ce.Stopped)return Promise.reject(new z.ResponseError(z.ErrorCodes.ConnectionInactive,"Client is not running"));let r=await this.$start();this._didChangeTextDocumentFeature.syncKind===z.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(r);let i=this._clientOptions.middleware?.sendRequest;if(i!==void 0){let s,o;return t.length===1?z.CancellationToken.is(t[0])?o=t[0]:s=t[0]:t.length===2&&(s=t[0],o=t[1]),i(e,s,o,(a,c,u)=>{let d=[];return c!==void 0&&d.push(c),u!==void 0&&d.push(u),r.sendRequest(a,...d)})}else return r.sendRequest(e,...t)}onRequest(e,t){let r=typeof e=="string"?e:e.method;this._requestHandlers.set(r,t);let i=this.activeConnection(),s;return i!==void 0?(this._requestDisposables.set(r,i.onRequest(e,t)),s={dispose:()=>{let o=this._requestDisposables.get(r);o!==void 0&&(o.dispose(),this._requestDisposables.delete(r))}}):(this._pendingRequestHandlers.set(r,t),s={dispose:()=>{this._pendingRequestHandlers.delete(r);let o=this._requestDisposables.get(r);o!==void 0&&(o.dispose(),this._requestDisposables.delete(r))}}),{dispose:()=>{this._requestHandlers.delete(r),s.dispose()}}}async sendNotification(e,t){if(this.$state===Ce.StartFailed||this.$state===Ce.Stopping||this.$state===Ce.Stopped)return Promise.reject(new z.ResponseError(z.ErrorCodes.ConnectionInactive,"Client is not running"));let r=this._didChangeTextDocumentFeature.syncKind===z.TextDocumentSyncKind.Full,i;r&&typeof e!="string"&&e.method===z.DidOpenTextDocumentNotification.method&&(i=t?.textDocument.uri,this._pendingOpenNotifications.add(i));let s=await this.$start();r&&await this.sendPendingFullTextDocumentChanges(s),i!==void 0&&this._pendingOpenNotifications.delete(i);let o=this._clientOptions.middleware?.sendNotification;return o?o(e,s.sendNotification.bind(s),t):s.sendNotification(e,t)}onNotification(e,t){let r=typeof e=="string"?e:e.method;this._notificationHandlers.set(r,t);let i=this.activeConnection(),s;return i!==void 0?(this._notificationDisposables.set(r,i.onNotification(e,t)),s={dispose:()=>{let o=this._notificationDisposables.get(r);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(r))}}):(this._pendingNotificationHandlers.set(r,t),s={dispose:()=>{this._pendingNotificationHandlers.delete(r);let o=this._notificationDisposables.get(r);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(r))}}),{dispose:()=>{this._notificationHandlers.delete(r),s.dispose()}}}async sendProgress(e,t,r){if(this.$state===Ce.StartFailed||this.$state===Ce.Stopping||this.$state===Ce.Stopped)return Promise.reject(new z.ResponseError(z.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,t,r)}catch(i){throw this.error(`Sending progress for token ${t} failed.`,i),i}}onProgress(e,t,r){this._progressHandlers.set(t,{type:e,handler:r});let i=this.activeConnection(),s,o=this._clientOptions.middleware?.handleWorkDoneProgress,a=z.WorkDoneProgress.is(e)&&o!==void 0?c=>{o(t,c,()=>r(c))}:r;return i!==void 0?(this._progressDisposables.set(t,i.onProgress(e,t,a)),s={dispose:()=>{let c=this._progressDisposables.get(t);c!==void 0&&(c.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:r}),s={dispose:()=>{this._pendingProgressHandlers.delete(t);let c=this._progressDisposables.get(t);c!==void 0&&(c.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),s.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new kf(this,e??4)}async setTrace(e){this._trace=e;let t=this.activeConnection();t!==void 0&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof z.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?Wn.string(e.stack)?e.stack:e.message:Wn.string(e)?e:e.toString()}debug(e,t,r=!0){this.logOutputMessage(z.MessageType.Debug,fi.Debug,"Debug",e,t,r)}info(e,t,r=!0){this.logOutputMessage(z.MessageType.Info,fi.Info,"Info",e,t,r)}warn(e,t,r=!0){this.logOutputMessage(z.MessageType.Warning,fi.Warn,"Warn",e,t,r)}error(e,t,r=!0){this.logOutputMessage(z.MessageType.Error,fi.Error,"Error",e,t,r)}logOutputMessage(e,t,r,i,s,o){this.outputChannel.appendLine(`[${r.padEnd(5)} - ${new Date().toLocaleTimeString()}] ${i}`),s!=null&&this.outputChannel.appendLine(this.data2String(s)),(o==="force"||o&&this._clientOptions.revealOutputChannelOn<=t)&&this.showNotificationMessage(e,i)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===z.MessageType.Error?je.window.showErrorMessage:e===z.MessageType.Warning?je.window.showWarningMessage:je.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===Ce.Initial||this.$state===Ce.Stopping||this.$state===Ce.Stopped}needsStop(){return this.$state===Ce.Starting||this.$state===Ce.Running}activeConnection(){return this.$state===Ce.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===Ce.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===Ce.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;let[e,t,r]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?je.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):je.languages.createDiagnosticCollection());for(let[i,s]of this._notificationHandlers)this._pendingNotificationHandlers.has(i)||this._pendingNotificationHandlers.set(i,s);for(let[i,s]of this._requestHandlers)this._pendingRequestHandlers.has(i)||this._pendingRequestHandlers.set(i,s);for(let[i,s]of this._progressHandlers)this._pendingProgressHandlers.has(i)||this._pendingProgressHandlers.set(i,s);this.$state=Ce.Starting;try{let i=await this.createConnection();i.onNotification(z.LogMessageNotification.type,s=>{switch(s.type){case z.MessageType.Error:this.error(s.message,void 0,!1);break;case z.MessageType.Warning:this.warn(s.message,void 0,!1);break;case z.MessageType.Info:this.info(s.message,void 0,!1);break;case z.MessageType.Debug:this.debug(s.message,void 0,!1);break;default:this.outputChannel.appendLine(s.message)}}),i.onNotification(z.ShowMessageNotification.type,s=>{switch(s.type){case z.MessageType.Error:je.window.showErrorMessage(s.message);break;case z.MessageType.Warning:je.window.showWarningMessage(s.message);break;case z.MessageType.Info:je.window.showInformationMessage(s.message);break;default:je.window.showInformationMessage(s.message)}}),i.onRequest(z.ShowMessageRequest.type,s=>{let o;switch(s.type){case z.MessageType.Error:o=je.window.showErrorMessage;break;case z.MessageType.Warning:o=je.window.showWarningMessage;break;case z.MessageType.Info:o=je.window.showInformationMessage;break;default:o=je.window.showInformationMessage}let a=s.actions||[];return o(s.message,...a)}),i.onNotification(z.TelemetryEventNotification.type,s=>{this._telemetryEmitter.fire(s)}),i.onRequest(z.ShowDocumentRequest.type,async s=>{let o=async c=>{let u=this.protocol2CodeConverter.asUri(c.uri);try{if(c.external===!0)return{success:await je.env.openExternal(u)};{let d={};return c.selection!==void 0&&(d.selection=this.protocol2CodeConverter.asRange(c.selection)),c.takeFocus===void 0||c.takeFocus===!1?d.preserveFocus=!0:c.takeFocus===!0&&(d.preserveFocus=!1),await je.window.showTextDocument(u,d),{success:!0}}}catch{return{success:!1}}},a=this._clientOptions.middleware.window?.showDocument;return a!==void 0?a(s,o):o(s)}),i.listen(),await this.initialize(i),t()}catch(i){this.$state=Ce.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,i,"force"),r(i)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise((i,s)=>{e=i,t=s}),e,t]}async initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[r,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],s={processId:null,clientInfo:{name:je.env.appName,version:je.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(je.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:Wn.func(t)?t():t,trace:z.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(s),this._clientOptions.progressOnInitialization){let o=Dv.generateUuid(),a=new H0.ProgressPart(e,o);s.workDoneToken=o;try{let c=await this.doInitialize(e,s);return a.done(),c}catch(c){throw a.cancel(),c}}else return this.doInitialize(e,s)}async doInitialize(e,t){try{let r=await e.initialize(t);if(r.capabilities.positionEncoding!==void 0&&r.capabilities.positionEncoding!==z.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${r.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=r,this.$state=Ce.Running;let i;Wn.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===z.TextDocumentSyncKind.None?i={openClose:!1,change:z.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(i=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:i}),e.onNotification(z.PublishDiagnosticsNotification.type,s=>this.handleDiagnostics(s)),e.onRequest(z.RegistrationRequest.type,s=>this.handleRegistrationRequest(s)),e.onRequest("client/registerFeature",s=>this.handleRegistrationRequest(s)),e.onRequest(z.UnregistrationRequest.type,s=>this.handleUnregistrationRequest(s)),e.onRequest("client/unregisterFeature",s=>this.handleUnregistrationRequest(s)),e.onRequest(z.ApplyWorkspaceEditRequest.type,s=>this.handleApplyWorkspaceEdit(s));for(let[s,o]of this._pendingNotificationHandlers)this._notificationDisposables.set(s,e.onNotification(s,o));this._pendingNotificationHandlers.clear();for(let[s,o]of this._pendingRequestHandlers)this._requestDisposables.set(s,e.onRequest(s,o));this._pendingRequestHandlers.clear();for(let[s,o]of this._pendingProgressHandlers)this._progressDisposables.set(s,e.onProgress(o.type,s,o.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(z.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),r}catch(r){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):this.stop():r instanceof z.ResponseError&&r.data&&r.data.retry?je.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):this.stop()}):(r&&r.message&&je.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop()),r}}_clientGetRootPath(){let e=je.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,t){if(this.$state===Ce.Stopped||this.$state===Ce.Initial)return;if(this.$state===Ce.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}let r=this.activeConnection();if(r===void 0||this.$state!==Ce.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=Ce.Stopping,this.cleanUp(e);let i=new Promise(o=>{(0,z.RAL)().timer.setTimeout(o,t)}),s=(async o=>(await o.shutdown(),await o.exit(),o))(r);return this._onStop=Promise.race([i,s]).then(o=>{if(o!==void 0)o.end(),o.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},o=>{throw this.error("Stopping server failed",o,!1),o}).finally(()=>{this.$state=Ce.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();let t=this._listeners.splice(0,this._listeners.length);for(let r of t)r.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(let r of Array.from(this._features.entries()).map(i=>i[1]).reverse())r.clear();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){let t=this;async function r(s){return t._fileEvents.push(s),t._fileEventDelayer.trigger(async()=>{await t.sendNotification(z.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]})}let i=this.clientOptions.middleware?.workspace;(i?.didChangeWatchedFile?i.didChangeWatchedFile(e,r):r(e)).catch(s=>{t.error("Notify file events failed.",s)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{let t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(t.length===0)return;for(let r of t){let i=this.code2ProtocolConverter.asChangeTextDocumentParams(r);await e.sendNotification(z.DidChangeTextDocumentNotification.type,i),this._didChangeTextDocumentFeature.notificationSent(r,z.DidChangeTextDocumentNotification.type,i)}}catch(t){throw this.error("Sending pending changes failed",t,!1),t}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{let e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error("Delivering pending changes failed",e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,z.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,r]=e.value;this._diagnosticQueue.delete(t);let i=new je.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(s=>{if(!i.token.isCancellationRequested){let o=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(o,s,(c,u)=>this.setDiagnostics(c,u)):this.setDiagnostics(o,s)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}getLocale(){return je.env.language}async $start(){if(this.$state===Ce.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();let e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(i,s,o)=>{this.handleConnectionError(i,s,o).catch(a=>this.error("Handling connection error failed",a))},t=()=>{this.handleConnectionClosed().catch(i=>this.error("Handling connection close failed",i))},r=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=yS(r.reader,r.writer,e,t,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===Ce.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:zr.DoNotRestart};if(this.$state!==Ce.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===zr.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,e.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===Ce.Starting?this.$state=Ce.StartFailed:this.$state=Ce.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===zr.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=Ce.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(t=>this.error("Restarting server failed",t,"force")))}async handleConnectionError(e,t,r){let i=await this._clientOptions.errorHandler.error(e,t,r);i.action===ro.Shutdown?(this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}
Shutting down server.`,void 0,i.handled===!0?!1:"force"),this.stop().catch(s=>{this.error("Stopping server failed",s,!1)})):this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}`,void 0,i.handled===!0?!1:"force")}hookConfigurationChanged(e){this._listeners.push(je.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,t=!1){let r=je.workspace.getConfiguration(this._id),i=z.Trace.Off,s=z.TraceFormat.Text;if(r){let o=r.get("trace.server","off");typeof o=="string"?i=z.Trace.fromString(o):(i=z.Trace.fromString(r.get("trace.server.verbosity","off")),s=z.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=i,this._traceFormat=s,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch(o=>{this.error("Updating trace failed with error",o,!1)})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let r;Wn.array(t)?r=t:r=[t],r&&this._dynamicFeatures.get(z.DidChangeWatchedFilesNotification.type.method).registerRaw(Dv.generateUuid(),r)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),zn.DynamicFeature.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){let t=this.getFeature(z.NotebookDocumentSyncRegistrationType.method);return t===void 0||!(t instanceof xv.NotebookDocumentSyncFeature)?!1:t.handles(e)}registerBuiltinFeatures(){let e=new Map;this.registerFeature(new Pv.ConfigurationFeature(this)),this.registerFeature(new us.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new us.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new us.WillSaveFeature(this)),this.registerFeature(new us.WillSaveWaitUntilFeature(this)),this.registerFeature(new us.DidSaveTextDocumentFeature(this)),this.registerFeature(new us.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new tS.FileSystemWatcherFeature(this,t=>this.notifyFileEvent(t))),this.registerFeature(new U0.CompletionItemFeature(this)),this.registerFeature(new z0.HoverFeature(this)),this.registerFeature(new B0.SignatureHelpFeature(this)),this.registerFeature(new W0.DefinitionFeature(this)),this.registerFeature(new Z0.ReferencesFeature(this)),this.registerFeature(new K0.DocumentHighlightFeature(this)),this.registerFeature(new G0.DocumentSymbolFeature(this)),this.registerFeature(new V0.WorkspaceSymbolFeature(this)),this.registerFeature(new X0.CodeActionFeature(this)),this.registerFeature(new J0.CodeLensFeature(this)),this.registerFeature(new xf.DocumentFormattingFeature(this)),this.registerFeature(new xf.DocumentRangeFormattingFeature(this)),this.registerFeature(new xf.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new Y0.RenameFeature(this)),this.registerFeature(new Q0.DocumentLinkFeature(this)),this.registerFeature(new eS.ExecuteCommandFeature(this)),this.registerFeature(new Pv.SyncConfigurationFeature(this)),this.registerFeature(new iS.TypeDefinitionFeature(this)),this.registerFeature(new rS.ImplementationFeature(this)),this.registerFeature(new nS.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new sS.WorkspaceFoldersFeature(this)),this.registerFeature(new oS.FoldingRangeFeature(this)),this.registerFeature(new aS.DeclarationFeature(this)),this.registerFeature(new cS.SelectionRangeFeature(this)),this.registerFeature(new uS.ProgressFeature(this)),this.registerFeature(new lS.CallHierarchyFeature(this)),this.registerFeature(new dS.SemanticTokensFeature(this)),this.registerFeature(new fS.LinkedEditingFeature(this)),this.registerFeature(new ls.DidCreateFilesFeature(this)),this.registerFeature(new ls.DidRenameFilesFeature(this)),this.registerFeature(new ls.DidDeleteFilesFeature(this)),this.registerFeature(new ls.WillCreateFilesFeature(this)),this.registerFeature(new ls.WillRenameFilesFeature(this)),this.registerFeature(new ls.WillDeleteFilesFeature(this)),this.registerFeature(new hS.TypeHierarchyFeature(this)),this.registerFeature(new pS.InlineValueFeature(this)),this.registerFeature(new mS.InlayHintsFeature(this)),this.registerFeature(new $0.DiagnosticFeature(this)),this.registerFeature(new xv.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(Of.createAll(this))}fillInitializeParams(e){for(let t of this._features)Wn.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};(0,zn.ensure)(e,"workspace").applyEdit=!0;let t=(0,zn.ensure)((0,zn.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[z.ResourceOperationKind.Create,z.ResourceOperationKind.Rename,z.ResourceOperationKind.Delete],t.failureHandling=z.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let r=(0,zn.ensure)((0,zn.ensure)(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[z.DiagnosticTag.Unnecessary,z.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;let i=(0,zn.ensure)(e,"window"),s=(0,zn.ensure)(i,"showMessage");s.messageActionItem={additionalPropertiesSupport:!0};let o=(0,zn.ensure)(i,"showDocument");o.support=!0;let a=(0,zn.ensure)(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(n.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},a.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let c of this._features)c.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let r of this._features)Wn.func(r.preInitialize)&&r.preInitialize(this._capabilities,t);for(let r of this._features)r.initialize(this._capabilities,t)}async handleRegistrationRequest(e){let t=this.clientOptions.middleware?.handleRegisterCapability;return t?t(e,r=>this.doRegisterCapability(r)):this.doRegisterCapability(e)}async doRegisterCapability(e){if(!this.isRunning()){for(let t of e.registrations)this._ignoredRegistrations.add(t.id);return}for(let t of e.registrations){let r=this._dynamicFeatures.get(t.method);if(r===void 0)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Registration failed.`));let i=t.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;let s={id:t.id,registerOptions:i};try{r.register(s)}catch(o){return Promise.reject(o)}}}async handleUnregistrationRequest(e){let t=this.clientOptions.middleware?.handleUnregisterCapability;return t?t(e,r=>this.doUnregisterCapability(r)):this.doUnregisterCapability(e)}async doUnregisterCapability(e){for(let t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;let r=this._dynamicFeatures.get(t.method);if(!r)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));r.unregister(t.id)}}async handleApplyWorkspaceEdit(e){let t=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;je.workspace.textDocuments.forEach(o=>i.set(o.uri.toString(),o));let s=!1;if(t.documentChanges){for(let o of t.documentChanges)if(z.TextDocumentEdit.is(o)&&o.textDocument.version&&o.textDocument.version>=0){let a=this._p2c.asUri(o.textDocument.uri).toString(),c=i.get(a);if(c&&c.version!==o.textDocument.version){s=!0;break}}}return s?Promise.resolve({applied:!1}):Wn.asPromise(je.workspace.applyEdit(r).then(o=>({applied:o})))}handleFailedRequest(e,t,r,i,s=!0){if(r instanceof z.ResponseError){if(r.code===z.ErrorCodes.PendingResponseRejected||r.code===z.ErrorCodes.ConnectionInactive)return i;if(r.code===z.LSPErrorCodes.RequestCancelled||r.code===z.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw r.data!==void 0?new zn.LSPCancellationError(r.data):new je.CancellationError}else if(r.code===z.LSPErrorCodes.ContentModified){if(n.RequestsToCancelOnContentModified.has(e.method)||n.CancellableResolveCalls.has(e.method))throw new je.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,r,s),r}};kt.BaseLanguageClient=io;io.RequestsToCancelOnContentModified=new Set([z.SemanticTokensRequest.method,z.SemanticTokensRangeRequest.method,z.SemanticTokensDeltaRequest.method]);io.CancellableResolveCalls=new Set([z.CompletionResolveRequest.method,z.CodeLensResolveRequest.method,z.CodeActionResolveRequest.method,z.InlayHintResolveRequest.method,z.DocumentLinkResolveRequest.method,z.WorkspaceSymbolResolveRequest.method]);var If=class{error(e){(0,z.RAL)().console.error(e)}warn(e){(0,z.RAL)().console.warn(e)}info(e){(0,z.RAL)().console.info(e)}log(e){(0,z.RAL)().console.log(e)}};function yS(n,e,t,r,i){let s=new If,o=(0,z.createProtocolConnection)(n,e,s,i);return o.onError(c=>{t(c[0],c[1],c[2])}),o.onClose(r),{listen:()=>o.listen(),sendRequest:o.sendRequest,onRequest:o.onRequest,hasPendingResponse:o.hasPendingResponse,sendNotification:o.sendNotification,onNotification:o.onNotification,onProgress:o.onProgress,sendProgress:o.sendProgress,trace:(c,u,d)=>{let v={sendNotification:!1,traceFormat:z.TraceFormat.Text};return d===void 0?o.trace(c,u,v):(Wn.boolean(d),o.trace(c,u,d))},initialize:c=>o.sendRequest(z.InitializeRequest.type,c),shutdown:()=>o.sendRequest(z.ShutdownRequest.type,void 0),exit:()=>o.sendNotification(z.ExitNotification.type),end:()=>o.end(),dispose:()=>o.dispose()}}var Of;(function(n){function e(t){return[new gS.InlineCompletionItemFeature(t)]}n.createAll=e})(Of||(kt.ProposedFeatures=Of={}))});var Mv=N(Qa=>{"use strict";Object.defineProperty(Qa,"__esModule",{value:!0});Qa.terminate=void 0;var Ov=require("child_process"),vS=require("path"),bS=process.platform==="win32",CS=process.platform==="darwin",wS=process.platform==="linux";function _S(n,e){if(bS)try{let i={stdio:["pipe","pipe","ignore"]};return e&&(i.cwd=e),Ov.execFileSync("taskkill",["/T","/F","/PID",n.pid.toString()],i),!0}catch{return!1}else if(wS||CS)try{var t=(0,vS.join)(__dirname,"terminateProcess.sh"),r=Ov.spawnSync(t,[n.pid.toString()]);return!r.error}catch{return!1}else return n.kill("SIGKILL"),!0}Qa.terminate=_S});var Nf=N((Cx,Nv)=>{"use strict";Nv.exports=de()});var so=N((wx,Lv)=>{"use strict";var SS=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{};Lv.exports=SS});var ec=N((_x,Fv)=>{"use strict";var TS="2.0.0",ES=Number.MAX_SAFE_INTEGER||9007199254740991,RS=16,DS=250,xS=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Fv.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:RS,MAX_SAFE_BUILD_LENGTH:DS,MAX_SAFE_INTEGER:ES,RELEASE_TYPES:xS,SEMVER_SPEC_VERSION:TS,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var tc=N((sr,qv)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:Lf,MAX_SAFE_BUILD_LENGTH:PS,MAX_LENGTH:kS}=ec(),IS=so();sr=qv.exports={};var OS=sr.re=[],MS=sr.safeRe=[],Q=sr.src=[],NS=sr.safeSrc=[],ee=sr.t={},LS=0,Ff="[a-zA-Z0-9-]",FS=[["\\s",1],["\\d",kS],[Ff,PS]],qS=n=>{for(let[e,t]of FS)n=n.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return n},me=(n,e,t)=>{let r=qS(e),i=LS++;IS(n,i,e),ee[n]=i,Q[i]=e,NS[i]=r,OS[i]=new RegExp(e,t?"g":void 0),MS[i]=new RegExp(r,t?"g":void 0)};me("NUMERICIDENTIFIER","0|[1-9]\\d*");me("NUMERICIDENTIFIERLOOSE","\\d+");me("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Ff}*`);me("MAINVERSION",`(${Q[ee.NUMERICIDENTIFIER]})\\.(${Q[ee.NUMERICIDENTIFIER]})\\.(${Q[ee.NUMERICIDENTIFIER]})`);me("MAINVERSIONLOOSE",`(${Q[ee.NUMERICIDENTIFIERLOOSE]})\\.(${Q[ee.NUMERICIDENTIFIERLOOSE]})\\.(${Q[ee.NUMERICIDENTIFIERLOOSE]})`);me("PRERELEASEIDENTIFIER",`(?:${Q[ee.NONNUMERICIDENTIFIER]}|${Q[ee.NUMERICIDENTIFIER]})`);me("PRERELEASEIDENTIFIERLOOSE",`(?:${Q[ee.NONNUMERICIDENTIFIER]}|${Q[ee.NUMERICIDENTIFIERLOOSE]})`);me("PRERELEASE",`(?:-(${Q[ee.PRERELEASEIDENTIFIER]}(?:\\.${Q[ee.PRERELEASEIDENTIFIER]})*))`);me("PRERELEASELOOSE",`(?:-?(${Q[ee.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${Q[ee.PRERELEASEIDENTIFIERLOOSE]})*))`);me("BUILDIDENTIFIER",`${Ff}+`);me("BUILD",`(?:\\+(${Q[ee.BUILDIDENTIFIER]}(?:\\.${Q[ee.BUILDIDENTIFIER]})*))`);me("FULLPLAIN",`v?${Q[ee.MAINVERSION]}${Q[ee.PRERELEASE]}?${Q[ee.BUILD]}?`);me("FULL",`^${Q[ee.FULLPLAIN]}$`);me("LOOSEPLAIN",`[v=\\s]*${Q[ee.MAINVERSIONLOOSE]}${Q[ee.PRERELEASELOOSE]}?${Q[ee.BUILD]}?`);me("LOOSE",`^${Q[ee.LOOSEPLAIN]}$`);me("GTLT","((?:<|>)?=?)");me("XRANGEIDENTIFIERLOOSE",`${Q[ee.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);me("XRANGEIDENTIFIER",`${Q[ee.NUMERICIDENTIFIER]}|x|X|\\*`);me("XRANGEPLAIN",`[v=\\s]*(${Q[ee.XRANGEIDENTIFIER]})(?:\\.(${Q[ee.XRANGEIDENTIFIER]})(?:\\.(${Q[ee.XRANGEIDENTIFIER]})(?:${Q[ee.PRERELEASE]})?${Q[ee.BUILD]}?)?)?`);me("XRANGEPLAINLOOSE",`[v=\\s]*(${Q[ee.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Q[ee.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Q[ee.XRANGEIDENTIFIERLOOSE]})(?:${Q[ee.PRERELEASELOOSE]})?${Q[ee.BUILD]}?)?)?`);me("XRANGE",`^${Q[ee.GTLT]}\\s*${Q[ee.XRANGEPLAIN]}$`);me("XRANGELOOSE",`^${Q[ee.GTLT]}\\s*${Q[ee.XRANGEPLAINLOOSE]}$`);me("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Lf}})(?:\\.(\\d{1,${Lf}}))?(?:\\.(\\d{1,${Lf}}))?`);me("COERCE",`${Q[ee.COERCEPLAIN]}(?:$|[^\\d])`);me("COERCEFULL",Q[ee.COERCEPLAIN]+`(?:${Q[ee.PRERELEASE]})?(?:${Q[ee.BUILD]})?(?:$|[^\\d])`);me("COERCERTL",Q[ee.COERCE],!0);me("COERCERTLFULL",Q[ee.COERCEFULL],!0);me("LONETILDE","(?:~>?)");me("TILDETRIM",`(\\s*)${Q[ee.LONETILDE]}\\s+`,!0);sr.tildeTrimReplace="$1~";me("TILDE",`^${Q[ee.LONETILDE]}${Q[ee.XRANGEPLAIN]}$`);me("TILDELOOSE",`^${Q[ee.LONETILDE]}${Q[ee.XRANGEPLAINLOOSE]}$`);me("LONECARET","(?:\\^)");me("CARETTRIM",`(\\s*)${Q[ee.LONECARET]}\\s+`,!0);sr.caretTrimReplace="$1^";me("CARET",`^${Q[ee.LONECARET]}${Q[ee.XRANGEPLAIN]}$`);me("CARETLOOSE",`^${Q[ee.LONECARET]}${Q[ee.XRANGEPLAINLOOSE]}$`);me("COMPARATORLOOSE",`^${Q[ee.GTLT]}\\s*(${Q[ee.LOOSEPLAIN]})$|^$`);me("COMPARATOR",`^${Q[ee.GTLT]}\\s*(${Q[ee.FULLPLAIN]})$|^$`);me("COMPARATORTRIM",`(\\s*)${Q[ee.GTLT]}\\s*(${Q[ee.LOOSEPLAIN]}|${Q[ee.XRANGEPLAIN]})`,!0);sr.comparatorTrimReplace="$1$2$3";me("HYPHENRANGE",`^\\s*(${Q[ee.XRANGEPLAIN]})\\s+-\\s+(${Q[ee.XRANGEPLAIN]})\\s*$`);me("HYPHENRANGELOOSE",`^\\s*(${Q[ee.XRANGEPLAINLOOSE]})\\s+-\\s+(${Q[ee.XRANGEPLAINLOOSE]})\\s*$`);me("STAR","(<|>)?=?\\s*\\*");me("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");me("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var nc=N((Sx,Av)=>{"use strict";var AS=Object.freeze({loose:!0}),jS=Object.freeze({}),HS=n=>n?typeof n!="object"?AS:n:jS;Av.exports=HS});var Uv=N((Tx,$v)=>{"use strict";var jv=/^[0-9]+$/,Hv=(n,e)=>{if(typeof n=="number"&&typeof e=="number")return n===e?0:n<e?-1:1;let t=jv.test(n),r=jv.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1},$S=(n,e)=>Hv(e,n);$v.exports={compareIdentifiers:Hv,rcompareIdentifiers:$S}});var oo=N((Ex,Wv)=>{"use strict";var rc=so(),{MAX_LENGTH:zv,MAX_SAFE_INTEGER:ic}=ec(),{safeRe:sc,t:oc}=tc(),US=nc(),{compareIdentifiers:qf}=Uv(),Af=class n{constructor(e,t){if(t=US(t),e instanceof n){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>zv)throw new TypeError(`version is longer than ${zv} characters`);rc("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let r=e.trim().match(t.loose?sc[oc.LOOSE]:sc[oc.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>ic||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ic||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ic||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let s=+i;if(s>=0&&s<ic)return s}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(rc("SemVer.compare",this.version,this.options,e),!(e instanceof n)){if(typeof e=="string"&&e===this.version)return 0;e=new n(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof n||(e=new n(e,this.options)),this.major<e.major?-1:this.major>e.major?1:this.minor<e.minor?-1:this.minor>e.minor?1:this.patch<e.patch?-1:this.patch>e.patch?1:0}comparePre(e){if(e instanceof n||(e=new n(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let r=this.prerelease[t],i=e.prerelease[t];if(rc("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return qf(r,i)}while(++t)}compareBuild(e){e instanceof n||(e=new n(e,this.options));let t=0;do{let r=this.build[t],i=e.build[t];if(rc("build compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return qf(r,i)}while(++t)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(t){let i=`-${t}`.match(this.options.loose?sc[oc.PRERELEASELOOSE]:sc[oc.PRERELEASE]);if(!i||i[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(r)?1:0;if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let s=[t,i];r===!1&&(s=[t]),qf(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Wv.exports=Af});var Gv=N((Rx,Kv)=>{"use strict";var Bv=oo(),zS=(n,e,t=!1)=>{if(n instanceof Bv)return n;try{return new Bv(n,e)}catch(r){if(!t)return null;throw r}};Kv.exports=zS});var Zv=N((Dx,Vv)=>{"use strict";var jf=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let i=this.map.keys().next().value;this.delete(i)}this.map.set(e,t)}return this}};Vv.exports=jf});var hi=N((xx,Jv)=>{"use strict";var Xv=oo(),WS=(n,e,t)=>new Xv(n,t).compare(new Xv(e,t));Jv.exports=WS});var Qv=N((Px,Yv)=>{"use strict";var BS=hi(),KS=(n,e,t)=>BS(n,e,t)===0;Yv.exports=KS});var tb=N((kx,eb)=>{"use strict";var GS=hi(),VS=(n,e,t)=>GS(n,e,t)!==0;eb.exports=VS});var rb=N((Ix,nb)=>{"use strict";var ZS=hi(),XS=(n,e,t)=>ZS(n,e,t)>0;nb.exports=XS});var sb=N((Ox,ib)=>{"use strict";var JS=hi(),YS=(n,e,t)=>JS(n,e,t)>=0;ib.exports=YS});var ab=N((Mx,ob)=>{"use strict";var QS=hi(),eT=(n,e,t)=>QS(n,e,t)<0;ob.exports=eT});var ub=N((Nx,cb)=>{"use strict";var tT=hi(),nT=(n,e,t)=>tT(n,e,t)<=0;cb.exports=nT});var db=N((Lx,lb)=>{"use strict";var rT=Qv(),iT=tb(),sT=rb(),oT=sb(),aT=ab(),cT=ub(),uT=(n,e,t,r)=>{switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return rT(n,t,r);case"!=":return iT(n,t,r);case">":return sT(n,t,r);case">=":return oT(n,t,r);case"<":return aT(n,t,r);case"<=":return cT(n,t,r);default:throw new TypeError(`Invalid operator: ${e}`)}};lb.exports=uT});var vb=N((Fx,yb)=>{"use strict";var ao=Symbol("SemVer ANY"),Uf=class n{static get ANY(){return ao}constructor(e,t){if(t=fb(t),e instanceof n){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),$f("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===ao?this.value="":this.value=this.operator+this.semver.version,$f("comp",this)}parse(e){let t=this.options.loose?hb[pb.COMPARATORLOOSE]:hb[pb.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new mb(r[2],this.options.loose):this.semver=ao}toString(){return this.value}test(e){if($f("Comparator.test",e,this.options.loose),this.semver===ao||e===ao)return!0;if(typeof e=="string")try{e=new mb(e,this.options)}catch{return!1}return Hf(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new gb(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new gb(this.value,t).test(e.semver):(t=fb(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||Hf(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||Hf(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};yb.exports=Uf;var fb=nc(),{safeRe:hb,t:pb}=tc(),Hf=db(),$f=so(),mb=oo(),gb=zf()});var zf=N((qx,_b)=>{"use strict";var lT=/\s+/g,Wf=class n{constructor(e,t){if(t=fT(t),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof Bf)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(lT," "),this.set=this.raw.split("||").map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(i=>!Cb(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&bT(i[0])){this.set=[i];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let r=0;r<t.length;r++)r>0&&(this.formatted+=" "),this.formatted+=t[r].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let r=((this.options.includePrerelease&&yT)|(this.options.loose&&vT))+":"+e,i=bb.get(r);if(i)return i;let s=this.options.loose,o=s?Xt[Wt.HYPHENRANGELOOSE]:Xt[Wt.HYPHENRANGE];e=e.replace(o,PT(this.options.includePrerelease)),Ye("hyphen replace",e),e=e.replace(Xt[Wt.COMPARATORTRIM],pT),Ye("comparator trim",e),e=e.replace(Xt[Wt.TILDETRIM],mT),Ye("tilde trim",e),e=e.replace(Xt[Wt.CARETTRIM],gT),Ye("caret trim",e);let a=e.split(" ").map(v=>CT(v,this.options)).join(" ").split(/\s+/).map(v=>xT(v,this.options));s&&(a=a.filter(v=>(Ye("loose invalid filter",v,this.options),!!v.match(Xt[Wt.COMPARATORLOOSE])))),Ye("range list",a);let c=new Map,u=a.map(v=>new Bf(v,this.options));for(let v of u){if(Cb(v))return[v];c.set(v.value,v)}c.size>1&&c.has("")&&c.delete("");let d=[...c.values()];return bb.set(r,d),d}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some(r=>wb(r,t)&&e.set.some(i=>wb(i,t)&&r.every(s=>i.every(o=>s.intersects(o,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new hT(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(kT(this.set[t],e,this.options))return!0;return!1}};_b.exports=Wf;var dT=Zv(),bb=new dT,fT=nc(),Bf=vb(),Ye=so(),hT=oo(),{safeRe:Xt,t:Wt,comparatorTrimReplace:pT,tildeTrimReplace:mT,caretTrimReplace:gT}=tc(),{FLAG_INCLUDE_PRERELEASE:yT,FLAG_LOOSE:vT}=ec(),Cb=n=>n.value==="<0.0.0-0",bT=n=>n.value==="",wb=(n,e)=>{let t=!0,r=n.slice(),i=r.pop();for(;t&&r.length;)t=r.every(s=>i.intersects(s,e)),i=r.pop();return t},CT=(n,e)=>(n=n.replace(Xt[Wt.BUILD],""),Ye("comp",n,e),n=ST(n,e),Ye("caret",n),n=wT(n,e),Ye("tildes",n),n=ET(n,e),Ye("xrange",n),n=DT(n,e),Ye("stars",n),n),Jt=n=>!n||n.toLowerCase()==="x"||n==="*",wT=(n,e)=>n.trim().split(/\s+/).map(t=>_T(t,e)).join(" "),_T=(n,e)=>{let t=e.loose?Xt[Wt.TILDELOOSE]:Xt[Wt.TILDE];return n.replace(t,(r,i,s,o,a)=>{Ye("tilde",n,r,i,s,o,a);let c;return Jt(i)?c="":Jt(s)?c=`>=${i}.0.0 <${+i+1}.0.0-0`:Jt(o)?c=`>=${i}.${s}.0 <${i}.${+s+1}.0-0`:a?(Ye("replaceTilde pr",a),c=`>=${i}.${s}.${o}-${a} <${i}.${+s+1}.0-0`):c=`>=${i}.${s}.${o} <${i}.${+s+1}.0-0`,Ye("tilde return",c),c})},ST=(n,e)=>n.trim().split(/\s+/).map(t=>TT(t,e)).join(" "),TT=(n,e)=>{Ye("caret",n,e);let t=e.loose?Xt[Wt.CARETLOOSE]:Xt[Wt.CARET],r=e.includePrerelease?"-0":"";return n.replace(t,(i,s,o,a,c)=>{Ye("caret",n,i,s,o,a,c);let u;return Jt(s)?u="":Jt(o)?u=`>=${s}.0.0${r} <${+s+1}.0.0-0`:Jt(a)?s==="0"?u=`>=${s}.${o}.0${r} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.0${r} <${+s+1}.0.0-0`:c?(Ye("replaceCaret pr",c),s==="0"?o==="0"?u=`>=${s}.${o}.${a}-${c} <${s}.${o}.${+a+1}-0`:u=`>=${s}.${o}.${a}-${c} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.${a}-${c} <${+s+1}.0.0-0`):(Ye("no pr"),s==="0"?o==="0"?u=`>=${s}.${o}.${a}${r} <${s}.${o}.${+a+1}-0`:u=`>=${s}.${o}.${a}${r} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.${a} <${+s+1}.0.0-0`),Ye("caret return",u),u})},ET=(n,e)=>(Ye("replaceXRanges",n,e),n.split(/\s+/).map(t=>RT(t,e)).join(" ")),RT=(n,e)=>{n=n.trim();let t=e.loose?Xt[Wt.XRANGELOOSE]:Xt[Wt.XRANGE];return n.replace(t,(r,i,s,o,a,c)=>{Ye("xRange",n,r,i,s,o,a,c);let u=Jt(s),d=u||Jt(o),v=d||Jt(a),b=v;return i==="="&&b&&(i=""),c=e.includePrerelease?"-0":"",u?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&b?(d&&(o=0),a=0,i===">"?(i=">=",d?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):i==="<="&&(i="<",d?s=+s+1:o=+o+1),i==="<"&&(c="-0"),r=`${i+s}.${o}.${a}${c}`):d?r=`>=${s}.0.0${c} <${+s+1}.0.0-0`:v&&(r=`>=${s}.${o}.0${c} <${s}.${+o+1}.0-0`),Ye("xRange return",r),r})},DT=(n,e)=>(Ye("replaceStars",n,e),n.trim().replace(Xt[Wt.STAR],"")),xT=(n,e)=>(Ye("replaceGTE0",n,e),n.trim().replace(Xt[e.includePrerelease?Wt.GTE0PRE:Wt.GTE0],"")),PT=n=>(e,t,r,i,s,o,a,c,u,d,v,b)=>(Jt(r)?t="":Jt(i)?t=`>=${r}.0.0${n?"-0":""}`:Jt(s)?t=`>=${r}.${i}.0${n?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${n?"-0":""}`,Jt(u)?c="":Jt(d)?c=`<${+u+1}.0.0-0`:Jt(v)?c=`<${u}.${+d+1}.0-0`:b?c=`<=${u}.${d}.${v}-${b}`:n?c=`<${u}.${d}.${+v+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),kT=(n,e,t)=>{for(let r=0;r<n.length;r++)if(!n[r].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let r=0;r<n.length;r++)if(Ye(n[r].semver),n[r].semver!==Bf.ANY&&n[r].semver.prerelease.length>0){let i=n[r].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var Tb=N((Ax,Sb)=>{"use strict";var IT=zf(),OT=(n,e,t)=>{try{e=new IT(e,t)}catch{return!1}return e.test(n)};Sb.exports=OT});var Rb=N(vn=>{"use strict";var MT=vn&&vn.__createBinding||(Object.create?(function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}):(function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]})),Kf=vn&&vn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&MT(e,n,t)};Object.defineProperty(vn,"__esModule",{value:!0});vn.DiagnosticPullMode=vn.vsdiag=void 0;Kf(de(),vn);Kf(Pe(),vn);var Eb=Jl();Object.defineProperty(vn,"vsdiag",{enumerable:!0,get:function(){return Eb.vsdiag}});Object.defineProperty(vn,"DiagnosticPullMode",{enumerable:!0,get:function(){return Eb.DiagnosticPullMode}});Kf(Mf(),vn)});var kb=N(cn=>{"use strict";var NT=cn&&cn.__createBinding||(Object.create?(function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}):(function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]})),Pb=cn&&cn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&NT(e,n,t)};Object.defineProperty(cn,"__esModule",{value:!0});cn.SettingMonitor=cn.LanguageClient=cn.TransportKind=void 0;var Cr=require("child_process"),Gf=require("fs"),Vf=require("path"),Br=require("vscode"),nt=_n(),Db=Mf(),LT=Mv(),st=Nf(),FT=Gv(),qT=Tb();Pb(Nf(),cn);Pb(Rb(),cn);var xb="^1.82.0",ot;(function(n){n[n.stdio=0]="stdio",n[n.ipc=1]="ipc",n[n.pipe=2]="pipe",n[n.socket=3]="socket"})(ot||(cn.TransportKind=ot={}));var Wr;(function(n){function e(t){let r=t;return r&&r.kind===ot.socket&&nt.number(r.port)}n.isSocket=e})(Wr||(Wr={}));var Zf;(function(n){function e(t){return nt.string(t.command)}n.is=e})(Zf||(Zf={}));var Xf;(function(n){function e(t){return nt.string(t.module)}n.is=e})(Xf||(Xf={}));var Jf;(function(n){function e(t){let r=t;return r&&r.writer!==void 0&&r.reader!==void 0}n.is=e})(Jf||(Jf={}));var Yf;(function(n){function e(t){let r=t;return r&&r.process!==void 0&&typeof r.detached=="boolean"}n.is=e})(Yf||(Yf={}));var Qf=class extends Db.BaseLanguageClient{constructor(e,t,r,i,s){let o,a,c,u,d;nt.string(t)?(o=e,a=t,c=r,u=i,d=!!s):(o=e.toLowerCase(),a=e,c=t,u=r,d=i),d===void 0&&(d=!1),super(o,a,u),this._serverOptions=c,this._forceDebug=d,this._isInDebugMode=d;try{this.checkVersion()}catch(v){throw nt.string(v.message)&&this.outputChannel.appendLine(v.message),v}}checkVersion(){let e=FT(Br.version);if(!e)throw new Error(`No valid VS Code version detected. Version string is: ${Br.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!qT(e,xb))throw new Error(`The language client requires VS Code version ${xb} but received version ${Br.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode?(await new Promise(e=>setTimeout(e,1e3)),await this.start()):await this.start()}stop(e=2e3){return super.stop(e).finally(()=>{if(this._serverProcess){let t=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(t),this._isDetached=void 0}})}checkProcessDied(e){!e||e.pid===void 0||setTimeout(()=>{try{e.pid!==void 0&&(process.kill(e.pid,0),(0,LT.terminate)(e))}catch{}},2e3)}handleConnectionClosed(){return this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function t(d,v){if(!d&&!v)return;let b=Object.create(null);return Object.keys(process.env).forEach(g=>b[g]=process.env[g]),v&&(b.ELECTRON_RUN_AS_NODE="1",b.ELECTRON_NO_ASAR="1"),d&&Object.keys(d).forEach(g=>b[g]=d[g]),b}let r=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],i=["--debug","--debug-brk","--inspect","--inspect-brk"];function s(){let d=process.execArgv;return d?d.some(v=>r.some(b=>v.startsWith(b))||i.some(b=>v===b)):!1}function o(d){if(d.stdin===null||d.stdout===null||d.stderr===null)throw new Error("Process created without stdio streams")}let a=this._serverOptions;if(nt.func(a))return a().then(d=>{if(Db.MessageTransports.is(d))return this._isDetached=!!d.detached,d;if(Jf.is(d))return this._isDetached=!!d.detached,{reader:new st.StreamMessageReader(d.reader),writer:new st.StreamMessageWriter(d.writer)};{let v;return Yf.is(d)?(v=d.process,this._isDetached=d.detached):(v=d,this._isDetached=!1),v.stderr.on("data",b=>this.outputChannel.append(nt.string(b)?b:b.toString(e))),{reader:new st.StreamMessageReader(v.stdout),writer:new st.StreamMessageWriter(v.stdin)}}});let c,u=a;return u.run||u.debug?this._forceDebug||s()?(c=u.debug,this._isInDebugMode=!0):(c=u.run,this._isInDebugMode=!1):c=a,this._getServerWorkingDir(c.options).then(d=>{if(Xf.is(c)&&c.module){let v=c,b=v.transport||ot.stdio;if(v.runtime){let g=[],h=v.options??Object.create(null);h.execArgv&&h.execArgv.forEach(k=>g.push(k)),g.push(v.module),v.args&&v.args.forEach(k=>g.push(k));let w=Object.create(null);w.cwd=d,w.env=t(h.env,!1);let _=this._getRuntimePath(v.runtime,d),D;if(b===ot.ipc?(w.stdio=[null,null,null,"ipc"],g.push("--node-ipc")):b===ot.stdio?g.push("--stdio"):b===ot.pipe?(D=(0,st.generateRandomPipeName)(),g.push(`--pipe=${D}`)):Wr.isSocket(b)&&g.push(`--socket=${b.port}`),g.push(`--clientProcessId=${process.pid.toString()}`),b===ot.ipc||b===ot.stdio){let k=Cr.spawn(_,g,w);return!k||!k.pid?ds(k,`Launching server using runtime ${_} failed.`):(this._serverProcess=k,k.stderr.on("data",y=>this.outputChannel.append(nt.string(y)?y:y.toString(e))),b===ot.ipc?(k.stdout.on("data",y=>this.outputChannel.append(nt.string(y)?y:y.toString(e))),Promise.resolve({reader:new st.IPCMessageReader(k),writer:new st.IPCMessageWriter(k)})):Promise.resolve({reader:new st.StreamMessageReader(k.stdout),writer:new st.StreamMessageWriter(k.stdin)}))}else{if(b===ot.pipe)return(0,st.createClientPipeTransport)(D).then(k=>{let y=Cr.spawn(_,g,w);return!y||!y.pid?ds(y,`Launching server using runtime ${_} failed.`):(this._serverProcess=y,y.stderr.on("data",x=>this.outputChannel.append(nt.string(x)?x:x.toString(e))),y.stdout.on("data",x=>this.outputChannel.append(nt.string(x)?x:x.toString(e))),k.onConnected().then(x=>({reader:x[0],writer:x[1]})))});if(Wr.isSocket(b))return(0,st.createClientSocketTransport)(b.port).then(k=>{let y=Cr.spawn(_,g,w);return!y||!y.pid?ds(y,`Launching server using runtime ${_} failed.`):(this._serverProcess=y,y.stderr.on("data",x=>this.outputChannel.append(nt.string(x)?x:x.toString(e))),y.stdout.on("data",x=>this.outputChannel.append(nt.string(x)?x:x.toString(e))),k.onConnected().then(x=>({reader:x[0],writer:x[1]})))})}}else{let g;return new Promise((h,w)=>{let _=(v.args&&v.args.slice())??[];b===ot.ipc?_.push("--node-ipc"):b===ot.stdio?_.push("--stdio"):b===ot.pipe?(g=(0,st.generateRandomPipeName)(),_.push(`--pipe=${g}`)):Wr.isSocket(b)&&_.push(`--socket=${b.port}`),_.push(`--clientProcessId=${process.pid.toString()}`);let D=v.options??Object.create(null);if(D.env=t(D.env,!0),D.execArgv=D.execArgv||[],D.cwd=d,D.silent=!0,b===ot.ipc||b===ot.stdio){let k=Cr.fork(v.module,_||[],D);o(k),this._serverProcess=k,k.stderr.on("data",y=>this.outputChannel.append(nt.string(y)?y:y.toString(e))),b===ot.ipc?(k.stdout.on("data",y=>this.outputChannel.append(nt.string(y)?y:y.toString(e))),h({reader:new st.IPCMessageReader(this._serverProcess),writer:new st.IPCMessageWriter(this._serverProcess)})):h({reader:new st.StreamMessageReader(k.stdout),writer:new st.StreamMessageWriter(k.stdin)})}else b===ot.pipe?(0,st.createClientPipeTransport)(g).then(k=>{let y=Cr.fork(v.module,_||[],D);o(y),this._serverProcess=y,y.stderr.on("data",x=>this.outputChannel.append(nt.string(x)?x:x.toString(e))),y.stdout.on("data",x=>this.outputChannel.append(nt.string(x)?x:x.toString(e))),k.onConnected().then(x=>{h({reader:x[0],writer:x[1]})},w)},w):Wr.isSocket(b)&&(0,st.createClientSocketTransport)(b.port).then(k=>{let y=Cr.fork(v.module,_||[],D);o(y),this._serverProcess=y,y.stderr.on("data",x=>this.outputChannel.append(nt.string(x)?x:x.toString(e))),y.stdout.on("data",x=>this.outputChannel.append(nt.string(x)?x:x.toString(e))),k.onConnected().then(x=>{h({reader:x[0],writer:x[1]})},w)},w)})}}else if(Zf.is(c)&&c.command){let v=c,b=c.args!==void 0?c.args.slice(0):[],g,h=c.transport;if(h===ot.stdio)b.push("--stdio");else if(h===ot.pipe)g=(0,st.generateRandomPipeName)(),b.push(`--pipe=${g}`);else if(Wr.isSocket(h))b.push(`--socket=${h.port}`);else if(h===ot.ipc)throw new Error("Transport kind ipc is not support for command executable");let w=Object.assign({},v.options);if(w.cwd=w.cwd||d,h===void 0||h===ot.stdio){let _=Cr.spawn(v.command,b,w);return!_||!_.pid?ds(_,`Launching server using command ${v.command} failed.`):(_.stderr.on("data",D=>this.outputChannel.append(nt.string(D)?D:D.toString(e))),this._serverProcess=_,this._isDetached=!!w.detached,Promise.resolve({reader:new st.StreamMessageReader(_.stdout),writer:new st.StreamMessageWriter(_.stdin)}))}else{if(h===ot.pipe)return(0,st.createClientPipeTransport)(g).then(_=>{let D=Cr.spawn(v.command,b,w);return!D||!D.pid?ds(D,`Launching server using command ${v.command} failed.`):(this._serverProcess=D,this._isDetached=!!w.detached,D.stderr.on("data",k=>this.outputChannel.append(nt.string(k)?k:k.toString(e))),D.stdout.on("data",k=>this.outputChannel.append(nt.string(k)?k:k.toString(e))),_.onConnected().then(k=>({reader:k[0],writer:k[1]})))});if(Wr.isSocket(h))return(0,st.createClientSocketTransport)(h.port).then(_=>{let D=Cr.spawn(v.command,b,w);return!D||!D.pid?ds(D,`Launching server using command ${v.command} failed.`):(this._serverProcess=D,this._isDetached=!!w.detached,D.stderr.on("data",k=>this.outputChannel.append(nt.string(k)?k:k.toString(e))),D.stdout.on("data",k=>this.outputChannel.append(nt.string(k)?k:k.toString(e))),_.onConnected().then(k=>({reader:k[0],writer:k[1]})))})}}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(a,null,4)))}).finally(()=>{this._serverProcess!==void 0&&this._serverProcess.on("exit",(d,v)=>{d!==null&&this.error(`Server process exited with code ${d}.`,void 0,!1),v!==null&&this.error(`Server process exited with signal ${v}.`,void 0,!1)})})}_getRuntimePath(e,t){if(Vf.isAbsolute(e))return e;let r=this._mainGetRootPath();if(r!==void 0){let i=Vf.join(r,e);if(Gf.existsSync(i))return i}if(t!==void 0){let i=Vf.join(t,e);if(Gf.existsSync(i))return i}return e}_mainGetRootPath(){let e=Br.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(r=>{Gf.lstat(t,(i,s)=>{r(!i&&s.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}};cn.LanguageClient=Qf;var eh=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return Br.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new Br.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,r=e>=0?this._setting.substr(e+1):void 0,i=r?Br.workspace.getConfiguration(t).get(r,!1):Br.workspace.getConfiguration(t);i&&this._client.needsStart()?this._client.start().catch(s=>this._client.error("Start failed after configuration change",s,"force")):!i&&this._client.needsStop()&&this._client.stop().catch(s=>this._client.error("Stop failed after configuration change",s,"force"))}};cn.SettingMonitor=eh;function ds(n,e){return n===null?Promise.reject(e):new Promise((t,r)=>{n.on("error",i=>{r(`${e} ${i}`)}),setImmediate(()=>r(e))})}});var Ob=N(($x,Ib)=>{"use strict";Ib.exports=kb()});var sh=N((EP,Zb)=>{Zb.exports={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,END64HDR:20,END64SIG:117853008,END64START:4,END64OFF:8,END64NUMDISKS:16,ZIP64SIG:101075792,ZIP64HDR:56,ZIP64LEAD:12,ZIP64SIZE:4,ZIP64VEM:12,ZIP64VER:14,ZIP64DSK:16,ZIP64DSKDIR:20,ZIP64SUB:24,ZIP64TOT:32,ZIP64SIZB:40,ZIP64OFF:48,ZIP64EXTRA:56,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,AES_ENCRYPT:99,FLG_ENC:1,FLG_COMP1:2,FLG_COMP2:4,FLG_DESC:8,FLG_ENH:16,FLG_PATCH:32,FLG_STR:64,FLG_EFS:2048,FLG_MSK:4096,FILE:2,BUFFER:1,NONE:0,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535,EF_ZIP64_SUNCOMP:0,EF_ZIP64_SCOMP:8,EF_ZIP64_RHO:16,EF_ZIP64_DSN:24}});var hc=N(Jb=>{var Xb={INVALID_LOC:"Invalid LOC header (bad signature)",INVALID_CEN:"Invalid CEN header (bad signature)",INVALID_END:"Invalid END header (bad signature)",DESCRIPTOR_NOT_EXIST:"No descriptor present",DESCRIPTOR_UNKNOWN:"Unknown descriptor format",DESCRIPTOR_FAULTY:"Descriptor data is malformed",NO_DATA:"Nothing to decompress",BAD_CRC:"CRC32 checksum failed {0}",FILE_IN_THE_WAY:"There is a file in the way: {0}",UNKNOWN_METHOD:"Invalid/unsupported compression method",AVAIL_DATA:"inflate::Available inflate data did not terminate",INVALID_DISTANCE:"inflate::Invalid literal/length or distance code in fixed or dynamic block",TO_MANY_CODES:"inflate::Dynamic block code description: too many length or distance codes",INVALID_REPEAT_LEN:"inflate::Dynamic block code description: repeat more than specified lengths",INVALID_REPEAT_FIRST:"inflate::Dynamic block code description: repeat lengths with no first length",INCOMPLETE_CODES:"inflate::Dynamic block code description: code lengths codes incomplete",INVALID_DYN_DISTANCE:"inflate::Dynamic block code description: invalid distance code lengths",INVALID_CODES_LEN:"inflate::Dynamic block code description: invalid literal/length code lengths",INVALID_STORE_BLOCK:"inflate::Stored block length did not match one's complement",INVALID_BLOCK_TYPE:"inflate::Invalid block type (type == 3)",CANT_EXTRACT_FILE:"Could not extract the file",CANT_OVERRIDE:"Target file already exists",DISK_ENTRY_TOO_LARGE:"Number of disk entries is too large",NO_ZIP:"No zip file was loaded",NO_ENTRY:"Entry doesn't exist",DIRECTORY_CONTENT_ERROR:"A directory cannot have content",FILE_NOT_FOUND:'File not found: "{0}"',NOT_IMPLEMENTED:"Not implemented",INVALID_FILENAME:"Invalid filename",INVALID_FORMAT:"Invalid or unsupported zip format. No END header found",INVALID_PASS_PARAM:"Incompatible password parameter",WRONG_PASSWORD:"Wrong Password",COMMENT_TOO_LONG:"Comment is too long",EXTRA_FIELD_PARSE_ERROR:"Extra field parsing error"};function XE(n){return function(...e){return e.length&&(n=n.replace(/\{(\d)\}/g,(t,r)=>e[r]||"")),new Error("ADM-ZIP: "+n)}}for(let n of Object.keys(Xb))Jb[n]=XE(Xb[n])});var nC=N((DP,tC)=>{var JE=require("fs"),Et=require("path"),Yb=sh(),YE=hc(),QE=typeof process=="object"&&process.platform==="win32",Qb=n=>typeof n=="object"&&n!==null,eC=new Uint32Array(256).map((n,e)=>{for(let t=0;t<8;t++)(e&1)!==0?e=3988292384^e>>>1:e>>>=1;return e>>>0});function pt(n){this.sep=Et.sep,this.fs=JE,Qb(n)&&Qb(n.fs)&&typeof n.fs.statSync=="function"&&(this.fs=n.fs)}tC.exports=pt;pt.prototype.makeDir=function(n){let e=this;function t(r){let i=r.split(e.sep)[0];r.split(e.sep).forEach(function(s){if(!(!s||s.substr(-1,1)===":")){i+=e.sep+s;var o;try{o=e.fs.statSync(i)}catch{e.fs.mkdirSync(i)}if(o&&o.isFile())throw YE.FILE_IN_THE_WAY(`"${i}"`)}})}t(n)};pt.prototype.writeFileTo=function(n,e,t,r){let i=this;if(i.fs.existsSync(n)){if(!t)return!1;var s=i.fs.statSync(n);if(s.isDirectory())return!1}var o=Et.dirname(n);i.fs.existsSync(o)||i.makeDir(o);var a;try{a=i.fs.openSync(n,"w",438)}catch{i.fs.chmodSync(n,438),a=i.fs.openSync(n,"w",438)}if(a)try{i.fs.writeSync(a,e,0,e.length,0)}finally{i.fs.closeSync(a)}return i.fs.chmodSync(n,r||438),!0};pt.prototype.writeFileToAsync=function(n,e,t,r,i){typeof r=="function"&&(i=r,r=void 0);let s=this;s.fs.exists(n,function(o){if(o&&!t)return i(!1);s.fs.stat(n,function(a,c){if(o&&c.isDirectory())return i(!1);var u=Et.dirname(n);s.fs.exists(u,function(d){d||s.makeDir(u),s.fs.open(n,"w",438,function(v,b){v?s.fs.chmod(n,438,function(){s.fs.open(n,"w",438,function(g,h){s.fs.write(h,e,0,e.length,0,function(){s.fs.close(h,function(){s.fs.chmod(n,r||438,function(){i(!0)})})})})}):b?s.fs.write(b,e,0,e.length,0,function(){s.fs.close(b,function(){s.fs.chmod(n,r||438,function(){i(!0)})})}):s.fs.chmod(n,r||438,function(){i(!0)})})})})})};pt.prototype.findFiles=function(n){let e=this;function t(r,i,s){typeof i=="boolean"&&(s=i,i=void 0);let o=[];return e.fs.readdirSync(r).forEach(function(a){let c=Et.join(r,a),u=e.fs.statSync(c);(!i||i.test(c))&&o.push(Et.normalize(c)+(u.isDirectory()?e.sep:"")),u.isDirectory()&&s&&(o=o.concat(t(c,i,s)))}),o}return t(n,void 0,!0)};pt.prototype.findFilesAsync=function(n,e){let t=this,r=[];t.fs.readdir(n,function(i,s){if(i)return e(i);let o=s.length;if(!o)return e(null,r);s.forEach(function(a){a=Et.join(n,a),t.fs.stat(a,function(c,u){if(c)return e(c);u&&(r.push(Et.normalize(a)+(u.isDirectory()?t.sep:"")),u.isDirectory()?t.findFilesAsync(a,function(d,v){if(d)return e(d);r=r.concat(v),--o||e(null,r)}):--o||e(null,r))})})})};pt.prototype.getAttributes=function(){};pt.prototype.setAttributes=function(){};pt.crc32update=function(n,e){return eC[(n^e)&255]^n>>>8};pt.crc32=function(n){typeof n=="string"&&(n=Buffer.from(n,"utf8"));let e=n.length,t=-1;for(let r=0;r<e;)t=pt.crc32update(t,n[r++]);return~t>>>0};pt.methodToString=function(n){switch(n){case Yb.STORED:return"STORED ("+n+")";case Yb.DEFLATED:return"DEFLATED ("+n+")";default:return"UNSUPPORTED ("+n+")"}};pt.canonical=function(n){if(!n)return"";let e=Et.posix.normalize("/"+n.split("\\").join("/"));return Et.join(".",e)};pt.zipnamefix=function(n){if(!n)return"";let e=Et.posix.normalize("/"+n.split("\\").join("/"));return Et.posix.join(".",e)};pt.findLast=function(n,e){if(!Array.isArray(n))throw new TypeError("arr is not array");let t=n.length>>>0;for(let r=t-1;r>=0;r--)if(e(n[r],r,n))return n[r]};pt.sanitize=function(n,e){n=Et.resolve(Et.normalize(n));for(var t=e.split("/"),r=0,i=t.length;r<i;r++){var s=Et.normalize(Et.join(n,t.slice(r,i).join(Et.sep)));if(s.indexOf(n)===0)return s}return Et.normalize(Et.join(n,Et.basename(e)))};pt.toBuffer=function(e,t){return Buffer.isBuffer(e)?e:e instanceof Uint8Array?Buffer.from(e):typeof e=="string"?t(e):Buffer.alloc(0)};pt.readBigUInt64LE=function(n,e){var t=Buffer.from(n.slice(e,e+8));return t.swap64(),parseInt(`0x${t.toString("hex")}`)};pt.fromDOS2Date=function(n){return new Date((n>>25&127)+1980,Math.max((n>>21&15)-1,0),Math.max(n>>16&31,1),n>>11&31,n>>5&63,(n&31)<<1)};pt.fromDate2DOS=function(n){let e=0,t=0;return n.getFullYear()>1979&&(e=(n.getFullYear()-1980&127)<<9|n.getMonth()+1<<5|n.getDate(),t=n.getHours()<<11|n.getMinutes()<<5|n.getSeconds()>>1),e<<16|t};pt.isWin=QE;pt.crcTable=eC});var iC=N((xP,rC)=>{var eR=require("path");rC.exports=function(n,{fs:e}){var t=n||"",r=s(),i=null;function s(){return{directory:!1,readonly:!1,hidden:!1,executable:!1,mtime:0,atime:0}}return t&&e.existsSync(t)?(i=e.statSync(t),r.directory=i.isDirectory(),r.mtime=i.mtime,r.atime=i.atime,r.executable=(73&i.mode)!==0,r.readonly=(128&i.mode)===0,r.hidden=eR.basename(t)[0]==="."):console.warn("Invalid path: "+t),{get directory(){return r.directory},get readOnly(){return r.readonly},get hidden(){return r.hidden},get mtime(){return r.mtime},get atime(){return r.atime},get executable(){return r.executable},decodeAttributes:function(){},encodeAttributes:function(){},toJSON:function(){return{path:t,isDirectory:r.directory,isReadOnly:r.readonly,isHidden:r.hidden,isExecutable:r.executable,mTime:r.mtime,aTime:r.atime}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var oC=N((PP,sC)=>{sC.exports={efs:!0,encode:n=>Buffer.from(n,"utf8"),decode:n=>n.toString("utf8")}});var ws=N((kP,Cs)=>{Cs.exports=nC();Cs.exports.Constants=sh();Cs.exports.Errors=hc();Cs.exports.FileAttr=iC();Cs.exports.decoder=oC()});var cC=N((IP,aC)=>{var Xr=ws(),J=Xr.Constants;aC.exports=function(){var n=20,e=10,t=0,r=0,i=0,s=0,o=0,a=0,c=0,u=0,d=0,v=0,b=0,g=0,h=0;n|=Xr.isWin?2560:768,t|=J.FLG_EFS;let w={extraLen:0},_=y=>Math.max(0,y)>>>0,D=y=>Math.max(0,y)&65535,k=y=>Math.max(0,y)&255;return i=Xr.fromDate2DOS(new Date),{get made(){return n},set made(y){n=y},get version(){return e},set version(y){e=y},get flags(){return t},set flags(y){t=y},get flags_efs(){return(t&J.FLG_EFS)>0},set flags_efs(y){y?t|=J.FLG_EFS:t&=~J.FLG_EFS},get flags_desc(){return(t&J.FLG_DESC)>0},set flags_desc(y){y?t|=J.FLG_DESC:t&=~J.FLG_DESC},get method(){return r},set method(y){switch(y){case J.STORED:this.version=10;case J.DEFLATED:default:this.version=20}r=y},get time(){return Xr.fromDOS2Date(this.timeval)},set time(y){this.timeval=Xr.fromDate2DOS(y)},get timeval(){return i},set timeval(y){i=_(y)},get timeHighByte(){return k(i>>>8)},get crc(){return s},set crc(y){s=_(y)},get compressedSize(){return o},set compressedSize(y){o=_(y)},get size(){return a},set size(y){a=_(y)},get fileNameLength(){return c},set fileNameLength(y){c=y},get extraLength(){return u},set extraLength(y){u=y},get extraLocalLength(){return w.extraLen},set extraLocalLength(y){w.extraLen=y},get commentLength(){return d},set commentLength(y){d=y},get diskNumStart(){return v},set diskNumStart(y){v=_(y)},get inAttr(){return b},set inAttr(y){b=_(y)},get attr(){return g},set attr(y){g=_(y)},get fileAttr(){return(g||0)>>16&4095},get offset(){return h},set offset(y){h=_(y)},get encrypted(){return(t&J.FLG_ENC)===J.FLG_ENC},get centralHeaderSize(){return J.CENHDR+c+u+d},get realDataOffset(){return h+J.LOCHDR+w.fnameLen+w.extraLen},get localHeader(){return w},loadLocalHeaderFromBinary:function(y){var x=y.slice(h,h+J.LOCHDR);if(x.readUInt32LE(0)!==J.LOCSIG)throw Xr.Errors.INVALID_LOC();w.version=x.readUInt16LE(J.LOCVER),w.flags=x.readUInt16LE(J.LOCFLG),w.method=x.readUInt16LE(J.LOCHOW),w.time=x.readUInt32LE(J.LOCTIM),w.crc=x.readUInt32LE(J.LOCCRC),w.compressedSize=x.readUInt32LE(J.LOCSIZ),w.size=x.readUInt32LE(J.LOCLEN),w.fnameLen=x.readUInt16LE(J.LOCNAM),w.extraLen=x.readUInt16LE(J.LOCEXT);let O=h+J.LOCHDR+w.fnameLen,U=O+w.extraLen;return y.slice(O,U)},loadFromBinary:function(y){if(y.length!==J.CENHDR||y.readUInt32LE(0)!==J.CENSIG)throw Xr.Errors.INVALID_CEN();n=y.readUInt16LE(J.CENVEM),e=y.readUInt16LE(J.CENVER),t=y.readUInt16LE(J.CENFLG),r=y.readUInt16LE(J.CENHOW),i=y.readUInt32LE(J.CENTIM),s=y.readUInt32LE(J.CENCRC),o=y.readUInt32LE(J.CENSIZ),a=y.readUInt32LE(J.CENLEN),c=y.readUInt16LE(J.CENNAM),u=y.readUInt16LE(J.CENEXT),d=y.readUInt16LE(J.CENCOM),v=y.readUInt16LE(J.CENDSK),b=y.readUInt16LE(J.CENATT),g=y.readUInt32LE(J.CENATX),h=y.readUInt32LE(J.CENOFF)},localHeaderToBinary:function(){var y=Buffer.alloc(J.LOCHDR);return y.writeUInt32LE(J.LOCSIG,0),y.writeUInt16LE(e,J.LOCVER),y.writeUInt16LE(t,J.LOCFLG),y.writeUInt16LE(r,J.LOCHOW),y.writeUInt32LE(i,J.LOCTIM),y.writeUInt32LE(s,J.LOCCRC),y.writeUInt32LE(o,J.LOCSIZ),y.writeUInt32LE(a,J.LOCLEN),y.writeUInt16LE(c,J.LOCNAM),y.writeUInt16LE(w.extraLen,J.LOCEXT),y},centralHeaderToBinary:function(){var y=Buffer.alloc(J.CENHDR+c+u+d);return y.writeUInt32LE(J.CENSIG,0),y.writeUInt16LE(n,J.CENVEM),y.writeUInt16LE(e,J.CENVER),y.writeUInt16LE(t,J.CENFLG),y.writeUInt16LE(r,J.CENHOW),y.writeUInt32LE(i,J.CENTIM),y.writeUInt32LE(s,J.CENCRC),y.writeUInt32LE(o,J.CENSIZ),y.writeUInt32LE(a,J.CENLEN),y.writeUInt16LE(c,J.CENNAM),y.writeUInt16LE(u,J.CENEXT),y.writeUInt16LE(d,J.CENCOM),y.writeUInt16LE(v,J.CENDSK),y.writeUInt16LE(b,J.CENATT),y.writeUInt32LE(g,J.CENATX),y.writeUInt32LE(h,J.CENOFF),y},toJSON:function(){let y=function(x){return x+" bytes"};return{made:n,version:e,flags:t,method:Xr.methodToString(r),time:this.time,crc:"0x"+s.toString(16).toUpperCase(),compressedSize:y(o),size:y(a),fileNameLength:y(c),extraLength:y(u),commentLength:y(d),diskNumStart:v,inAttr:b,attr:g,offset:h,centralHeaderSize:y(J.CENHDR+c+u+d)}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var lC=N((OP,uC)=>{var _s=ws(),at=_s.Constants;uC.exports=function(){var n=0,e=0,t=0,r=0,i=0;return{get diskEntries(){return n},set diskEntries(s){n=e=s},get totalEntries(){return e},set totalEntries(s){e=n=s},get size(){return t},set size(s){t=s},get offset(){return r},set offset(s){r=s},get commentLength(){return i},set commentLength(s){i=s},get mainHeaderSize(){return at.ENDHDR+i},loadFromBinary:function(s){if((s.length!==at.ENDHDR||s.readUInt32LE(0)!==at.ENDSIG)&&(s.length<at.ZIP64HDR||s.readUInt32LE(0)!==at.ZIP64SIG))throw _s.Errors.INVALID_END();s.readUInt32LE(0)===at.ENDSIG?(n=s.readUInt16LE(at.ENDSUB),e=s.readUInt16LE(at.ENDTOT),t=s.readUInt32LE(at.ENDSIZ),r=s.readUInt32LE(at.ENDOFF),i=s.readUInt16LE(at.ENDCOM)):(n=_s.readBigUInt64LE(s,at.ZIP64SUB),e=_s.readBigUInt64LE(s,at.ZIP64TOT),t=_s.readBigUInt64LE(s,at.ZIP64SIZE),r=_s.readBigUInt64LE(s,at.ZIP64OFF),i=0)},toBinary:function(){var s=Buffer.alloc(at.ENDHDR+i);return s.writeUInt32LE(at.ENDSIG,0),s.writeUInt32LE(0,4),s.writeUInt16LE(n,at.ENDSUB),s.writeUInt16LE(e,at.ENDTOT),s.writeUInt32LE(t,at.ENDSIZ),s.writeUInt32LE(r,at.ENDOFF),s.writeUInt16LE(i,at.ENDCOM),s.fill(" ",at.ENDHDR),s},toJSON:function(){let s=function(o,a){let c=o.toString(16).toUpperCase();for(;c.length<a;)c="0"+c;return"0x"+c};return{diskEntries:n,totalEntries:e,size:t+" bytes",offset:s(r,4),commentLength:i}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var ah=N(oh=>{oh.EntryHeader=cC();oh.MainHeader=lC()});var fC=N((NP,dC)=>{dC.exports=function(n){var e=require("zlib"),t={chunkSize:(parseInt(n.length/1024)+1)*1024};return{deflate:function(){return e.deflateRawSync(n,t)},deflateAsync:function(r){var i=e.createDeflateRaw(t),s=[],o=0;i.on("data",function(a){s.push(a),o+=a.length}),i.on("end",function(){var a=Buffer.alloc(o),c=0;a.fill(0);for(var u=0;u<s.length;u++){var d=s[u];d.copy(a,c),c+=d.length}r&&r(a)}),i.end(n)}}}});var pC=N((LP,hC)=>{var tR=+(process.versions?process.versions.node:"").split(".")[0]||0;hC.exports=function(n,e){var t=require("zlib");let r=tR>=15&&e>0?{maxOutputLength:e}:{};return{inflate:function(){return t.inflateRawSync(n,r)},inflateAsync:function(i){var s=t.createInflateRaw(r),o=[],a=0;s.on("data",function(c){o.push(c),a+=c.length}),s.on("end",function(){var c=Buffer.alloc(a),u=0;c.fill(0);for(var d=0;d<o.length;d++){var v=o[d];v.copy(c,u),u+=v.length}i&&i(c)}),s.end(n)}}}});var bC=N((FP,vC)=>{"use strict";var{randomFillSync:mC}=require("crypto"),nR=hc(),rR=new Uint32Array(256).map((n,e)=>{for(let t=0;t<8;t++)(e&1)!==0?e=e>>>1^3988292384:e>>>=1;return e>>>0}),yC=(n,e)=>Math.imul(n,e)>>>0,gC=(n,e)=>rR[(n^e)&255]^n>>>8,ho=()=>typeof mC=="function"?mC(Buffer.alloc(12)):ho.node();ho.node=()=>{let n=Buffer.alloc(12),e=n.length;for(let t=0;t<e;t++)n[t]=Math.random()*256&255;return n};var pc={genSalt:ho};function mc(n){let e=Buffer.isBuffer(n)?n:Buffer.from(n);this.keys=new Uint32Array([305419896,591751049,878082192]);for(let t=0;t<e.length;t++)this.updateKeys(e[t])}mc.prototype.updateKeys=function(n){let e=this.keys;return e[0]=gC(e[0],n),e[1]+=e[0]&255,e[1]=yC(e[1],134775813)+1,e[2]=gC(e[2],e[1]>>>24),n};mc.prototype.next=function(){let n=(this.keys[2]|2)>>>0;return yC(n,n^1)>>8&255};function iR(n){let e=new mc(n);return function(t){let r=Buffer.alloc(t.length),i=0;for(let s of t)r[i++]=e.updateKeys(s^e.next());return r}}function sR(n){let e=new mc(n);return function(t,r,i=0){r||(r=Buffer.alloc(t.length));for(let s of t){let o=e.next();r[i++]=s^o,e.updateKeys(s)}return r}}function oR(n,e,t){if(!n||!Buffer.isBuffer(n)||n.length<12)return Buffer.alloc(0);let r=iR(t),i=r(n.slice(0,12)),s=(e.flags&8)===8?e.timeHighByte:e.crc>>>24;if(i[11]!==s)throw nR.WRONG_PASSWORD();return r(n.slice(12))}function aR(n){Buffer.isBuffer(n)&&n.length>=12?pc.genSalt=function(){return n.slice(0,12)}:n==="node"?pc.genSalt=ho.node:pc.genSalt=ho}function cR(n,e,t,r=!1){n==null&&(n=Buffer.alloc(0)),Buffer.isBuffer(n)||(n=Buffer.from(n.toString()));let i=sR(t),s=pc.genSalt();s[11]=e.crc>>>24&255,r&&(s[10]=e.crc>>>16&255);let o=Buffer.alloc(n.length+12);return i(s,o),i(n,o,12)}vC.exports={decrypt:oR,encrypt:cR,_salter:aR}});var CC=N(gc=>{gc.Deflater=fC();gc.Inflater=pC();gc.ZipCrypto=bC()});var uh=N((AP,wC)=>{var $e=ws(),uR=ah(),mt=$e.Constants,ch=CC();wC.exports=function(n,e){var t=new uR.EntryHeader,r=Buffer.alloc(0),i=Buffer.alloc(0),s=!1,o=null,a=Buffer.alloc(0),c=Buffer.alloc(0),u=!0;let d=n,v=typeof d.decoder=="object"?d.decoder:$e.decoder;u=v.hasOwnProperty("efs")?v.efs:!1;function b(){return!e||!(e instanceof Uint8Array)?Buffer.alloc(0):(c=t.loadLocalHeaderFromBinary(e),e.slice(t.realDataOffset,t.realDataOffset+t.compressedSize))}function g(y){if(t.flags_desc){let x={},O=t.realDataOffset+t.compressedSize;if(e.readUInt32LE(O)==mt.LOCSIG||e.readUInt32LE(O)==mt.CENSIG)throw $e.Errors.DESCRIPTOR_NOT_EXIST();if(e.readUInt32LE(O)==mt.EXTSIG)x.crc=e.readUInt32LE(O+mt.EXTCRC),x.compressedSize=e.readUInt32LE(O+mt.EXTSIZ),x.size=e.readUInt32LE(O+mt.EXTLEN);else if(e.readUInt16LE(O+12)===19280)x.crc=e.readUInt32LE(O+mt.EXTCRC-4),x.compressedSize=e.readUInt32LE(O+mt.EXTSIZ-4),x.size=e.readUInt32LE(O+mt.EXTLEN-4);else throw $e.Errors.DESCRIPTOR_UNKNOWN();if(x.compressedSize!==t.compressedSize||x.size!==t.size||x.crc!==t.crc)throw $e.Errors.DESCRIPTOR_FAULTY();if($e.crc32(y)!==x.crc)return!1}else if($e.crc32(y)!==t.localHeader.crc)return!1;return!0}function h(y,x,O){if(typeof x>"u"&&typeof y=="string"&&(O=y,y=void 0),s)return y&&x&&x(Buffer.alloc(0),$e.Errors.DIRECTORY_CONTENT_ERROR()),Buffer.alloc(0);var U=b();if(U.length===0)return y&&x&&x(U),U;if(t.encrypted){if(typeof O!="string"&&!Buffer.isBuffer(O))throw $e.Errors.INVALID_PASS_PARAM();U=ch.ZipCrypto.decrypt(U,t,O)}var F=Buffer.alloc(t.size);switch(t.method){case $e.Constants.STORED:if(U.copy(F),g(F))return y&&x&&x(F),F;throw y&&x&&x(F,$e.Errors.BAD_CRC()),$e.Errors.BAD_CRC();case $e.Constants.DEFLATED:var G=new ch.Inflater(U,t.size);if(y)G.inflateAsync(function(Y){Y.copy(Y,0),x&&(g(Y)?x(Y):x(Y,$e.Errors.BAD_CRC()))});else{if(G.inflate(F).copy(F,0),!g(F))throw $e.Errors.BAD_CRC(`"${v.decode(r)}"`);return F}break;default:throw y&&x&&x(Buffer.alloc(0),$e.Errors.UNKNOWN_METHOD()),$e.Errors.UNKNOWN_METHOD()}}function w(y,x){if((!o||!o.length)&&Buffer.isBuffer(e))return y&&x&&x(b()),b();if(o.length&&!s){var O;switch(t.method){case $e.Constants.STORED:return t.compressedSize=t.size,O=Buffer.alloc(o.length),o.copy(O),y&&x&&x(O),O;default:case $e.Constants.DEFLATED:var U=new ch.Deflater(o);if(y)U.deflateAsync(function(G){O=Buffer.alloc(G.length),t.compressedSize=G.length,G.copy(O),x&&x(O)});else{var F=U.deflate();return t.compressedSize=F.length,F}U=null;break}}else if(y&&x)x(Buffer.alloc(0));else return Buffer.alloc(0)}function _(y,x){return(y.readUInt32LE(x+4)<<4)+y.readUInt32LE(x)}function D(y){try{for(var x=0,O,U,F;x+4<y.length;)O=y.readUInt16LE(x),x+=2,U=y.readUInt16LE(x),x+=2,F=y.slice(x,x+U),x+=U,mt.ID_ZIP64===O&&k(F)}catch{throw $e.Errors.EXTRA_FIELD_PARSE_ERROR()}}function k(y){var x,O,U,F;y.length>=mt.EF_ZIP64_SCOMP&&(x=_(y,mt.EF_ZIP64_SUNCOMP),t.size===mt.EF_ZIP64_OR_32&&(t.size=x)),y.length>=mt.EF_ZIP64_RHO&&(O=_(y,mt.EF_ZIP64_SCOMP),t.compressedSize===mt.EF_ZIP64_OR_32&&(t.compressedSize=O)),y.length>=mt.EF_ZIP64_DSN&&(U=_(y,mt.EF_ZIP64_RHO),t.offset===mt.EF_ZIP64_OR_32&&(t.offset=U)),y.length>=mt.EF_ZIP64_DSN+4&&(F=y.readUInt32LE(mt.EF_ZIP64_DSN),t.diskNumStart===mt.EF_ZIP64_OR_16&&(t.diskNumStart=F))}return{get entryName(){return v.decode(r)},get rawEntryName(){return r},set entryName(y){r=$e.toBuffer(y,v.encode);var x=r[r.length-1];s=x===47||x===92,t.fileNameLength=r.length},get efs(){return typeof u=="function"?u(this.entryName):u},get extra(){return a},set extra(y){a=y,t.extraLength=y.length,D(y)},get comment(){return v.decode(i)},set comment(y){if(i=$e.toBuffer(y,v.encode),t.commentLength=i.length,i.length>65535)throw $e.Errors.COMMENT_TOO_LONG()},get name(){var y=v.decode(r);return s?y.substr(y.length-1).split("/").pop():y.split("/").pop()},get isDirectory(){return s},getCompressedData:function(){return w(!1,null)},getCompressedDataAsync:function(y){w(!0,y)},setData:function(y){o=$e.toBuffer(y,$e.decoder.encode),!s&&o.length?(t.size=o.length,t.method=$e.Constants.DEFLATED,t.crc=$e.crc32(y),t.changed=!0):t.method=$e.Constants.STORED},getData:function(y){return t.changed?o:h(!1,null,y)},getDataAsync:function(y,x){t.changed?y(o):h(!0,y,x)},set attr(y){t.attr=y},get attr(){return t.attr},set header(y){t.loadFromBinary(y)},get header(){return t},packCentralHeader:function(){t.flags_efs=this.efs,t.extraLength=a.length;var y=t.centralHeaderToBinary(),x=$e.Constants.CENHDR;return r.copy(y,x),x+=r.length,a.copy(y,x),x+=t.extraLength,i.copy(y,x),y},packLocalHeader:function(){let y=0;t.flags_efs=this.efs,t.extraLocalLength=c.length;let x=t.localHeaderToBinary(),O=Buffer.alloc(x.length+r.length+t.extraLocalLength);return x.copy(O,y),y+=x.length,r.copy(O,y),y+=r.length,c.copy(O,y),y+=c.length,O},toJSON:function(){let y=function(x){return"<"+(x&&x.length+" bytes buffer"||"null")+">"};return{entryName:this.entryName,name:this.name,comment:this.comment,isDirectory:this.isDirectory,header:t.toJSON(),compressedData:y(e),data:y(o)}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var TC=N((jP,SC)=>{var _C=uh(),lR=ah(),Ft=ws();SC.exports=function(n,e){var t=[],r={},i=Buffer.alloc(0),s=new lR.MainHeader,o=!1,a=null;let c=new Set,u=e,{noSort:d,decoder:v}=u;n?h(u.readEntries):o=!0;function b(){let _=new Set;for(let D of Object.keys(r)){let k=D.split("/");if(k.pop(),!!k.length)for(let y=0;y<k.length;y++){let x=k.slice(0,y+1).join("/")+"/";_.add(x)}}for(let D of _)if(!(D in r)){let k=new _C(u);k.entryName=D,k.attr=16,k.temporary=!0,t.push(k),r[k.entryName]=k,c.add(k)}}function g(){if(o=!0,r={},s.diskEntries>(n.length-s.offset)/Ft.Constants.CENHDR)throw Ft.Errors.DISK_ENTRY_TOO_LARGE();t=new Array(s.diskEntries);for(var _=s.offset,D=0;D<t.length;D++){var k=_,y=new _C(u,n);y.header=n.slice(k,k+=Ft.Constants.CENHDR),y.entryName=n.slice(k,k+=y.header.fileNameLength),y.header.extraLength&&(y.extra=n.slice(k,k+=y.header.extraLength)),y.header.commentLength&&(y.comment=n.slice(k,k+y.header.commentLength)),_+=y.header.centralHeaderSize,t[D]=y,r[y.entryName]=y}c.clear(),b()}function h(_){var D=n.length-Ft.Constants.ENDHDR,k=Math.max(0,D-65535),y=k,x=n.length,O=-1,U=0;for(typeof u.trailingSpace=="boolean"&&u.trailingSpace&&(k=0),D;D>=y;D--)if(n[D]===80){if(n.readUInt32LE(D)===Ft.Constants.ENDSIG){O=D,U=D,x=D+Ft.Constants.ENDHDR,y=D-Ft.Constants.END64HDR;continue}if(n.readUInt32LE(D)===Ft.Constants.END64SIG){y=k;continue}if(n.readUInt32LE(D)===Ft.Constants.ZIP64SIG){O=D,x=D+Ft.readBigUInt64LE(n,D+Ft.Constants.ZIP64SIZE)+Ft.Constants.ZIP64LEAD;break}}if(O==-1)throw Ft.Errors.INVALID_FORMAT();s.loadFromBinary(n.slice(O,x)),s.commentLength&&(i=n.slice(U+Ft.Constants.ENDHDR)),_&&g()}function w(){t.length>1&&!d&&t.sort((_,D)=>_.entryName.toLowerCase().localeCompare(D.entryName.toLowerCase()))}return{get entries(){return o||g(),t.filter(_=>!c.has(_))},get comment(){return v.decode(i)},set comment(_){i=Ft.toBuffer(_,v.encode),s.commentLength=i.length},getEntryCount:function(){return o?t.length:s.diskEntries},forEach:function(_){this.entries.forEach(_)},getEntry:function(_){return o||g(),r[_]||null},setEntry:function(_){o||g(),t.push(_),r[_.entryName]=_,s.totalEntries=t.length},deleteFile:function(_,D=!0){o||g();let k=r[_];this.getEntryChildren(k,D).map(x=>x.entryName).forEach(this.deleteEntry)},deleteEntry:function(_){o||g();let D=r[_],k=t.indexOf(D);k>=0&&(t.splice(k,1),delete r[_],s.totalEntries=t.length)},getEntryChildren:function(_,D=!0){if(o||g(),typeof _=="object")if(_.isDirectory&&D){let k=[],y=_.entryName;for(let x of t)x.entryName.startsWith(y)&&k.push(x);return k}else return[_];return[]},getChildCount:function(_){if(_&&_.isDirectory){let D=this.getEntryChildren(_);return D.includes(_)?D.length-1:D.length}return 0},compressToBuffer:function(){o||g(),w();let _=[],D=[],k=0,y=0;s.size=0,s.offset=0;let x=0;for(let F of this.entries){let G=F.getCompressedData();F.header.offset=y;let Y=F.packLocalHeader(),ve=Y.length+G.length;y+=ve,_.push(Y),_.push(G);let oe=F.packCentralHeader();D.push(oe),s.size+=oe.length,k+=ve+oe.length,x++}k+=s.mainHeaderSize,s.offset=y,s.totalEntries=x,y=0;let O=Buffer.alloc(k);for(let F of _)F.copy(O,y),y+=F.length;for(let F of D)F.copy(O,y),y+=F.length;let U=s.toBinary();return i&&i.copy(U,Ft.Constants.ENDHDR),U.copy(O,y),n=O,o=!1,O},toAsyncBuffer:function(_,D,k,y){try{o||g(),w();let x=[],O=[],U=0,F=0,G=0;s.size=0,s.offset=0;let Y=function(ve){if(ve.length>0){let oe=ve.shift(),qe=oe.entryName+oe.extra.toString();k&&k(qe),oe.getCompressedDataAsync(function(Xe){y&&y(qe),oe.header.offset=F;let bt=oe.packLocalHeader(),Ct=bt.length+Xe.length;F+=Ct,x.push(bt),x.push(Xe);let yt=oe.packCentralHeader();O.push(yt),s.size+=yt.length,U+=Ct+yt.length,G++,Y(ve)})}else{U+=s.mainHeaderSize,s.offset=F,s.totalEntries=G,F=0;let oe=Buffer.alloc(U);x.forEach(function(Xe){Xe.copy(oe,F),F+=Xe.length}),O.forEach(function(Xe){Xe.copy(oe,F),F+=Xe.length});let qe=s.toBinary();i&&i.copy(qe,Ft.Constants.ENDHDR),qe.copy(oe,F),n=oe,o=!1,_(oe)}};Y(Array.from(this.entries))}catch(x){D(x)}}}}});var DC=N((HP,RC)=>{var ct=ws(),gt=require("path"),dR=uh(),fR=TC(),Ii=(...n)=>ct.findLast(n,e=>typeof e=="boolean"),EC=(...n)=>ct.findLast(n,e=>typeof e=="string"),hR=(...n)=>ct.findLast(n,e=>typeof e=="function"),pR={noSort:!1,readEntries:!1,method:ct.Constants.NONE,fs:null};RC.exports=function(n,e){let t=null,r=Object.assign(Object.create(null),pR);n&&typeof n=="object"&&(n instanceof Uint8Array||(Object.assign(r,n),n=r.input?r.input:void 0,r.input&&delete r.input),Buffer.isBuffer(n)&&(t=n,r.method=ct.Constants.BUFFER,n=void 0)),Object.assign(r,e);let i=new ct(r);if((typeof r.decoder!="object"||typeof r.decoder.encode!="function"||typeof r.decoder.decode!="function")&&(r.decoder=ct.decoder),n&&typeof n=="string")if(i.fs.existsSync(n))r.method=ct.Constants.FILE,r.filename=n,t=i.fs.readFileSync(n);else throw ct.Errors.INVALID_FILENAME();let s=new fR(t,r),{canonical:o,sanitize:a,zipnamefix:c}=ct;function u(g){if(g&&s){var h;if(typeof g=="string"&&(h=s.getEntry(gt.posix.normalize(g))),typeof g=="object"&&typeof g.entryName<"u"&&typeof g.header<"u"&&(h=s.getEntry(g.entryName)),h)return h}return null}function d(g){let{join:h,normalize:w,sep:_}=gt.posix;return h(".",w(_+g.split("\\").join(_)+_))}function v(g){return g instanceof RegExp?(function(h){return function(w){return h.test(w)}})(g):typeof g!="function"?()=>!0:g}let b=(g,h)=>{let w=h.slice(-1);return w=w===i.sep?i.sep:"",gt.relative(g,h)+w};return{readFile:function(g,h){var w=u(g);return w&&w.getData(h)||null},childCount:function(g){let h=u(g);if(h)return s.getChildCount(h)},readFileAsync:function(g,h){var w=u(g);w?w.getDataAsync(h):h(null,"getEntry failed for:"+g)},readAsText:function(g,h){var w=u(g);if(w){var _=w.getData();if(_&&_.length)return _.toString(h||"utf8")}return""},readAsTextAsync:function(g,h,w){var _=u(g);_?_.getDataAsync(function(D,k){if(k){h(D,k);return}D&&D.length?h(D.toString(w||"utf8")):h("")}):h("")},deleteFile:function(g,h=!0){var w=u(g);w&&s.deleteFile(w.entryName,h)},deleteEntry:function(g){var h=u(g);h&&s.deleteEntry(h.entryName)},addZipComment:function(g){s.comment=g},getZipComment:function(){return s.comment||""},addZipEntryComment:function(g,h){var w=u(g);w&&(w.comment=h)},getZipEntryComment:function(g){var h=u(g);return h&&h.comment||""},updateFile:function(g,h){var w=u(g);w&&w.setData(h)},addLocalFile:function(g,h,w,_){if(i.fs.existsSync(g)){h=h?d(h):"";let D=gt.win32.basename(gt.win32.normalize(g));h+=w||D;let k=i.fs.statSync(g),y=k.isFile()?i.fs.readFileSync(g):Buffer.alloc(0);k.isDirectory()&&(h+=i.sep),this.addFile(h,y,_,k)}else throw ct.Errors.FILE_NOT_FOUND(g)},addLocalFileAsync:function(g,h){g=typeof g=="object"?g:{localPath:g};let w=gt.resolve(g.localPath),{comment:_}=g,{zipPath:D,zipName:k}=g,y=this;i.fs.stat(w,function(x,O){if(x)return h(x,!1);D=D?d(D):"";let U=gt.win32.basename(gt.win32.normalize(w));if(D+=k||U,O.isFile())i.fs.readFile(w,function(F,G){return F?h(F,!1):(y.addFile(D,G,_,O),setImmediate(h,void 0,!0))});else if(O.isDirectory())return D+=i.sep,y.addFile(D,Buffer.alloc(0),_,O),setImmediate(h,void 0,!0)})},addLocalFolder:function(g,h,w){if(w=v(w),h=h?d(h):"",g=gt.normalize(g),i.fs.existsSync(g)){let _=i.findFiles(g),D=this;if(_.length)for(let k of _){let y=gt.join(h,b(g,k));w(y)&&D.addLocalFile(k,gt.dirname(y))}}else throw ct.Errors.FILE_NOT_FOUND(g)},addLocalFolderAsync:function(g,h,w,_){_=v(_),w=w?d(w):"",g=gt.normalize(g);var D=this;i.fs.open(g,"r",function(k){if(k&&k.code==="ENOENT")h(void 0,ct.Errors.FILE_NOT_FOUND(g));else if(k)h(void 0,k);else{var y=i.findFiles(g),x=-1,O=function(){if(x+=1,x<y.length){var U=y[x],F=b(g,U).split("\\").join("/");F=F.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x20-\x7E]/g,""),_(F)?i.fs.stat(U,function(G,Y){G&&h(void 0,G),Y.isFile()?i.fs.readFile(U,function(ve,oe){ve?h(void 0,ve):(D.addFile(w+F,oe,"",Y),O())}):(D.addFile(w+F+"/",Buffer.alloc(0),"",Y),O())}):process.nextTick(()=>{O()})}else h(!0,void 0)};O()}})},addLocalFolderAsync2:function(g,h){let w=this;g=typeof g=="object"?g:{localPath:g},localPath=gt.resolve(d(g.localPath));let{zipPath:_,filter:D,namefix:k}=g;D instanceof RegExp?D=(function(O){return function(U){return O.test(U)}})(D):typeof D!="function"&&(D=function(){return!0}),_=_?d(_):"",k=="latin1"&&(k=O=>O.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x20-\x7E]/g,"")),typeof k!="function"&&(k=O=>O);let y=O=>gt.join(_,k(b(localPath,O))),x=O=>gt.win32.basename(gt.win32.normalize(k(O)));i.fs.open(localPath,"r",function(O){O&&O.code==="ENOENT"?h(void 0,ct.Errors.FILE_NOT_FOUND(localPath)):O?h(void 0,O):i.findFilesAsync(localPath,function(U,F){if(U)return h(U);F=F.filter(G=>D(y(G))),F.length||h(void 0,!1),setImmediate(F.reverse().reduce(function(G,Y){return function(ve,oe){if(ve||oe===!1)return setImmediate(G,ve,!1);w.addLocalFileAsync({localPath:Y,zipPath:gt.dirname(y(Y)),zipName:x(Y)},G)}},h))})})},addLocalFolderPromise:function(g,h){return new Promise((w,_)=>{this.addLocalFolderAsync2(Object.assign({localPath:g},h),(D,k)=>{D&&_(D),k&&w(this)})})},addFile:function(g,h,w,_){g=c(g);let D=u(g),k=D!=null;k||(D=new dR(r),D.entryName=g),D.comment=w||"";let y=typeof _=="object"&&_ instanceof i.fs.Stats;y&&(D.header.time=_.mtime);var x=D.isDirectory?16:0;let O=D.isDirectory?16384:32768;return y?O|=4095&_.mode:typeof _=="number"?O|=4095&_:O|=D.isDirectory?493:420,x=(x|O<<16)>>>0,D.attr=x,D.setData(h),k||s.setEntry(D),D},getEntries:function(g){return s.password=g,s?s.entries:[]},getEntry:function(g){return u(g)},getEntryCount:function(){return s.getEntryCount()},forEach:function(g){return s.forEach(g)},extractEntryTo:function(g,h,w,_,D,k){_=Ii(!1,_),D=Ii(!1,D),w=Ii(!0,w),k=EC(D,k);var y=u(g);if(!y)throw ct.Errors.NO_ENTRY();var x=o(y.entryName),O=a(h,k&&!y.isDirectory?k:w?x:gt.basename(x));if(y.isDirectory){var U=s.getEntryChildren(y);return U.forEach(function(Y){if(Y.isDirectory)return;var ve=Y.getData();if(!ve)throw ct.Errors.CANT_EXTRACT_FILE();var oe=o(Y.entryName),qe=a(h,w?oe:gt.basename(oe));let Xe=D?Y.header.fileAttr:void 0;i.writeFileTo(qe,ve,_,Xe)}),!0}var F=y.getData(s.password);if(!F)throw ct.Errors.CANT_EXTRACT_FILE();if(i.fs.existsSync(O)&&!_)throw ct.Errors.CANT_OVERRIDE();let G=D?g.header.fileAttr:void 0;return i.writeFileTo(O,F,_,G),!0},test:function(g){if(!s)return!1;for(var h in s.entries)try{if(h.isDirectory)continue;var w=s.entries[h].getData(g);if(!w)return!1}catch{return!1}return!0},extractAllTo:function(g,h,w,_){if(w=Ii(!1,w),_=EC(w,_),h=Ii(!1,h),!s)throw ct.Errors.NO_ZIP();s.entries.forEach(function(D){var k=a(g,o(D.entryName));if(D.isDirectory){i.makeDir(k);return}var y=D.getData(_);if(!y)throw ct.Errors.CANT_EXTRACT_FILE();let x=w?D.header.fileAttr:void 0;i.writeFileTo(k,y,h,x);try{i.fs.utimesSync(k,D.header.time,D.header.time)}catch{throw ct.Errors.CANT_EXTRACT_FILE()}})},extractAllToAsync:function(g,h,w,_){if(_=hR(h,w,_),w=Ii(!1,w),h=Ii(!1,h),!_)return new Promise((O,U)=>{this.extractAllToAsync(g,h,w,function(F){F?U(F):O(this)})});if(!s){_(ct.Errors.NO_ZIP());return}g=gt.resolve(g);let D=O=>a(g,gt.normalize(o(O.entryName))),k=(O,U)=>new Error(O+': "'+U+'"'),y=[],x=[];s.entries.forEach(O=>{O.isDirectory?y.push(O):x.push(O)});for(let O of y){let U=D(O),F=w?O.header.fileAttr:void 0;try{i.makeDir(U),F&&i.fs.chmodSync(U,F),i.fs.utimesSync(U,O.header.time,O.header.time)}catch{_(k("Unable to create folder",U))}}x.reverse().reduce(function(O,U){return function(F){if(F)O(F);else{let G=gt.normalize(o(U.entryName)),Y=a(g,G);U.getDataAsync(function(ve,oe){if(oe)O(oe);else if(!ve)O(ct.Errors.CANT_EXTRACT_FILE());else{let qe=w?U.header.fileAttr:void 0;i.writeFileToAsync(Y,ve,h,qe,function(Xe){Xe||O(k("Unable to write file",Y)),i.fs.utimes(Y,U.header.time,U.header.time,function(bt){bt?O(k("Unable to set times",Y)):O()})})}})}}},_)()},writeZip:function(g,h){if(arguments.length===1&&typeof g=="function"&&(h=g,g=""),!g&&r.filename&&(g=r.filename),!!g){var w=s.compressToBuffer();if(w){var _=i.writeFileTo(g,w,!0);typeof h=="function"&&h(_?null:new Error("failed"),"")}}},writeZipPromise:function(g,h){let{overwrite:w,perm:_}=Object.assign({overwrite:!0},h);return new Promise((D,k)=>{!g&&r.filename&&(g=r.filename),g||k("ADM-ZIP: ZIP File Name Missing"),this.toBufferPromise().then(y=>{let x=O=>O?D(O):k("ADM-ZIP: Wasn't able to write zip file");i.writeFileToAsync(g,y,w,_,x)},k)})},toBufferPromise:function(){return new Promise((g,h)=>{s.toAsyncBuffer(g,h)})},toBuffer:function(g,h,w,_){return typeof g=="function"?(s.toAsyncBuffer(g,h,w,_),null):s.compressToBuffer()}}}});var Es,Oi,wc,PC=mh(()=>{"use strict";Es=Vt(require("fs")),Oi=Vt(require("path"));dh();wc=class{cache=new Map;loadConfig(e){let t=this.findConfigFile(e);return t?this.loadConfigFromFile(t):{...Ts}}loadConfigFromFile(e){if(this.cache.has(e))return this.cache.get(e);let t;try{if(e.endsWith(".js"))t=require(e);else{let s=Es.readFileSync(e,"utf8");t=JSON.parse(s)}}catch(s){return console.error(`Failed to load config from ${e}:`,s),{...Ts}}let r=t;e.endsWith("holoscript.config.json")&&t.formatOptions&&(r=t.formatOptions);let i={...Ts,...r};return this.cache.set(e,i),i}findConfigFile(e){let t=Es.lstatSync(e).isDirectory()?e:Oi.dirname(e),r=Oi.parse(t).root;for(;t!==r;){let i=["holoscript.config.json",".holofmtrc",".holofmtrc.json",".holofmtrc.js","holofmt.config.js"];for(let s of i){let o=Oi.join(t,s);if(Es.existsSync(o))return o}t=Oi.dirname(t)}return null}}});var kC={};Ec(kC,{DEFAULT_CONFIG:()=>Ts,HoloScriptFormatter:()=>Yr,check:()=>vR,createFormatter:()=>bR,default:()=>wR,format:()=>gR,formatRange:()=>yR,loadConfig:()=>CR});function gR(n,e="holo"){return new Yr().format(n,e)}function yR(n,e,t="holo"){return new Yr().formatRange(n,e,t)}function vR(n,e="holo"){return new Yr().check(n,e)}function bR(n={}){return new Yr(n)}function CR(n){return new wc().loadConfig(n)}var Ts,Yr,wR,dh=mh(()=>{"use strict";PC();Ts={indentSize:2,useTabs:!1,maxLineLength:100,braceStyle:"same-line",trailingComma:"multi-line",bracketSpacing:!0,semicolons:!1,singleQuote:!1,sortImports:!0,maxBlankLines:1,blankLineBeforeComposition:!0},Yr=class{config;constructor(e={}){this.config={...Ts,...e}}format(e,t="holo"){let r=[],i=e;try{let s=t==="hsplus"?this.identifyRawBlocks(i):[];i=this.normalizeLineEndings(i),i=this.normalizeIndentation(i,s),i=this.normalizeBlankLines(i),i=this.formatBraces(i,s),i=this.handleTrailingCommas(i,s),this.config.sortImports&&(i=this.sortImports(i)),i=this.normalizeWhitespace(i,s),i=this.ensureFinalNewline(i)}catch(s){r.push({message:s instanceof Error?s.message:"Unknown formatting error",line:0,column:0})}return{formatted:i,changed:i!==e,errors:r}}formatRange(e,t,r="holo"){let i=this.format(e,r),s=e.split(`
`),o=i.formatted.split(`
`),a=Math.max(0,t.startLine),c=Math.min(o.length-1,t.endLine);if(a>c)return{formatted:"",changed:!1,errors:[]};let d=o.slice(a,c+1).join(`
`),v=s.slice(a,c+1).join(`
`);return{formatted:d,changed:d!==v,errors:i.errors}}check(e,t="holo"){return!this.format(e,t).changed}identifyRawBlocks(e){let t=[],r=e.split(`
`),i=["logic","module","script","struct","enum","class","interface","spatial_group","scene","group"],s=0,o=!1,a=-1;for(let c=0;c<r.length;c++){let u=r[c].trim();o?(s+=(u.match(/\{/g)||[]).length,s-=(u.match(/\}/g)||[]).length,s<=0&&(t.push({startLine:a+1,endLine:c-1}),o=!1)):i.some(v=>u.startsWith(v))&&u.includes("{")&&(o=!0,a=c,s=(u.match(/\{/g)||[]).length-(u.match(/\}/g)||[]).length,s===0&&(o=!1))}return t}normalizeLineEndings(e){return e.replace(/\r\n/g,`
`).replace(/\r/g,`
`)}normalizeIndentation(e,t=[]){let r=this.config.useTabs?"	":" ".repeat(this.config.indentSize),i=e.split(`
`),s=[],o=0;for(let a=0;a<i.length;a++){let c=i[a];if(t.some(w=>a>=w.startLine&&a<=w.endLine)){s.push(c);continue}let d=c.trim();if(d===""){s.push("");continue}let v=0;for(let w of d)if(w==="}")v++;else break;o=Math.max(0,o-v);let b=r.repeat(o);s.push(b+d);let g=(d.match(/\{/g)||[]).length,h=(d.match(/}/g)||[]).length;o=Math.max(0,o+g-h)}return s.join(`
`)}normalizeBlankLines(e){let t=this.config.maxBlankLines,r=new RegExp(`\\n{${t+2},}`,"g");return e.replace(r,`
`.repeat(t+1))}formatBraces(e,t=[]){if(t.length>0)return e;if(this.config.braceStyle==="same-line")return e.replace(/\n\s*\{/g," {");if(this.config.braceStyle==="next-line"){let r=e.split(`
`);for(let i=0;i<r.length;i++){let s=r[i];if(s.trim().length>1&&s.trim().endsWith("{")){let o=s.match(/^(\s*)(.*)\s*\{$/);if(o){let a=o[1],c=o[2].trimEnd();r[i]=`${a}${c}
${a}{`}}}return r.join(`
`)}return e}handleTrailingCommas(e,t=[]){return t.length>0?e:this.config.trailingComma==="none"?e.replace(/,(\s*[\]}])/g,"$1"):this.config.trailingComma==="all"?e.replace(/([^\s,])(\s*\n\s*[\]}])/g,"$1,$2"):e}sortImports(e){let t=e.split(`
`),r=[],i=[],s=!1,o=!1,a=!1;for(let d=0;d<t.length;d++){let v=t[d],b=v.trim().startsWith("import ")||v.trim().startsWith("@import"),g=v.trim()==="";if(b)s=!0,r.push(v);else if(s&&g&&!o)a=!0,o=!0;else{if(!s&&g)continue;i.push(v),s&&!o&&(o=!0)}}if(r.length===0)return e;let u=[...r.sort((d,v)=>d.localeCompare(v))];return a&&u.push(""),u.push(...i),u.join(`
`)}normalizeWhitespace(e,t=[]){return e.split(`
`).map((r,i)=>t.some(o=>i>=o.startLine&&i<=o.endLine)?r:r.trimEnd()).join(`
`)}ensureFinalNewline(e){return e.endsWith(`
`)?e:e+`
`}getConfig(){return{...this.config}}setConfig(e){this.config={...this.config,...e}}};wR=Yr});var TR={};Ec(TR,{activate:()=>_R,deactivate:()=>SR});module.exports=yh(TR);var Mi=Vt(require("path")),po=Vt(require("fs")),Ge=Vt(require("vscode")),De=require("vscode"),mo=Vt(Ob());var ur=Vt(require("vscode"));var Fe={};Ec(Fe,{BRAND:()=>uE,DIRTY:()=>pi,EMPTY_PATH:()=>$T,INVALID:()=>se,NEVER:()=>GE,OK:()=>Bt,ParseStatus:()=>Lt,Schema:()=>be,ZodAny:()=>Vr,ZodArray:()=>Tr,ZodBigInt:()=>gi,ZodBoolean:()=>yi,ZodBranded:()=>uo,ZodCatch:()=>xi,ZodDate:()=>vi,ZodDefault:()=>Di,ZodDiscriminatedUnion:()=>uc,ZodEffects:()=>In,ZodEnum:()=>Ei,ZodError:()=>un,ZodFirstPartyTypeKind:()=>ue,ZodFunction:()=>dc,ZodIntersection:()=>_i,ZodIssueCode:()=>$,ZodLazy:()=>Si,ZodLiteral:()=>Ti,ZodMap:()=>ys,ZodNaN:()=>bs,ZodNativeEnum:()=>Ri,ZodNever:()=>Bn,ZodNull:()=>Ci,ZodNullable:()=>cr,ZodNumber:()=>mi,ZodObject:()=>ln,ZodOptional:()=>Pn,ZodParsedType:()=>X,ZodPipeline:()=>lo,ZodPromise:()=>Zr,ZodReadonly:()=>Pi,ZodRecord:()=>lc,ZodSchema:()=>be,ZodSet:()=>vs,ZodString:()=>Gr,ZodSymbol:()=>ms,ZodTransformer:()=>In,ZodTuple:()=>ar,ZodType:()=>be,ZodUndefined:()=>bi,ZodUnion:()=>wi,ZodUnknown:()=>Sr,ZodVoid:()=>gs,addIssueToContext:()=>V,any:()=>vE,array:()=>_E,bigint:()=>hE,boolean:()=>zb,coerce:()=>KE,custom:()=>Hb,date:()=>pE,datetimeRegex:()=>Ab,defaultErrorMap:()=>wr,discriminatedUnion:()=>RE,effect:()=>AE,enum:()=>LE,function:()=>OE,getErrorMap:()=>fs,getParsedType:()=>or,instanceof:()=>dE,intersection:()=>DE,isAborted:()=>ac,isAsync:()=>hs,isDirty:()=>cc,isValid:()=>Kr,late:()=>lE,lazy:()=>ME,literal:()=>NE,makeIssue:()=>co,map:()=>kE,nan:()=>fE,nativeEnum:()=>FE,never:()=>CE,null:()=>yE,nullable:()=>HE,number:()=>Ub,object:()=>SE,objectUtil:()=>th,oboolean:()=>BE,onumber:()=>WE,optional:()=>jE,ostring:()=>zE,pipeline:()=>UE,preprocess:()=>$E,promise:()=>qE,quotelessJson:()=>AT,record:()=>PE,set:()=>IE,setErrorMap:()=>HT,strictObject:()=>TE,string:()=>$b,symbol:()=>mE,transformer:()=>AE,tuple:()=>xE,undefined:()=>gE,union:()=>EE,unknown:()=>bE,util:()=>_e,void:()=>wE});var _e;(function(n){n.assertEqual=i=>{};function e(i){}n.assertIs=e;function t(i){throw new Error}n.assertNever=t,n.arrayToEnum=i=>{let s={};for(let o of i)s[o]=o;return s},n.getValidEnumValues=i=>{let s=n.objectKeys(i).filter(a=>typeof i[i[a]]!="number"),o={};for(let a of s)o[a]=i[a];return n.objectValues(o)},n.objectValues=i=>n.objectKeys(i).map(function(s){return i[s]}),n.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{let s=[];for(let o in i)Object.prototype.hasOwnProperty.call(i,o)&&s.push(o);return s},n.find=(i,s)=>{for(let o of i)if(s(o))return o},n.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,s=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}n.joinValues=r,n.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(_e||(_e={}));var th;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(th||(th={}));var X=_e.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),or=n=>{switch(typeof n){case"undefined":return X.undefined;case"string":return X.string;case"number":return Number.isNaN(n)?X.nan:X.number;case"boolean":return X.boolean;case"function":return X.function;case"bigint":return X.bigint;case"symbol":return X.symbol;case"object":return Array.isArray(n)?X.array:n===null?X.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?X.promise:typeof Map<"u"&&n instanceof Map?X.map:typeof Set<"u"&&n instanceof Set?X.set:typeof Date<"u"&&n instanceof Date?X.date:X.object;default:return X.unknown}};var $=_e.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),AT=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:"),un=class n extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(s){return s.message},r={_errors:[]},i=s=>{for(let o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let a=r,c=0;for(;c<o.path.length;){let u=o.path[c];c===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(t(o))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return i(this),r}static assert(e){if(!(e instanceof n))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,_e.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},r=[];for(let i of this.issues)if(i.path.length>0){let s=i.path[0];t[s]=t[s]||[],t[s].push(e(i))}else r.push(e(i));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}};un.create=n=>new un(n);var jT=(n,e)=>{let t;switch(n.code){case $.invalid_type:n.received===X.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case $.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,_e.jsonStringifyReplacer)}`;break;case $.unrecognized_keys:t=`Unrecognized key(s) in object: ${_e.joinValues(n.keys,", ")}`;break;case $.invalid_union:t="Invalid input";break;case $.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${_e.joinValues(n.options)}`;break;case $.invalid_enum_value:t=`Invalid enum value. Expected ${_e.joinValues(n.options)}, received '${n.received}'`;break;case $.invalid_arguments:t="Invalid function arguments";break;case $.invalid_return_type:t="Invalid function return type";break;case $.invalid_date:t="Invalid date";break;case $.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:_e.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case $.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case $.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case $.custom:t="Invalid input";break;case $.invalid_intersection_types:t="Intersection results could not be merged";break;case $.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case $.not_finite:t="Number must be finite";break;default:t=e.defaultError,_e.assertNever(n)}return{message:t}},wr=jT;var Mb=wr;function HT(n){Mb=n}function fs(){return Mb}var co=n=>{let{data:e,path:t,errorMaps:r,issueData:i}=n,s=[...t,...i.path||[]],o={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let a="",c=r.filter(u=>!!u).slice().reverse();for(let u of c)a=u(o,{data:e,defaultError:a}).message;return{...i,path:s,message:a}},$T=[];function V(n,e){let t=fs(),r=co({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===wr?void 0:wr].filter(i=>!!i)});n.common.issues.push(r)}var Lt=class n{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let i of t){if(i.status==="aborted")return se;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){let r=[];for(let i of t){let s=await i.key,o=await i.value;r.push({key:s,value:o})}return n.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let r={};for(let i of t){let{key:s,value:o}=i;if(s.status==="aborted"||o.status==="aborted")return se;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(r[s.value]=o.value)}return{status:e.value,value:r}}},se=Object.freeze({status:"aborted"}),pi=n=>({status:"dirty",value:n}),Bt=n=>({status:"valid",value:n}),ac=n=>n.status==="aborted",cc=n=>n.status==="dirty",Kr=n=>n.status==="valid",hs=n=>typeof Promise<"u"&&n instanceof Promise;var re;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e?.message})(re||(re={}));var kn=class{constructor(e,t,r,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Nb=(n,e)=>{if(Kr(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new un(n.common.issues);return this._error=t,this._error}}};function ye(n){if(!n)return{};let{errorMap:e,invalid_type_error:t,required_error:r,description:i}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(o,a)=>{let{message:c}=n;return o.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??r??a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:c??t??a.defaultError}},description:i}}var be=class{get description(){return this._def.description}_getType(e){return or(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:or(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Lt,ctx:{common:e.parent.common,data:e.data,parsedType:or(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(hs(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:or(e)},i=this._parseSync({data:e,path:r.path,parent:r});return Nb(r,i)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:or(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return Kr(r)?{value:r.value}:{issues:t.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(r=>Kr(r)?{value:r.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:or(e)},i=this._parse({data:e,path:r.path,parent:r}),s=await(hs(i)?i:Promise.resolve(i));return Nb(r,s)}refine(e,t){let r=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,s)=>{let o=e(i),a=()=>s.addIssue({code:$.custom,...r(i)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof t=="function"?t(r,i):t),!1))}_refinement(e){return new In({schema:this,typeName:ue.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Pn.create(this,this._def)}nullable(){return cr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Tr.create(this)}promise(){return Zr.create(this,this._def)}or(e){return wi.create([this,e],this._def)}and(e){return _i.create(this,e,this._def)}transform(e){return new In({...ye(this._def),schema:this,typeName:ue.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t=typeof e=="function"?e:()=>e;return new Di({...ye(this._def),innerType:this,defaultValue:t,typeName:ue.ZodDefault})}brand(){return new uo({typeName:ue.ZodBranded,type:this,...ye(this._def)})}catch(e){let t=typeof e=="function"?e:()=>e;return new xi({...ye(this._def),innerType:this,catchValue:t,typeName:ue.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return lo.create(this,e)}readonly(){return Pi.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},UT=/^c[^\s-]{8,}$/i,zT=/^[0-9a-z]+$/,WT=/^[0-9A-HJKMNP-TV-Z]{26}$/i,BT=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,KT=/^[a-z0-9_-]{21}$/i,GT=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,VT=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ZT=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,XT="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",nh,JT=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,YT=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,QT=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,eE=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,tE=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nE=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Fb="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",rE=new RegExp(`^${Fb}$`);function qb(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);let t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function iE(n){return new RegExp(`^${qb(n)}$`)}function Ab(n){let e=`${Fb}T${qb(n)}`,t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function sE(n,e){return!!((e==="v4"||!e)&&JT.test(n)||(e==="v6"||!e)&&QT.test(n))}function oE(n,e){if(!GT.test(n))return!1;try{let[t]=n.split(".");if(!t)return!1;let r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&i?.typ!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function aE(n,e){return!!((e==="v4"||!e)&&YT.test(n)||(e==="v6"||!e)&&eE.test(n))}var Gr=class n extends be{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==X.string){let s=this._getOrReturnCtx(e);return V(s,{code:$.invalid_type,expected:X.string,received:s.parsedType}),se}let r=new Lt,i;for(let s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),V(i,{code:$.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),V(i,{code:$.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){let o=e.data.length>s.value,a=e.data.length<s.value;(o||a)&&(i=this._getOrReturnCtx(e,i),o?V(i,{code:$.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&V(i,{code:$.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")ZT.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"email",code:$.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")nh||(nh=new RegExp(XT,"u")),nh.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"emoji",code:$.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")BT.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"uuid",code:$.invalid_string,message:s.message}),r.dirty());else if(s.kind==="nanoid")KT.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"nanoid",code:$.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")UT.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"cuid",code:$.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")zT.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"cuid2",code:$.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")WT.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"ulid",code:$.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),V(i,{validation:"url",code:$.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"regex",code:$.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),V(i,{code:$.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),V(i,{code:$.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),V(i,{code:$.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?Ab(s).test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{code:$.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="date"?rE.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{code:$.invalid_string,validation:"date",message:s.message}),r.dirty()):s.kind==="time"?iE(s).test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{code:$.invalid_string,validation:"time",message:s.message}),r.dirty()):s.kind==="duration"?VT.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"duration",code:$.invalid_string,message:s.message}),r.dirty()):s.kind==="ip"?sE(e.data,s.version)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"ip",code:$.invalid_string,message:s.message}),r.dirty()):s.kind==="jwt"?oE(e.data,s.alg)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"jwt",code:$.invalid_string,message:s.message}),r.dirty()):s.kind==="cidr"?aE(e.data,s.version)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"cidr",code:$.invalid_string,message:s.message}),r.dirty()):s.kind==="base64"?tE.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"base64",code:$.invalid_string,message:s.message}),r.dirty()):s.kind==="base64url"?nE.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"base64url",code:$.invalid_string,message:s.message}),r.dirty()):_e.assertNever(s);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(i=>e.test(i),{validation:t,code:$.invalid_string,...re.errToObj(r)})}_addCheck(e){return new n({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...re.errToObj(e)})}url(e){return this._addCheck({kind:"url",...re.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...re.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...re.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...re.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...re.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...re.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...re.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...re.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...re.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...re.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...re.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...re.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...re.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...re.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...re.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...re.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...re.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...re.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...re.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...re.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...re.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...re.errToObj(t)})}nonempty(e){return this.min(1,re.errToObj(e))}trim(){return new n({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new n({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new n({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};Gr.create=n=>new Gr({checks:[],typeName:ue.ZodString,coerce:n?.coerce??!1,...ye(n)});function cE(n,e){let t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=t>r?t:r,s=Number.parseInt(n.toFixed(i).replace(".","")),o=Number.parseInt(e.toFixed(i).replace(".",""));return s%o/10**i}var mi=class n extends be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==X.number){let s=this._getOrReturnCtx(e);return V(s,{code:$.invalid_type,expected:X.number,received:s.parsedType}),se}let r,i=new Lt;for(let s of this._def.checks)s.kind==="int"?_e.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),V(r,{code:$.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:$.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:$.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?cE(e.data,s.value)!==0&&(r=this._getOrReturnCtx(e,r),V(r,{code:$.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),V(r,{code:$.not_finite,message:s.message}),i.dirty()):_e.assertNever(s);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,re.toString(t))}gt(e,t){return this.setLimit("min",e,!1,re.toString(t))}lte(e,t){return this.setLimit("max",e,!0,re.toString(t))}lt(e,t){return this.setLimit("max",e,!1,re.toString(t))}setLimit(e,t,r,i){return new n({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:re.toString(i)}]})}_addCheck(e){return new n({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:re.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:re.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:re.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:re.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:re.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:re.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:re.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:re.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:re.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&_e.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}};mi.create=n=>new mi({checks:[],typeName:ue.ZodNumber,coerce:n?.coerce||!1,...ye(n)});var gi=class n extends be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==X.bigint)return this._getInvalidInput(e);let r,i=new Lt;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:$.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:$.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),V(r,{code:$.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):_e.assertNever(s);return{status:i.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return V(t,{code:$.invalid_type,expected:X.bigint,received:t.parsedType}),se}gte(e,t){return this.setLimit("min",e,!0,re.toString(t))}gt(e,t){return this.setLimit("min",e,!1,re.toString(t))}lte(e,t){return this.setLimit("max",e,!0,re.toString(t))}lt(e,t){return this.setLimit("max",e,!1,re.toString(t))}setLimit(e,t,r,i){return new n({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:re.toString(i)}]})}_addCheck(e){return new n({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:re.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:re.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:re.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:re.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:re.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};gi.create=n=>new gi({checks:[],typeName:ue.ZodBigInt,coerce:n?.coerce??!1,...ye(n)});var yi=class extends be{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==X.boolean){let r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:X.boolean,received:r.parsedType}),se}return Bt(e.data)}};yi.create=n=>new yi({typeName:ue.ZodBoolean,coerce:n?.coerce||!1,...ye(n)});var vi=class n extends be{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==X.date){let s=this._getOrReturnCtx(e);return V(s,{code:$.invalid_type,expected:X.date,received:s.parsedType}),se}if(Number.isNaN(e.data.getTime())){let s=this._getOrReturnCtx(e);return V(s,{code:$.invalid_date}),se}let r=new Lt,i;for(let s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),V(i,{code:$.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),V(i,{code:$.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):_e.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new n({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:re.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:re.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};vi.create=n=>new vi({checks:[],coerce:n?.coerce||!1,typeName:ue.ZodDate,...ye(n)});var ms=class extends be{_parse(e){if(this._getType(e)!==X.symbol){let r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:X.symbol,received:r.parsedType}),se}return Bt(e.data)}};ms.create=n=>new ms({typeName:ue.ZodSymbol,...ye(n)});var bi=class extends be{_parse(e){if(this._getType(e)!==X.undefined){let r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:X.undefined,received:r.parsedType}),se}return Bt(e.data)}};bi.create=n=>new bi({typeName:ue.ZodUndefined,...ye(n)});var Ci=class extends be{_parse(e){if(this._getType(e)!==X.null){let r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:X.null,received:r.parsedType}),se}return Bt(e.data)}};Ci.create=n=>new Ci({typeName:ue.ZodNull,...ye(n)});var Vr=class extends be{constructor(){super(...arguments),this._any=!0}_parse(e){return Bt(e.data)}};Vr.create=n=>new Vr({typeName:ue.ZodAny,...ye(n)});var Sr=class extends be{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Bt(e.data)}};Sr.create=n=>new Sr({typeName:ue.ZodUnknown,...ye(n)});var Bn=class extends be{_parse(e){let t=this._getOrReturnCtx(e);return V(t,{code:$.invalid_type,expected:X.never,received:t.parsedType}),se}};Bn.create=n=>new Bn({typeName:ue.ZodNever,...ye(n)});var gs=class extends be{_parse(e){if(this._getType(e)!==X.undefined){let r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:X.void,received:r.parsedType}),se}return Bt(e.data)}};gs.create=n=>new gs({typeName:ue.ZodVoid,...ye(n)});var Tr=class n extends be{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),i=this._def;if(t.parsedType!==X.array)return V(t,{code:$.invalid_type,expected:X.array,received:t.parsedType}),se;if(i.exactLength!==null){let o=t.data.length>i.exactLength.value,a=t.data.length<i.exactLength.value;(o||a)&&(V(t,{code:o?$.too_big:$.too_small,minimum:a?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&t.data.length<i.minLength.value&&(V(t,{code:$.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&t.data.length>i.maxLength.value&&(V(t,{code:$.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>i.type._parseAsync(new kn(t,o,t.path,a)))).then(o=>Lt.mergeArray(r,o));let s=[...t.data].map((o,a)=>i.type._parseSync(new kn(t,o,t.path,a)));return Lt.mergeArray(r,s)}get element(){return this._def.type}min(e,t){return new n({...this._def,minLength:{value:e,message:re.toString(t)}})}max(e,t){return new n({...this._def,maxLength:{value:e,message:re.toString(t)}})}length(e,t){return new n({...this._def,exactLength:{value:e,message:re.toString(t)}})}nonempty(e){return this.min(1,e)}};Tr.create=(n,e)=>new Tr({type:n,minLength:null,maxLength:null,exactLength:null,typeName:ue.ZodArray,...ye(e)});function ps(n){if(n instanceof ln){let e={};for(let t in n.shape){let r=n.shape[t];e[t]=Pn.create(ps(r))}return new ln({...n._def,shape:()=>e})}else return n instanceof Tr?new Tr({...n._def,type:ps(n.element)}):n instanceof Pn?Pn.create(ps(n.unwrap())):n instanceof cr?cr.create(ps(n.unwrap())):n instanceof ar?ar.create(n.items.map(e=>ps(e))):n}var ln=class n extends be{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=_e.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==X.object){let u=this._getOrReturnCtx(e);return V(u,{code:$.invalid_type,expected:X.object,received:u.parsedType}),se}let{status:r,ctx:i}=this._processInputParams(e),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Bn&&this._def.unknownKeys==="strip"))for(let u in i.data)o.includes(u)||a.push(u);let c=[];for(let u of o){let d=s[u],v=i.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new kn(i,v,i.path,u)),alwaysSet:u in i.data})}if(this._def.catchall instanceof Bn){let u=this._def.unknownKeys;if(u==="passthrough")for(let d of a)c.push({key:{status:"valid",value:d},value:{status:"valid",value:i.data[d]}});else if(u==="strict")a.length>0&&(V(i,{code:$.unrecognized_keys,keys:a}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let d of a){let v=i.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new kn(i,v,i.path,d)),alwaysSet:d in i.data})}}return i.common.async?Promise.resolve().then(async()=>{let u=[];for(let d of c){let v=await d.key,b=await d.value;u.push({key:v,value:b,alwaysSet:d.alwaysSet})}return u}).then(u=>Lt.mergeObjectSync(r,u)):Lt.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return re.errToObj,new n({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{let i=this._def.errorMap?.(t,r).message??r.defaultError;return t.code==="unrecognized_keys"?{message:re.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new n({...this._def,unknownKeys:"strip"})}passthrough(){return new n({...this._def,unknownKeys:"passthrough"})}extend(e){return new n({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new n({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ue.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new n({...this._def,catchall:e})}pick(e){let t={};for(let r of _e.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new n({...this._def,shape:()=>t})}omit(e){let t={};for(let r of _e.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new n({...this._def,shape:()=>t})}deepPartial(){return ps(this)}partial(e){let t={};for(let r of _e.objectKeys(this.shape)){let i=this.shape[r];e&&!e[r]?t[r]=i:t[r]=i.optional()}return new n({...this._def,shape:()=>t})}required(e){let t={};for(let r of _e.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof Pn;)s=s._def.innerType;t[r]=s}return new n({...this._def,shape:()=>t})}keyof(){return jb(_e.objectKeys(this.shape))}};ln.create=(n,e)=>new ln({shape:()=>n,unknownKeys:"strip",catchall:Bn.create(),typeName:ue.ZodObject,...ye(e)});ln.strictCreate=(n,e)=>new ln({shape:()=>n,unknownKeys:"strict",catchall:Bn.create(),typeName:ue.ZodObject,...ye(e)});ln.lazycreate=(n,e)=>new ln({shape:n,unknownKeys:"strip",catchall:Bn.create(),typeName:ue.ZodObject,...ye(e)});var wi=class extends be{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;function i(s){for(let a of s)if(a.result.status==="valid")return a.result;for(let a of s)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;let o=s.map(a=>new un(a.ctx.common.issues));return V(t,{code:$.invalid_union,unionErrors:o}),se}if(t.common.async)return Promise.all(r.map(async s=>{let o={...t,common:{...t.common,issues:[]},parent:null};return{result:await s._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(i);{let s,o=[];for(let c of r){let u={...t,common:{...t.common,issues:[]},parent:null},d=c._parseSync({data:t.data,path:t.path,parent:u});if(d.status==="valid")return d;d.status==="dirty"&&!s&&(s={result:d,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(s)return t.common.issues.push(...s.ctx.common.issues),s.result;let a=o.map(c=>new un(c));return V(t,{code:$.invalid_union,unionErrors:a}),se}}get options(){return this._def.options}};wi.create=(n,e)=>new wi({options:n,typeName:ue.ZodUnion,...ye(e)});var _r=n=>n instanceof Si?_r(n.schema):n instanceof In?_r(n.innerType()):n instanceof Ti?[n.value]:n instanceof Ei?n.options:n instanceof Ri?_e.objectValues(n.enum):n instanceof Di?_r(n._def.innerType):n instanceof bi?[void 0]:n instanceof Ci?[null]:n instanceof Pn?[void 0,..._r(n.unwrap())]:n instanceof cr?[null,..._r(n.unwrap())]:n instanceof uo||n instanceof Pi?_r(n.unwrap()):n instanceof xi?_r(n._def.innerType):[],uc=class n extends be{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==X.object)return V(t,{code:$.invalid_type,expected:X.object,received:t.parsedType}),se;let r=this.discriminator,i=t.data[r],s=this.optionsMap.get(i);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(V(t,{code:$.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),se)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let i=new Map;for(let s of t){let o=_r(s.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of o){if(i.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);i.set(a,s)}}return new n({typeName:ue.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...ye(r)})}};function rh(n,e){let t=or(n),r=or(e);if(n===e)return{valid:!0,data:n};if(t===X.object&&r===X.object){let i=_e.objectKeys(e),s=_e.objectKeys(n).filter(a=>i.indexOf(a)!==-1),o={...n,...e};for(let a of s){let c=rh(n[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(t===X.array&&r===X.array){if(n.length!==e.length)return{valid:!1};let i=[];for(let s=0;s<n.length;s++){let o=n[s],a=e[s],c=rh(o,a);if(!c.valid)return{valid:!1};i.push(c.data)}return{valid:!0,data:i}}else return t===X.date&&r===X.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}var _i=class extends be{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),i=(s,o)=>{if(ac(s)||ac(o))return se;let a=rh(s.value,o.value);return a.valid?((cc(s)||cc(o))&&t.dirty(),{status:t.value,value:a.data}):(V(r,{code:$.invalid_intersection_types}),se)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,o])=>i(s,o)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}};_i.create=(n,e,t)=>new _i({left:n,right:e,typeName:ue.ZodIntersection,...ye(t)});var ar=class n extends be{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==X.array)return V(r,{code:$.invalid_type,expected:X.array,received:r.parsedType}),se;if(r.data.length<this._def.items.length)return V(r,{code:$.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),se;!this._def.rest&&r.data.length>this._def.items.length&&(V(r,{code:$.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let s=[...r.data].map((o,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new kn(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(s).then(o=>Lt.mergeArray(t,o)):Lt.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new n({...this._def,rest:e})}};ar.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ar({items:n,typeName:ue.ZodTuple,rest:null,...ye(e)})};var lc=class n extends be{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==X.object)return V(r,{code:$.invalid_type,expected:X.object,received:r.parsedType}),se;let i=[],s=this._def.keyType,o=this._def.valueType;for(let a in r.data)i.push({key:s._parse(new kn(r,a,r.path,a)),value:o._parse(new kn(r,r.data[a],r.path,a)),alwaysSet:a in r.data});return r.common.async?Lt.mergeObjectAsync(t,i):Lt.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof be?new n({keyType:e,valueType:t,typeName:ue.ZodRecord,...ye(r)}):new n({keyType:Gr.create(),valueType:e,typeName:ue.ZodRecord,...ye(t)})}},ys=class extends be{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==X.map)return V(r,{code:$.invalid_type,expected:X.map,received:r.parsedType}),se;let i=this._def.keyType,s=this._def.valueType,o=[...r.data.entries()].map(([a,c],u)=>({key:i._parse(new kn(r,a,r.path,[u,"key"])),value:s._parse(new kn(r,c,r.path,[u,"value"]))}));if(r.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of o){let u=await c.key,d=await c.value;if(u.status==="aborted"||d.status==="aborted")return se;(u.status==="dirty"||d.status==="dirty")&&t.dirty(),a.set(u.value,d.value)}return{status:t.value,value:a}})}else{let a=new Map;for(let c of o){let u=c.key,d=c.value;if(u.status==="aborted"||d.status==="aborted")return se;(u.status==="dirty"||d.status==="dirty")&&t.dirty(),a.set(u.value,d.value)}return{status:t.value,value:a}}}};ys.create=(n,e,t)=>new ys({valueType:e,keyType:n,typeName:ue.ZodMap,...ye(t)});var vs=class n extends be{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==X.set)return V(r,{code:$.invalid_type,expected:X.set,received:r.parsedType}),se;let i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(V(r,{code:$.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(V(r,{code:$.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());let s=this._def.valueType;function o(c){let u=new Set;for(let d of c){if(d.status==="aborted")return se;d.status==="dirty"&&t.dirty(),u.add(d.value)}return{status:t.value,value:u}}let a=[...r.data.values()].map((c,u)=>s._parse(new kn(r,c,r.path,u)));return r.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,t){return new n({...this._def,minSize:{value:e,message:re.toString(t)}})}max(e,t){return new n({...this._def,maxSize:{value:e,message:re.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};vs.create=(n,e)=>new vs({valueType:n,minSize:null,maxSize:null,typeName:ue.ZodSet,...ye(e)});var dc=class n extends be{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==X.function)return V(t,{code:$.invalid_type,expected:X.function,received:t.parsedType}),se;function r(a,c){return co({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,fs(),wr].filter(u=>!!u),issueData:{code:$.invalid_arguments,argumentsError:c}})}function i(a,c){return co({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,fs(),wr].filter(u=>!!u),issueData:{code:$.invalid_return_type,returnTypeError:c}})}let s={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Zr){let a=this;return Bt(async function(...c){let u=new un([]),d=await a._def.args.parseAsync(c,s).catch(g=>{throw u.addIssue(r(c,g)),u}),v=await Reflect.apply(o,this,d);return await a._def.returns._def.type.parseAsync(v,s).catch(g=>{throw u.addIssue(i(v,g)),u})})}else{let a=this;return Bt(function(...c){let u=a._def.args.safeParse(c,s);if(!u.success)throw new un([r(c,u.error)]);let d=Reflect.apply(o,this,u.data),v=a._def.returns.safeParse(d,s);if(!v.success)throw new un([i(d,v.error)]);return v.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new n({...this._def,args:ar.create(e).rest(Sr.create())})}returns(e){return new n({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new n({args:e||ar.create([]).rest(Sr.create()),returns:t||Sr.create(),typeName:ue.ZodFunction,...ye(r)})}},Si=class extends be{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};Si.create=(n,e)=>new Si({getter:n,typeName:ue.ZodLazy,...ye(e)});var Ti=class extends be{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return V(t,{received:t.data,code:$.invalid_literal,expected:this._def.value}),se}return{status:"valid",value:e.data}}get value(){return this._def.value}};Ti.create=(n,e)=>new Ti({value:n,typeName:ue.ZodLiteral,...ye(e)});function jb(n,e){return new Ei({values:n,typeName:ue.ZodEnum,...ye(e)})}var Ei=class n extends be{_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),r=this._def.values;return V(t,{expected:_e.joinValues(r),received:t.parsedType,code:$.invalid_type}),se}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return V(t,{received:t.data,code:$.invalid_enum_value,options:r}),se}return Bt(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return n.create(e,{...this._def,...t})}exclude(e,t=this._def){return n.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}};Ei.create=jb;var Ri=class extends be{_parse(e){let t=_e.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==X.string&&r.parsedType!==X.number){let i=_e.objectValues(t);return V(r,{expected:_e.joinValues(i),received:r.parsedType,code:$.invalid_type}),se}if(this._cache||(this._cache=new Set(_e.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let i=_e.objectValues(t);return V(r,{received:r.data,code:$.invalid_enum_value,options:i}),se}return Bt(e.data)}get enum(){return this._def.values}};Ri.create=(n,e)=>new Ri({values:n,typeName:ue.ZodNativeEnum,...ye(e)});var Zr=class extends be{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==X.promise&&t.common.async===!1)return V(t,{code:$.invalid_type,expected:X.promise,received:t.parsedType}),se;let r=t.parsedType===X.promise?t.data:Promise.resolve(t.data);return Bt(r.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}};Zr.create=(n,e)=>new Zr({type:n,typeName:ue.ZodPromise,...ye(e)});var In=class extends be{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ue.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:o=>{V(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){let o=i.transform(r.data,s);if(r.common.async)return Promise.resolve(o).then(async a=>{if(t.value==="aborted")return se;let c=await this._def.schema._parseAsync({data:a,path:r.path,parent:r});return c.status==="aborted"?se:c.status==="dirty"?pi(c.value):t.value==="dirty"?pi(c.value):c});{if(t.value==="aborted")return se;let a=this._def.schema._parseSync({data:o,path:r.path,parent:r});return a.status==="aborted"?se:a.status==="dirty"?pi(a.value):t.value==="dirty"?pi(a.value):a}}if(i.type==="refinement"){let o=a=>{let c=i.refinement(a,s);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){let a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?se:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?se:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(i.type==="transform")if(r.common.async===!1){let o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Kr(o))return se;let a=i.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Kr(o)?Promise.resolve(i.transform(o.value,s)).then(a=>({status:t.value,value:a})):se);_e.assertNever(i)}};In.create=(n,e,t)=>new In({schema:n,typeName:ue.ZodEffects,effect:e,...ye(t)});In.createWithPreprocess=(n,e,t)=>new In({schema:e,effect:{type:"preprocess",transform:n},typeName:ue.ZodEffects,...ye(t)});var Pn=class extends be{_parse(e){return this._getType(e)===X.undefined?Bt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Pn.create=(n,e)=>new Pn({innerType:n,typeName:ue.ZodOptional,...ye(e)});var cr=class extends be{_parse(e){return this._getType(e)===X.null?Bt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};cr.create=(n,e)=>new cr({innerType:n,typeName:ue.ZodNullable,...ye(e)});var Di=class extends be{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===X.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};Di.create=(n,e)=>new Di({innerType:n,typeName:ue.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ye(e)});var xi=class extends be{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return hs(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new un(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new un(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}};xi.create=(n,e)=>new xi({innerType:n,typeName:ue.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ye(e)});var bs=class extends be{_parse(e){if(this._getType(e)!==X.nan){let r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:X.nan,received:r.parsedType}),se}return{status:"valid",value:e.data}}};bs.create=n=>new bs({typeName:ue.ZodNaN,...ye(n)});var uE=Symbol("zod_brand"),uo=class extends be{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}},lo=class n extends be{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?se:s.status==="dirty"?(t.dirty(),pi(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{let i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?se:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,t){return new n({in:e,out:t,typeName:ue.ZodPipeline})}},Pi=class extends be{_parse(e){let t=this._def.innerType._parse(e),r=i=>(Kr(i)&&(i.value=Object.freeze(i.value)),i);return hs(t)?t.then(i=>r(i)):r(t)}unwrap(){return this._def.innerType}};Pi.create=(n,e)=>new Pi({innerType:n,typeName:ue.ZodReadonly,...ye(e)});function Lb(n,e){let t=typeof n=="function"?n(e):typeof n=="string"?{message:n}:n;return typeof t=="string"?{message:t}:t}function Hb(n,e={},t){return n?Vr.create().superRefine((r,i)=>{let s=n(r);if(s instanceof Promise)return s.then(o=>{if(!o){let a=Lb(e,r),c=a.fatal??t??!0;i.addIssue({code:"custom",...a,fatal:c})}});if(!s){let o=Lb(e,r),a=o.fatal??t??!0;i.addIssue({code:"custom",...o,fatal:a})}}):Vr.create()}var lE={object:ln.lazycreate},ue;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(ue||(ue={}));var dE=(n,e={message:`Input not instance of ${n.name}`})=>Hb(t=>t instanceof n,e),$b=Gr.create,Ub=mi.create,fE=bs.create,hE=gi.create,zb=yi.create,pE=vi.create,mE=ms.create,gE=bi.create,yE=Ci.create,vE=Vr.create,bE=Sr.create,CE=Bn.create,wE=gs.create,_E=Tr.create,SE=ln.create,TE=ln.strictCreate,EE=wi.create,RE=uc.create,DE=_i.create,xE=ar.create,PE=lc.create,kE=ys.create,IE=vs.create,OE=dc.create,ME=Si.create,NE=Ti.create,LE=Ei.create,FE=Ri.create,qE=Zr.create,AE=In.create,jE=Pn.create,HE=cr.create,$E=In.createWithPreprocess,UE=lo.create,zE=()=>$b().optional(),WE=()=>Ub().optional(),BE=()=>zb().optional(),KE={string:(n=>Gr.create({...n,coerce:!0})),number:(n=>mi.create({...n,coerce:!0})),boolean:(n=>yi.create({...n,coerce:!0})),bigint:(n=>gi.create({...n,coerce:!0})),date:(n=>vi.create({...n,coerce:!0}))};var GE=se;var Wb=Fe.object({name:Fe.string(),version:Fe.string(),author:Fe.string().optional(),description:Fe.string().optional(),tags:Fe.array(Fe.string()).optional(),thumbnail:Fe.string().optional(),license:Fe.string().optional()}),Bb=Fe.object({mass:Fe.number().optional(),friction:Fe.number().optional(),restitution:Fe.number().optional(),isStatic:Fe.boolean().optional(),colliderType:Fe.enum(["box","sphere","capsule","mesh"]).optional()}),Kb=Fe.object({personality:Fe.string().optional(),interactions:Fe.array(Fe.string()).optional(),knowledgeBaseId:Fe.string().optional()}),VE=Fe.object({metadata:Wb,script:Fe.string(),physics:Bb.optional(),ai:Kb.optional(),assets:Fe.record(Fe.union([Fe.string(),Fe.instanceof(Uint8Array)])).optional(),dependencies:Fe.record(Fe.string()).optional()});var Gb=class{constructor(n={}){this.config={endpoint:"https://api.holohub.io/v1",...n},this.mockRegistry=new Map,this.mockRegistry.set("turret-v1",{metadata:{name:"Standard Turret",version:"1.0.0",author:"HoloCorp",description:"A standard defense turret."},script:"class Turret { fire() { print('Bang!'); } }",physics:{mass:100,isStatic:!0,colliderType:"box"}})}async fetchAsset(n){console.log(`[HoloHub] Fetching asset: ${n}...`),await new Promise(t=>setTimeout(t,500));let e=this.mockRegistry.get(n);return e||(console.warn(`[HoloHub] Asset not found: ${n}`),null)}async publishAsset(n){console.log(`[HoloHub] Publishing asset: ${n.metadata.name}...`),await new Promise(t=>setTimeout(t,800));let e=`${n.metadata.name.toLowerCase().replace(/\s+/g,"-")}-${n.metadata.version}`;return this.mockRegistry.set(e,n),console.log(`[HoloHub] Published successfully. ID: ${e}`),e}async searchAssets(n){console.log(`[HoloHub] Searching for: ${n}...`),await new Promise(t=>setTimeout(t,300));let e=[];for(let t of this.mockRegistry.values())(t.metadata.name.toLowerCase().includes(n.toLowerCase())||t.metadata.description?.toLowerCase().includes(n.toLowerCase()))&&e.push(t);return e}};var fc=class{constructor(){this._onDidChangeTreeData=new ur.EventEmitter;this.onDidChangeTreeData=this._onDidChangeTreeData.event;this.client=new Gb}refresh(){this._onDidChangeTreeData.fire()}getTreeItem(e){return e}async getChildren(e){if(e)return[];try{return(await this.client.searchAssets("")).map(r=>new ih(r))}catch(t){return ur.window.showErrorMessage(`Failed to fetch HoloHub assets: ${t}`),[]}}},ih=class extends ur.TreeItem{constructor(t){super(t.metadata.name,ur.TreeItemCollapsibleState.None);this.asset=t;this.tooltip=t.metadata.description,this.description=`v${t.metadata.version}`,this.iconPath=new ur.ThemeIcon("package"),this.contextValue="smartAsset"}};var On=Vt(require("vscode")),Vb=Vt(require("path"));var ki=Vt(require("vscode")),fo=class n{constructor(){this._disposables=[]}static getInstance(){return n.instance||(n.instance=new n),n.instance}async handleMessage(e,t){switch(console.log("[RelayService] Received:",e),e.type){case"transform":await this.handleTransformUpdate(t,e.id,e.position,e.rotation,e.scale);break;case"voice_command":await this.handleVoiceCommand(t,e.text);break;case"inject_asset":await this.handleInjectAsset(t,e.assetId,e.assetType);break}}async handleTransformUpdate(e,t,r,i,s){let o=e.getText(),c=new RegExp(`(?:orb|object)\\s+["']?${t}["']?(?:\\s+using\\s+["'][\\w_]+["'])?(?:\\s+@[\\w]+)*\\s*\\{`,"g").exec(o);if(!c){console.warn(`[RelayService] Object "${t}" not found in document.`);return}let u=c.index,d=o.indexOf("{",u),v=1,b=d+1;for(let w=d+1;w<o.length;w++)if(o[w]==="{"?v++:o[w]==="}"&&v--,v===0){b=w;break}let g=o.slice(d+1,b);await(await ki.window.showTextDocument(e)).edit(w=>{r&&this.updateProperty(w,e,d,g,"position",`[${r.map(_=>parseFloat(_.toFixed(3))).join(", ")}]`),i&&this.updateProperty(w,e,d,g,"rotation",`[${i.map(_=>parseFloat(_.toFixed(3))).join(", ")}]`),s&&this.updateProperty(w,e,d,g,"scale",`[${s.map(_=>parseFloat(_.toFixed(3))).join(", ")}]`)})}updateProperty(e,t,r,i,s,o){let c=new RegExp(`${s}\\s*:\\s*(?:\\[[^\\]]+\\]|\\{[^\\}]+\\}|["'][^"']+["']|[\\d.-]+)`).exec(i);if(c){let u=r+1+c.index,d=u+c[0].length,v=new ki.Range(t.positionAt(u),t.positionAt(d));e.replace(v,`${s}: ${o}`)}else{let u=t.positionAt(r+1),d=t.lineAt(u.line),v=d.text.substring(0,d.firstNonWhitespaceCharacterIndex)+"  ";e.insert(u,`
${v}${s}: ${o}`)}}async handleVoiceCommand(e,t){ki.window.showInformationMessage(`Director Voice: "${t}"`)}async handleInjectAsset(e,t,r){let i=await ki.window.showTextDocument(e),s=`${t}_${Date.now().toString().slice(-4)}`,o="";switch(t){case"cube":o=`
@object "${s}" {
  model: "cube"
  color: "cyan"
  position: [0, 1, 0]
  @physics
  @grabbable
}
`;break;case"sphere":o=`
@object "${s}" {
  model: "sphere"
  color: "magenta"
  position: [2, 1, 0]
  @physics
  @grabbable
}
`;break;case"light":o=`
@object "${s}" {
  type: "light"
  color: "white"
  position: [0, 4, 0]
}
`;break;case"chair":o=`
@object "${s}" {
  model: "chair"
  color: "wood"
  scale: [1, 1, 1]
  position: [0, 0, 0]
  @grabbable
}
`;break;case"tree":o=`
@object "${s}" {
  model: "tree"
  color: "forest"
  scale: [2, 4, 2]
  position: [5, 0, 5]
}
`;break;case"robot":o=`
@object "${s}" {
  model: "robot"
  ai: { behavior: "greet" }
  position: [-3, 0, 0]
}
`;break;default:o=`
@object "${s}" {
  model: "cube"
  position: [0, 0, 0]
}
`}await i.edit(a=>{let c=e.positionAt(e.getText().length);a.insert(c,o)}),ki.window.showInformationMessage(`Director Mode: Injected ${s}`)}dispose(){this._disposables.forEach(e=>e.dispose())}};var bn=class n{constructor(e,t){this._disposables=[];this._panel=e,this._extensionUri=t,this._update(),this._panel.onDidDispose(()=>this.dispose(),null,this._disposables),this._panel.onDidChangeViewState(r=>{this._panel.visible&&this._update()},null,this._disposables),this._panel.webview.onDidReceiveMessage(r=>{switch(r.command){case"error":On.window.showErrorMessage(r.text);return;case"info":On.window.showInformationMessage(r.text);return;case"ready":this._currentDocument&&this._sendUpdate();return;case"transform":case"voice_command":case"inject_asset":this._currentDocument&&fo.getInstance().handleMessage(r,this._currentDocument);return;case"voice_start":On.window.showInputBox({prompt:"Say a command...",placeHolder:"e.g., 'Add a red cube at 0,1,0'"}).then(i=>{i&&this._currentDocument&&fo.getInstance().handleMessage({type:"voice_command",text:i},this._currentDocument)});return}},null,this._disposables),On.workspace.onDidChangeTextDocument(r=>{this._currentDocument&&r.document===this._currentDocument&&this._sendUpdate()},null,this._disposables)}static{this.viewType="holoscriptPreview"}static createOrShow(e,t){let r=On.ViewColumn.Beside;if(n.currentPanel){n.currentPanel._panel.reveal(r),t&&n.currentPanel.updateContent(t);return}let i=On.window.createWebviewPanel(n.viewType,"HoloScript Preview",r,{enableScripts:!0,retainContextWhenHidden:!0,localResourceRoots:[On.Uri.joinPath(e,"media"),On.Uri.joinPath(e,"node_modules")]});n.currentPanel=new n(i,e),t&&n.currentPanel.updateContent(t)}static revive(e,t){n.currentPanel=new n(e,t)}updateContent(e){this._currentDocument=e,this._panel.title=`Preview: ${Vb.basename(e.fileName)}`,this._sendUpdate()}_sendUpdate(){if(!this._currentDocument)return;let e=this._currentDocument.getText(),t=this._currentDocument.fileName;this._panel.webview.postMessage({command:"update",content:e,fileName:t,isHoloPlus:t.endsWith(".hsplus")})}dispose(){for(n.currentPanel=void 0,this._panel.dispose();this._disposables.length;){let e=this._disposables.pop();e&&e.dispose()}}_update(){this._panel.webview.html=this._getHtmlForWebview(this._panel.webview)}_getHtmlForWebview(e){let t=ZE();return`<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src ${e.cspSource} 'unsafe-inline'; script-src 'nonce-${t}' 'unsafe-eval' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; img-src ${e.cspSource} https: data:; connect-src https:;">
  <title>HoloScript Preview</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      overflow: hidden;
      background-color: #1e1e1e;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
    }
    #container {
      width: 100vw;
      height: 100vh;
      position: relative;
    }
    #canvas {
      width: 100%;
      height: 100%;
      display: block;
    }
    #overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      padding: 10px;
      background: linear-gradient(to bottom, rgba(0,0,0,0.7), transparent);
      color: #fff;
      font-size: 12px;
      pointer-events: none;
    }
    #stats {
      position: absolute;
      bottom: 10px;
      left: 10px;
      background: rgba(0,0,0,0.7);
      padding: 8px 12px;
      border-radius: 4px;
      color: #fff;
      font-size: 11px;
      font-family: monospace;
    }
    #toolbar {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 8px;
    }
    .toolbar-btn {
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 4px;
      color: #fff;
      padding: 6px 12px;
      cursor: pointer;
      font-size: 12px;
      transition: background 0.2s;
      pointer-events: auto;
    }
    .toolbar-btn:hover {
      background: rgba(255,255,255,0.2);
    }
    .toolbar-btn.active {
      background: #007acc;
      border-color: #007acc;
    }
    #error-panel {
      position: absolute;
      bottom: 50px;
      left: 10px;
      right: 10px;
      background: rgba(200, 50, 50, 0.9);
      padding: 12px;
      border-radius: 4px;
      color: #fff;
      font-size: 12px;
      display: none;
    }
    #error-panel.visible {
      display: block;
    }
    #loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #888;
      font-size: 14px;
      text-align: center;
    }
    .spinner {
      width: 40px;
      height: 40px;
      border: 3px solid rgba(255,255,255,0.1);
      border-top-color: #007acc;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 12px;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    #asset-browser {
      position: absolute;
      top: 50px;
      right: 10px;
      width: 200px;
      max-height: 400px;
      background: rgba(30, 30, 46, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 10px;
      display: none;
      overflow-y: auto;
      backdrop-filter: blur(10px);
    }
    #asset-browser.visible {
      display: block;
    }
    .asset-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }
    .asset-item {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
      padding: 8px;
      text-align: center;
      cursor: pointer;
      transition: background 0.2s;
    }
    .asset-item:hover {
      background: rgba(255, 255, 255, 0.15);
    }
    .asset-icon {
      font-size: 24px;
      margin-bottom: 4px;
    }
    .asset-name {
      font-size: 10px;
      color: #ccc;
    }
    .section-title {
      font-size: 11px;
      font-weight: bold;
      color: #888;
      margin: 8px 0 4px;
      text-transform: uppercase;
    }
    #inspector-overlay {
      position: absolute;
      background: rgba(0, 0, 0, 0.8);
      color: #0f0;
      padding: 8px;
      border: 1px solid #0f0;
      border-radius: 4px;
      font-family: monospace;
      font-size: 11px;
      pointer-events: none; /* Let mouse pass through */
      display: none;
      z-index: 100;
      white-space: pre;
    }
  </style>
  <script nonce="${t}">
    // Mock Assets Database
    const MOCK_ASSETS = [
      { id: 'cube', name: 'Cube', icon: '\u{1F4E6}', type: 'primitive' },
      { id: 'sphere', name: 'Sphere', icon: '\u26AA', type: 'primitive' },
      { id: 'light', name: 'Point Light', icon: '\u{1F4A1}', type: 'light' },
      { id: 'chair', name: 'Modern Chair', icon: '\u{1FA91}', type: 'model' },
      { id: 'tree', name: 'Pine Tree', icon: '\u{1F332}', type: 'model' },
      { id: 'robot', name: 'Bot', icon: '\u{1F916}', type: 'npc' }
    ];
  </script>
</head>
<body>
  <div id="container">
    <canvas id="canvas"></canvas>
    <div id="overlay">
      <span id="file-name">No file loaded</span>
    </div>
    <div id="inspector-overlay"></div>
    <div id="asset-browser">
      <div class="section-title">Result</div>
      <div class="asset-grid" id="asset-grid">
        <!-- Injected via JS -->
      </div>
    </div>
    <div id="toolbar">
      <button class="toolbar-btn" id="btn-reset" title="Reset Camera">\u{1F3A5} Reset</button>
      <button class="toolbar-btn" id="btn-wireframe" title="Toggle Wireframe">\u{1F532} Wire</button>
      <button class="toolbar-btn" id="btn-grid" title="Toggle Grid">\u{1F4D0} Grid</button>
      <button class="toolbar-btn" id="btn-axes" title="Toggle Axes">\u{1F4CA} Axes</button>
      <button class="toolbar-btn" id="btn-edit" title="Toggle Director Mode">\u{1F3AC} Edit Mode</button>
      <button class="toolbar-btn" id="btn-voice" title="Voice Command">\u{1F3A4} Voice</button>
      <button class="toolbar-btn" id="btn-assets" title="Asset Browser">\u{1F4E6} Assets</button>
      <div style="width: 1px; background: rgba(255,255,255,0.2); margin: 0 4px;"></div>
      <button class="toolbar-btn" id="btn-pause" title="Pause/Play">\u23F8\uFE0F</button>
      <button class="toolbar-btn" id="btn-step" title="Step Frame">\u23ED\uFE0F</button>
    </div>
    <div id="stats">
      <div>Objects: <span id="stat-objects">0</span></div>
      <div>FPS: <span id="stat-fps">0</span></div>
    </div>
    <div id="error-panel"></div>
    <div id="loading">
      <div class="spinner"></div>
      Initializing 3D Preview...
    </div>
  </div>

  <script nonce="${t}">
    // Import Three.js from CDN
    const scriptLoader = document.createElement('script');
    scriptLoader.src = 'https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js';
    scriptLoader.onload = initPreview;
    document.head.appendChild(scriptLoader);

    const vscode = acquireVsCodeApi();
    
    let scene, camera, renderer, controls, transformControl;
    let gridHelper, axesHelper;
    let objects = [];
    let animatedObjects = []; // Objects with built-in animations
    let particleSystems = []; // Particle emitters
    let wireframeMode = false;
    let showGrid = true;
    let showAxes = true;
    let editMode = false;
    let frameCount = 0;
    let lastTime = performance.now();
    let clock; // THREE.Clock for animations
    let gltfLoader; // For loading .glb/.gltf models
    let fontLoader; // For 3D text
    let defaultFont; // Cached font

    function initPreview() {
      // Load OrbitControls
      const orbitScript = document.createElement('script');
      orbitScript.src = 'https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js';
      orbitScript.onload = () => {
        // Load TransformControls
        const transformScript = document.createElement('script');
        transformScript.src = 'https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/TransformControls.js';
        transformScript.onload = () => {
          // Load GLTFLoader for .glb/.gltf models
          const gltfScript = document.createElement('script');
          gltfScript.src = 'https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js';
          gltfScript.onload = () => {
            // Load FontLoader for 3D text
            const fontScript = document.createElement('script');
            fontScript.src = 'https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/FontLoader.js';
            fontScript.onload = () => {
              // Load TextGeometry
              const textGeoScript = document.createElement('script');
              textGeoScript.src = 'https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/geometries/TextGeometry.js';
              textGeoScript.onload = setupScene;
              document.head.appendChild(textGeoScript);
            };
            document.head.appendChild(fontScript);
          };
          document.head.appendChild(gltfScript);
        };
        document.head.appendChild(transformScript);
      };
      document.head.appendChild(orbitScript);
    }

    function setupScene() {
      const canvas = document.getElementById('canvas');
      const container = document.getElementById('container');

      // Broadcaster for Director Mode
      function broadcastTransform(object) {
        if (!object.name) return;
        vscode.postMessage({
          command: 'transform',
          id: object.name,
          position: [object.position.x, object.position.y, object.position.z],
          rotation: [object.rotation.x, object.rotation.y, object.rotation.z],
          scale: [object.scale.x, object.scale.y, object.scale.z]
        });
      }

      // Clock for animations
      clock = new THREE.Clock();

      // Scene
      scene = new THREE.Scene();
      scene.background = new THREE.Color(0x1a1a2e);
      scene.fog = new THREE.Fog(0x1a1a2e, 10, 50);

      // Camera
      camera = new THREE.PerspectiveCamera(60, container.clientWidth / container.clientHeight, 0.1, 1000);
      camera.position.set(5, 5, 5);

      // Renderer with enhanced settings
      renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
      renderer.setSize(container.clientWidth, container.clientHeight);
      renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
      renderer.shadowMap.enabled = true;
      renderer.shadowMap.type = THREE.PCFSoftShadowMap;
      renderer.outputEncoding = THREE.sRGBEncoding;
      renderer.toneMapping = THREE.ACESFilmicToneMapping;
      renderer.toneMappingExposure = 0.9;
      renderer.physicallyCorrectLights = true;

      // Controls
      controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.05;
      controls.minDistance = 1;
      controls.maxDistance = 100;

      // Transform Controls (Director Mode)
      if (THREE.TransformControls) {
        transformControl = new THREE.TransformControls(camera, renderer.domElement);
        transformControl.addEventListener('dragging-changed', function (event) {
          controls.enabled = !event.value;
        });
        transformControl.addEventListener('mouseUp', function () {
          if (transformControl.object) {
            broadcastTransform(transformControl.object);
          }
        });
        scene.add(transformControl);
      }

      // Raycaster for selection
      const raycaster = new THREE.Raycaster();
      const mouse = new THREE.Vector2();

      function onMouseClick(event) {
        if (!editMode) return;
        
        // Calculate mouse position in normalized device coordinates
        const rect = renderer.domElement.getBoundingClientRect();
        mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
        mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;

        raycaster.setFromCamera(mouse, camera);

        // Intersect objects (filter out helpers)
        const intersects = raycaster.intersectObjects(objects, true);
        
        if (intersects.length > 0) {
          // Find the root object (handle grouped meshes)
          let target = intersects[0].object;
          while (target.parent && target.parent !== scene && !objects.includes(target)) {
             target = target.parent;
          }
          
          if (objects.includes(target)) {
            transformControl.attach(target);
            document.getElementById('file-name').textContent = \`Selected: \${target.name}\`;
          }
        } else {
          transformControl.detach();
          document.getElementById('file-name').textContent = 'No selection';
        }
      }

      window.addEventListener('click', onMouseClick);
      
      // Inspector Hover Logic (Phase 5)
      window.addEventListener('mousemove', (event) => {
        const inspector = document.getElementById('inspector-overlay');
        
        if (!window.isPaused) {
          inspector.style.display = 'none';
          return;
        }

        const rect = renderer.domElement.getBoundingClientRect();
        mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
        mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;

        raycaster.setFromCamera(mouse, camera);
        const intersects = raycaster.intersectObjects(objects, true);

        if (intersects.length > 0) {
          let target = intersects[0].object;
          // Traverse up to find root valid object
          while (target.parent && target.parent !== scene && !objects.includes(target)) {
             target = target.parent;
          }

          if (objects.includes(target)) {
             const pos = target.position;
             const rot = target.rotation;
             const scale = target.scale;
             
             inspector.style.display = 'block';
             inspector.style.left = (event.clientX + 10) + 'px';
             inspector.style.top = (event.clientY + 10) + 'px';
             inspector.innerHTML = \`Please wait...\`; // Temp
             inspector.innerText = 
               \`Object: \${target.name || 'Unnamed'}\\n\` +
               \`Pos: [\${pos.x.toFixed(2)}, \${pos.y.toFixed(2)}, \${pos.z.toFixed(2)}]\\n\` +
               \`Rot: [\${rot.x.toFixed(2)}, \${rot.y.toFixed(2)}, \${rot.z.toFixed(2)}]\\n\` +
               \`Scale: [\${scale.x.toFixed(2)}, \${scale.y.toFixed(2)}, \${scale.z.toFixed(2)}]\`;
             return;
          }
        }
        
        inspector.style.display = 'none';
      });

      // Clean up listener on dispose needed later? For simplicity we just add it once.

      // Grid
      gridHelper = new THREE.GridHelper(20, 20, 0x444444, 0x333333);
      scene.add(gridHelper);

      // Axes
      axesHelper = new THREE.AxesHelper(5);
      scene.add(axesHelper);

      // Hemisphere light (sky/ground ambient)
      const hemiLight = new THREE.HemisphereLight(0x87CEEB, 0x3d3d5c, 0.4);
      scene.add(hemiLight);

      // Key light (main directional)
      const keyLight = new THREE.DirectionalLight(0xfff5e6, 1.0);
      keyLight.position.set(5, 10, 5);
      keyLight.castShadow = true;
      keyLight.shadow.mapSize.width = 2048;
      keyLight.shadow.mapSize.height = 2048;
      keyLight.shadow.camera.near = 0.1;
      keyLight.shadow.camera.far = 50;
      keyLight.shadow.camera.left = -15;
      keyLight.shadow.camera.right = 15;
      keyLight.shadow.camera.top = 15;
      keyLight.shadow.camera.bottom = -15;
      keyLight.shadow.bias = -0.0005;
      scene.add(keyLight);

      // Fill light (softer, opposite side)
      const fillLight = new THREE.DirectionalLight(0x8ec8ff, 0.4);
      fillLight.position.set(-5, 3, -5);
      scene.add(fillLight);

      // Rim light (back lighting for depth)
      const rimLight = new THREE.DirectionalLight(0xffffff, 0.3);
      rimLight.position.set(0, 5, -10);
      scene.add(rimLight);

      // Create procedural environment map for reflections
      const pmremGenerator = new THREE.PMREMGenerator(renderer);
      pmremGenerator.compileEquirectangularShader();
      const envScene = new THREE.Scene();
      envScene.background = new THREE.Color(0x2a2a4a);
      const envTexture = pmremGenerator.fromScene(envScene, 0.04).texture;
      scene.environment = envTexture;

      // Ground plane (visible dark floor)
      const groundGeometry = new THREE.PlaneGeometry(100, 100);
      const groundMaterial = new THREE.MeshStandardMaterial({ 
        color: 0x0f0f1a, 
        roughness: 0.8,
        metalness: 0.2
      });
      const ground = new THREE.Mesh(groundGeometry, groundMaterial);
      ground.rotation.x = -Math.PI / 2;
      ground.receiveShadow = true;
      scene.add(ground);

      // Initialize GLTF loader for .glb/.gltf models
      if (THREE.GLTFLoader) {
        gltfLoader = new THREE.GLTFLoader();
      }

      // Initialize Font loader and load default font
      if (THREE.FontLoader) {
        fontLoader = new THREE.FontLoader();
        fontLoader.load('https://cdn.jsdelivr.net/npm/three@0.128.0/examples/fonts/helvetiker_regular.typeface.json', (font) => {
          defaultFont = font;
        });
      }

      // Hide loading
      document.getElementById('loading').style.display = 'none';

      // Setup toolbar events
      document.getElementById('btn-reset').addEventListener('click', resetCamera);
      document.getElementById('btn-wireframe').addEventListener('click', toggleWireframe);
      document.getElementById('btn-grid').addEventListener('click', toggleGrid);
      document.getElementById('btn-axes').addEventListener('click', toggleAxes);
      document.getElementById('btn-edit').addEventListener('click', toggleEditMode);
      document.getElementById('btn-assets').addEventListener('click', toggleAssetBrowser);
      document.getElementById('btn-voice').addEventListener('click', () => {
        vscode.postMessage({ command: 'voice_start' });
      });

      // Debugger Controls (Phase 5)
      let isPaused = false;
      let stepOnce = false;

      document.getElementById('btn-pause').addEventListener('click', () => {
        isPaused = !isPaused;
        document.getElementById('btn-pause').textContent = isPaused ? '\u25B6\uFE0F' : '\u23F8\uFE0F';
        document.getElementById('btn-step').disabled = !isPaused;
      });

      document.getElementById('btn-step').addEventListener('click', () => {
        if (isPaused) stepOnce = true;
      });
      
      // Initialize Asset Browser
      const assetGrid = document.getElementById('asset-grid');
      MOCK_ASSETS.forEach(asset => {
        const item = document.createElement('div');
        item.className = 'asset-item';
        item.innerHTML = \`
          <div class="asset-icon">\${asset.icon}</div>
          <div class="asset-name">\${asset.name}</div>
        \`;
        item.onclick = () => {
          vscode.postMessage({ 
            command: 'inject_asset', 
            assetId: asset.id,
            assetType: asset.type 
          });
        };
        assetGrid.appendChild(item);
      });

      // Handle resize
      window.addEventListener('resize', onWindowResize);

      // Start animation
      // animate(); // Move animate call inside to capture variables scope if needed, 
      // but animate is defined outside. We need to modify animate() separately or pass flags.
      // Better approach: modify existing animate() to check isPaused.
      // Since animate() is defined outside initPreview(), we need to make isPaused global or accessible.
      // Let's attach them to window or move animate inside.
      // For now, let's assume we modify animate() below.
      
      window.isPaused = false;
      window.stepOnce = false;
      document.getElementById('btn-pause').onclick = () => {
        window.isPaused = !window.isPaused;
        document.getElementById('btn-pause').textContent = window.isPaused ? '\u25B6\uFE0F' : '\u23F8\uFE0F';
      };
      document.getElementById('btn-step').onclick = () => {
        if (window.isPaused) window.stepOnce = true;
      };

      animate();

      // Notify extension we're ready
      vscode.postMessage({ command: 'ready' });
    }

    function animate() {
      requestAnimationFrame(animate);

      // Debugger: Pause/Step Logic
      const isPaused = window.isPaused;
      const stepOnce = window.stepOnce;
      
      if (isPaused && !stepOnce) {
        controls.update();
        renderer.render(scene, camera);
        return; // Skip physics/animations
      }
      
      if (stepOnce) {
        window.stepOnce = false; // Reset single step
      }
      
      const elapsed = clock.getElapsedTime();
      const delta = clock.getDelta();
      
      // Update animated objects
      animatedObjects.forEach(item => {
        const mesh = item.mesh;
        const anim = item.animation;
        
        switch (anim.type) {
          case 'spin':
          case 'rotate':
            mesh.rotation.y += (anim.speed || 1) * 0.02;
            break;
          case 'float':
          case 'hover':
            mesh.position.y = item.baseY + Math.sin(elapsed * (anim.speed || 1)) * (anim.amplitude || 0.3);
            break;
          case 'pulse':
          case 'breathe':
            const scale = 1 + Math.sin(elapsed * (anim.speed || 2)) * (anim.amplitude || 0.1);
            mesh.scale.setScalar(item.baseScale * scale);
            break;
          case 'orbit':
            const angle = elapsed * (anim.speed || 1);
            const radius = anim.radius || 2;
            mesh.position.x = item.baseX + Math.cos(angle) * radius;
            mesh.position.z = item.baseZ + Math.sin(angle) * radius;
            break;
          case 'sway':
            mesh.rotation.z = Math.sin(elapsed * (anim.speed || 1)) * (anim.amplitude || 0.1);
            break;
          case 'bob':
            mesh.position.y = item.baseY + Math.abs(Math.sin(elapsed * (anim.speed || 2))) * (anim.amplitude || 0.5);
            break;
          case 'flicker':
            if (mesh.material.emissive) {
              mesh.material.emissiveIntensity = 0.3 + Math.random() * 0.7;
            }
            break;
          case 'rainbow':
            mesh.material.color.setHSL((elapsed * (anim.speed || 0.1)) % 1, 0.8, 0.5);
            break;
        }
      });
      
      // Update particle systems
      particleSystems.forEach(particles => {
        const positions = particles.geometry.attributes.position.array;
        const velocities = particles.userData.velocities;
        for (let i = 0; i < positions.length / 3; i++) {
          positions[i * 3] += velocities[i * 3];
          positions[i * 3 + 1] += velocities[i * 3 + 1];
          positions[i * 3 + 2] += velocities[i * 3 + 2];
          // Reset particles that go too high
          if (positions[i * 3 + 1] > 3) {
            positions[i * 3] = (Math.random() - 0.5) * 2;
            positions[i * 3 + 1] = 0;
            positions[i * 3 + 2] = (Math.random() - 0.5) * 2;
          }
        }
        particles.geometry.attributes.position.needsUpdate = true;
      });
      
      controls.update();
      renderer.render(scene, camera);
      
      // FPS counter
      frameCount++;
      const now = performance.now();
      if (now - lastTime >= 1000) {
        document.getElementById('stat-fps').textContent = frameCount;
        frameCount = 0;
        lastTime = now;
      }
    }

    function onWindowResize() {
      const container = document.getElementById('container');
      camera.aspect = container.clientWidth / container.clientHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(container.clientWidth, container.clientHeight);
    }

    function resetCamera() {
      camera.position.set(5, 5, 5);
      controls.target.set(0, 0, 0);
      controls.update();
    }

    function toggleWireframe() {
      wireframeMode = !wireframeMode;
      objects.forEach(obj => {
        if (obj.material) {
          obj.material.wireframe = wireframeMode;
        }
      });
      document.getElementById('btn-wireframe').classList.toggle('active', wireframeMode);
    }

    function toggleGrid() {
      showGrid = !showGrid;
      gridHelper.visible = showGrid;
      document.getElementById('btn-grid').classList.toggle('active', showGrid);
    }

    function toggleAxes() {
      showAxes = !showAxes;
      axesHelper.visible = showAxes;
      document.getElementById('btn-axes').classList.toggle('active', showAxes);
    }

    function toggleEditMode() {
      editMode = !editMode;
      document.getElementById('btn-edit').classList.toggle('active', editMode);
      
      if (!editMode) {
        if (transformControl) transformControl.detach();
        document.getElementById('file-name').textContent = 'Review Mode';
      } else {
        document.getElementById('file-name').textContent = 'Director Mode: Click objects to move';
      }
    }

    function toggleAssetBrowser() {
      const browser = document.getElementById('asset-browser');
      browser.classList.toggle('visible');
      document.getElementById('btn-assets').classList.toggle('active', browser.classList.contains('visible'));
    }

    function clearScene() {
      objects.forEach(obj => {
        scene.remove(obj);
        if (obj.geometry) obj.geometry.dispose();
        if (obj.material) {
          if (Array.isArray(obj.material)) {
            obj.material.forEach(m => m.dispose());
          } else {
            obj.material.dispose();
          }
        }
      });
      objects = [];
      animatedObjects = []; // Clear animation tracking
      particleSystems = []; // Clear particle systems
      scene.fog = null; // Clear fog
      scene.background = new THREE.Color(0x1a1a2e); // Reset to default background
    }

    // Helper to convert color names/hex to Three.js color
    function getColorValue(colorStr) {
      if (!colorStr) return 0x1a1a2e;
      colorStr = colorStr.toLowerCase().replace('#', '');
      if (colorStr.match(/^[0-9a-f]{6}$/i)) {
        return parseInt(colorStr, 16);
      }
      const colorNames = {
        red: 0xe53935, green: 0x43a047, blue: 0x1e88e5,
        yellow: 0xfdd835, cyan: 0x00acc1, magenta: 0xd81b60,
        white: 0xfafafa, black: 0x212121, gray: 0x757575,
        purple: 0x8e24aa, orange: 0xfb8c00, pink: 0xf06292,
        navy: 0x283593, midnight: 0x1a237e, sky: 0x4fc3f7
      };
      return colorNames[colorStr] || 0x1a1a2e;
    }

    // Apply skybox/environment background
    function applySkybox(skyboxType) {
      switch (skyboxType) {
        case 'sunset':
        case 'dusk':
          scene.background = createGradientTexture(0xffd27f, 0xff6b6b, 0x1a0a3e);
          break;
        case 'night':
        case 'midnight':
        case 'stars':
          scene.background = createStarfield();
          break;
        case 'space':
        case 'nebula':
          scene.background = createNebula();
          break;
        case 'sky':
        case 'day':
        case 'daytime':
          scene.background = createGradientTexture(0x87ceeb, 0x4fc3f7, 0xffffff);
          break;
        case 'overcast':
        case 'cloudy':
          scene.background = createGradientTexture(0x9e9e9e, 0xbdbdbd, 0xe0e0e0);
          break;
        case 'underwater':
        case 'ocean':
          scene.background = createGradientTexture(0x006994, 0x003d5b, 0x001524);
          scene.fog = new THREE.FogExp2(0x003d5b, 0.05);
          break;
        case 'forest':
        case 'jungle':
          scene.background = createGradientTexture(0x2e7d32, 0x1b5e20, 0x0d3010);
          scene.fog = new THREE.FogExp2(0x1b5e20, 0.03);
          break;
        case 'void':
        case 'dark':
          scene.background = new THREE.Color(0x0a0a0f);
          break;
        case 'neon':
        case 'cyberpunk':
          scene.background = createGradientTexture(0x0d0221, 0x1a0a3e, 0x7b1fa2);
          break;
        default:
          // Try to use as a color
          scene.background = new THREE.Color(getColorValue(skyboxType));
      }
    }

    // Create gradient texture for skybox
    function createGradientTexture(topColor, midColor, bottomColor) {
      const canvas = document.createElement('canvas');
      canvas.width = 2;
      canvas.height = 512;
      const ctx = canvas.getContext('2d');
      const gradient = ctx.createLinearGradient(0, 0, 0, 512);
      gradient.addColorStop(0, '#' + topColor.toString(16).padStart(6, '0'));
      gradient.addColorStop(0.5, '#' + midColor.toString(16).padStart(6, '0'));
      gradient.addColorStop(1, '#' + bottomColor.toString(16).padStart(6, '0'));
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, 2, 512);
      const texture = new THREE.CanvasTexture(canvas);
      texture.mapping = THREE.EquirectangularReflectionMapping;
      return texture;
    }

    // Create procedural starfield
    function createStarfield() {
      const canvas = document.createElement('canvas');
      canvas.width = 1024;
      canvas.height = 512;
      const ctx = canvas.getContext('2d');
      
      // Dark gradient background
      const gradient = ctx.createLinearGradient(0, 0, 0, 512);
      gradient.addColorStop(0, '#0a0a1a');
      gradient.addColorStop(0.5, '#0f0f2a');
      gradient.addColorStop(1, '#1a1a3e');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, 1024, 512);
      
      // Add stars
      for (let i = 0; i < 500; i++) {
        const x = Math.random() * 1024;
        const y = Math.random() * 512;
        const size = Math.random() * 2;
        const brightness = Math.random() * 0.8 + 0.2;
        ctx.fillStyle = 'rgba(255, 255, 255, ' + brightness + ')';
        ctx.beginPath();
        ctx.arc(x, y, size, 0, Math.PI * 2);
        ctx.fill();
      }
      
      const texture = new THREE.CanvasTexture(canvas);
      texture.mapping = THREE.EquirectangularReflectionMapping;
      return texture;
    }

    // Create procedural nebula
    function createNebula() {
      const canvas = document.createElement('canvas');
      canvas.width = 1024;
      canvas.height = 512;
      const ctx = canvas.getContext('2d');
      
      // Deep space gradient
      const gradient = ctx.createRadialGradient(512, 256, 50, 512, 256, 512);
      gradient.addColorStop(0, '#7b1fa2');
      gradient.addColorStop(0.3, '#4a148c');
      gradient.addColorStop(0.6, '#1a0a3e');
      gradient.addColorStop(1, '#0a0a1a');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, 1024, 512);
      
      // Add nebula clouds
      for (let i = 0; i < 20; i++) {
        const x = Math.random() * 1024;
        const y = Math.random() * 512;
        const radius = Math.random() * 100 + 50;
        const hue = Math.random() * 60 + 260; // Purple to pink
        const cloudGradient = ctx.createRadialGradient(x, y, 0, x, y, radius);
        cloudGradient.addColorStop(0, 'hsla(' + hue + ', 70%, 50%, 0.2)');
        cloudGradient.addColorStop(1, 'transparent');
        ctx.fillStyle = cloudGradient;
        ctx.fillRect(0, 0, 1024, 512);
      }
      
      // Add stars
      for (let i = 0; i < 300; i++) {
        const x = Math.random() * 1024;
        const y = Math.random() * 512;
        const size = Math.random() * 1.5;
        ctx.fillStyle = 'rgba(255, 255, 255, ' + (Math.random() * 0.6 + 0.4) + ')';
        ctx.beginPath();
        ctx.arc(x, y, size, 0, Math.PI * 2);
        ctx.fill();
      }
      
      const texture = new THREE.CanvasTexture(canvas);
      texture.mapping = THREE.EquirectangularReflectionMapping;
      return texture;
    }

    function parseAndRender(content, isHoloPlus) {
      clearScene();
      const errorPanel = document.getElementById('error-panel');
      errorPanel.classList.remove('visible');

      try {
        // Helper to extract brace-balanced content
        function extractBalancedBraces(str, startIdx) {
          let depth = 0;
          let start = -1;
          for (let i = startIdx; i < str.length; i++) {
            if (str[i] === '{') {
              if (depth === 0) start = i + 1;
              depth++;
            } else if (str[i] === '}') {
              depth--;
              if (depth === 0) return str.slice(start, i);
            }
          }
          return '';
        }

        // Parse spatial_group and group positions for offset
        const groupOffsets = {};
        const groupPattern = /(?:spatial_group|group)\\s+["']?([\\w_]+)["']?\\s*\\{/g;
        let groupMatch;
        while ((groupMatch = groupPattern.exec(content)) !== null) {
          const groupName = groupMatch[1];
          const groupContent = extractBalancedBraces(content, groupMatch.index);
          const posMatch = groupContent.match(/position\\s*:\\s*\\[([^\\]]+)\\]/);
          groupOffsets[groupName] = posMatch 
            ? posMatch[1].split(',').map(n => parseFloat(n.trim()) || 0)
            : [0, 0, 0];
        }

        // Parse templates to inherit geometry
        const templates = {};
        const templatePattern = /template\\s+["']([\\w_]+)["']\\s*\\{/g;
        let templateMatch;
        while ((templateMatch = templatePattern.exec(content)) !== null) {
          const templateName = templateMatch[1];
          const templateContent = extractBalancedBraces(content, templateMatch.index);
          const geoMatch = templateContent.match(/(?:model|geometry)\\s*:\\s*["']([\\w]+)["']/);
          const scaleMatch = templateContent.match(/scale\\s*:\\s*(?:\\[([^\\]]+)\\]|([\\d.]+))/);
          templates[templateName] = {
            geometry: geoMatch ? geoMatch[1].toLowerCase() : 'cube',
            scale: scaleMatch 
              ? (scaleMatch[1] ? scaleMatch[1].split(',').map(n => parseFloat(n.trim()) || 1) : [parseFloat(scaleMatch[2])])
              : [1, 1, 1]
          };
        }

        // Parse environment/skybox settings
        const envPattern = /environment\\s*\\{([^}]+)\\}/;
        const envMatch = content.match(envPattern);
        if (envMatch) {
          const envContent = envMatch[1];
          const skyboxMatch = envContent.match(/skybox\\s*:\\s*["']([^"']+)["']/);
          const ambientMatch = envContent.match(/ambient_light\\s*:\\s*([\\d.]+)/);
          const fogMatch = envContent.match(/fog\\s*:\\s*["']([^"']+)["']/);
          const fogDensityMatch = envContent.match(/fog_density\\s*:\\s*([\\d.]+)/);
          
          if (skyboxMatch) {
            const skyboxType = skyboxMatch[1].toLowerCase();
            applySkybox(skyboxType);
          }
          if (ambientMatch) {
            const intensity = parseFloat(ambientMatch[1]) || 0.3;
            // Update hemisphere light intensity
            scene.traverse((obj) => {
              if (obj.isHemisphereLight) obj.intensity = intensity;
            });
          }
          if (fogMatch) {
            const fogColor = getColorValue(fogMatch[1]);
            const density = fogDensityMatch ? parseFloat(fogDensityMatch[1]) : 0.02;
            scene.fog = new THREE.FogExp2(fogColor, density);
          }
        }

        // Also parse standalone skybox: property
        const standaloneSkybox = content.match(/skybox\\s*:\\s*["']([^"']+)["']/);
        if (standaloneSkybox && !envMatch) {
          applySkybox(standaloneSkybox[1].toLowerCase());
        }

        // Enhanced pattern to match objects (handles @traits, object[], nested braces)
        // Matches: orb name, object name, object Name @trait1 @trait2, object[] Name @trait, button, slider
        const orbPattern = /(?:orb|object(?:\\[\\])?|button|slider)\\s+["']?([\\w_]+)["']?(?:\\s+using\\s+["']([\\w_]+)["'])?(?:\\s+@[\\w]+)*\\s*\\{/g;
        let match;
        let count = 0;

        while ((match = orbPattern.exec(content)) !== null) {
          const name = match[1];
          const usingTemplate = match[2];
          const props = extractBalancedBraces(content, match.index);

          // Check if inside a spatial_group for position offset
          let groupOffset = [0, 0, 0];
          for (const [groupName, offset] of Object.entries(groupOffsets)) {
            const groupIdx = content.indexOf('spatial_group "' + groupName + '"');
            if (groupIdx !== -1 && groupIdx < match.index) {
              const groupEnd = content.indexOf('}', content.indexOf('{', groupIdx));
              if (match.index < groupEnd || groupEnd === -1) {
                groupOffset = offset;
              }
            }
          }

          // Parse position - supports array [x,y,z], object { x: 0, y: 1, z: 2 }, and localPosition fallback
          const posArrayMatch = props.match(/position\\s*:\\s*\\[([^\\]]+)\\]/);
          const posObjMatch = props.match(/position\\s*:\\s*\\{\\s*x\\s*:\\s*([\\d.-]+)\\s*,\\s*y\\s*:\\s*([\\d.-]+)\\s*,\\s*z\\s*:\\s*([\\d.-]+)\\s*\\}/);
          const localPosObjMatch = props.match(/localPosition\\s*:\\s*\\{\\s*x\\s*:\\s*([\\d.-]+)\\s*,\\s*y\\s*:\\s*([\\d.-]+)\\s*,\\s*z\\s*:\\s*([\\d.-]+)\\s*\\}/);
          let position;
          if (posArrayMatch) {
            position = posArrayMatch[1].split(',').map((n, i) => (parseFloat(n.trim()) || 0) + groupOffset[i]);
          } else if (posObjMatch) {
            position = [
              (parseFloat(posObjMatch[1]) || 0) + groupOffset[0],
              (parseFloat(posObjMatch[2]) || 0) + groupOffset[1],
              (parseFloat(posObjMatch[3]) || 0) + groupOffset[2]
            ];
          } else if (localPosObjMatch) {
            position = [
              (parseFloat(localPosObjMatch[1]) || 0) + groupOffset[0],
              (parseFloat(localPosObjMatch[2]) || 0) + groupOffset[1],
              (parseFloat(localPosObjMatch[3]) || 0) + groupOffset[2]
            ];
          } else {
            position = groupOffset.slice();
          }

          // Parse scale (supports single number, [x,y,z] array, { x, y, z } object, or size: fallback)
          const scaleMatchArr = props.match(/scale\\s*:\\s*\\[([^\\]]+)\\]/);
          const scaleMatchNum = props.match(/scale\\s*:\\s*([\\d.]+)/);
          const scaleMatchObj = props.match(/scale\\s*:\\s*\\{\\s*x\\s*:\\s*([\\d.-]+)\\s*,\\s*y\\s*:\\s*([\\d.-]+)\\s*,\\s*z\\s*:\\s*([\\d.-]+)\\s*\\}/);
          const sizeMatchArr = props.match(/size\\s*:\\s*\\[([^\\]]+)\\]/);
          const sizeMatchObj = props.match(/size\\s*:\\s*\\{\\s*width\\s*:\\s*([\\d.-]+)\\s*,\\s*(?:depth|height)\\s*:\\s*([\\d.-]+)\\s*\\}/);
          let scale;
          if (scaleMatchArr) {
            scale = scaleMatchArr[1].split(',').map(n => parseFloat(n.trim()) || 1);
          } else if (scaleMatchObj) {
            scale = [
              parseFloat(scaleMatchObj[1]) || 1,
              parseFloat(scaleMatchObj[2]) || 1,
              parseFloat(scaleMatchObj[3]) || 1
            ];
          } else if (scaleMatchNum) {
            const s = parseFloat(scaleMatchNum[1]) || 1;
            scale = [s, s, s];
          } else if (sizeMatchArr) {
            const dims = sizeMatchArr[1].split(',').map(n => parseFloat(n.trim()) || 1);
            scale = [dims[0] || 1, 0.1, dims[1] || dims[0] || 1]; // size: [width, depth] \u2192 flat plane
          } else if (sizeMatchObj) {
            scale = [parseFloat(sizeMatchObj[1]) || 1, 0.1, parseFloat(sizeMatchObj[2]) || 1];
          } else if (usingTemplate && templates[usingTemplate]) {
            const ts = templates[usingTemplate].scale;
            scale = ts.length === 1 ? [ts[0], ts[0], ts[0]] : ts;
          } else {
            scale = [1, 1, 1];
          }

          // Parse rotation (supports [x,y,z] array or { x, y, z } object notation)
          const rotMatchArr = props.match(/rotation\\s*:\\s*\\[([^\\]]+)\\]/);
          const rotMatchObj = props.match(/rotation\\s*:\\s*\\{\\s*x\\s*:\\s*([\\d.-]+)\\s*,\\s*y\\s*:\\s*([\\d.-]+)\\s*,\\s*z\\s*:\\s*([\\d.-]+)\\s*\\}/);
          let rotation;
          if (rotMatchArr) {
            rotation = rotMatchArr[1].split(',').map(n => (parseFloat(n.trim()) || 0) * Math.PI / 180);
          } else if (rotMatchObj) {
            rotation = [
              (parseFloat(rotMatchObj[1]) || 0) * Math.PI / 180,
              (parseFloat(rotMatchObj[2]) || 0) * Math.PI / 180,
              (parseFloat(rotMatchObj[3]) || 0) * Math.PI / 180
            ];
          } else {
            rotation = [0, 0, 0];
          }

          // Parse color - expanded palette
          const colorMatch = props.match(/color\\s*:\\s*["']?#?([\\w]+)["']?/);
          let color = 0x4a9eff;
          if (colorMatch) {
            const colorStr = colorMatch[1];
            if (colorStr.match(/^[0-9a-f]{6}$/i)) {
              color = parseInt(colorStr, 16);
            } else {
              const colorNames = {
                // Primary
                red: 0xe53935, green: 0x43a047, blue: 0x1e88e5,
                yellow: 0xfdd835, cyan: 0x00acc1, magenta: 0xd81b60,
                // Neutrals
                white: 0xfafafa, black: 0x212121, gray: 0x757575, grey: 0x757575,
                silver: 0xbdbdbd, charcoal: 0x424242,
                // Warm tones
                orange: 0xfb8c00, coral: 0xff7043, salmon: 0xf48fb1,
                gold: 0xffc107, bronze: 0xcd7f32, copper: 0xb87333,
                brown: 0x795548, tan: 0xd4a574, beige: 0xc8ad7f, terracotta: 0xe2725b, clay: 0xb66a50, sienna: 0xa0522d,
                // Cool tones
                purple: 0x8e24aa, violet: 0x7e57c2, indigo: 0x5c6bc0,
                navy: 0x283593, teal: 0x00897b, aqua: 0x4dd0e1,
                turquoise: 0x26c6da, mint: 0x80cbc4, lime: 0xc0ca33,
                // Nature
                forest: 0x2e7d32, olive: 0x827717, sage: 0x9ccc65,
                sky: 0x4fc3f7, ocean: 0x0277bd, midnight: 0x1a237e,
                sand: 0xd7ccc8, stone: 0x8d6e63, slate: 0x607d8b,
                // Metals
                steel: 0x78909c, chrome: 0xe0e0e0, brass: 0xc9a227,
                platinum: 0xe5e4e2, rust: 0xb7410e, titanium: 0x878681,
                // Fantasy / Sci-fi
                neon: 0x39ff14, plasma: 0xff073a, hologram: 0x00fff7,
                energy: 0xffea00, void: 0x0d0221, nebula: 0x7b1fa2,
                crystal: 0xb3e5fc, lava: 0xff5722, ice: 0xe1f5fe,
                // Materials
                wood: 0x8d6e63, leather: 0x795548, fabric: 0x9e9d9e,
                glass: 0xe3f2fd, marble: 0xf5f5f5, obsidian: 0x1c1c1c,
                // UI colors
                success: 0x4caf50, warning: 0xff9800, error: 0xf44336,
                info: 0x2196f3, primary: 0x3f51b5, secondary: 0x9c27b0,
                // Pink/rose variants
                pink: 0xf06292, rose: 0xec407a, blush: 0xf8bbd0,
                hotpink: 0xff69b4, fuchsia: 0xc51162
              };
              color = colorNames[colorStr.toLowerCase()] || color;
            }
          }

          // Parse model/geometry type (support 'model', 'geometry', and 'type' properties)
          // Also check for .glb/.gltf file paths
          const modelPathMatch = props.match(/(?:model|src)\\s*:\\s*["']([^"']+.(?:glb|gltf))["']/i);
          const modelMatch = props.match(/(?:model|geometry)\\s*:\\s*["']([\\w]+)["']/);
          const typeMatch = props.match(/type\\s*:\\s*["']([\\w]+)["']/);
          const textMatch = props.match(/text\\s*:\\s*["']([^"']+)["']/);
          let modelType = 'cube';
          let modelPath = null;
          let textContent = textMatch ? textMatch[1] : null;
          
          if (modelPathMatch) {
            modelPath = modelPathMatch[1];
            modelType = 'glb'; // Special marker for GLB loading
          } else if (modelMatch) {
            modelType = modelMatch[1].toLowerCase();
          } else if (typeMatch) {
            // Map type values to geometry types
            const typeValue = typeMatch[1].toLowerCase();
            const typeMap = {
              plane: 'plane', environment: 'sphere', directional: 'cone',
              ambient: 'sphere', audio: 'sphere', panel: 'cube',
              text: 'text', label: 'text', particles: 'particles', emitter: 'particles'
            };
            modelType = typeMap[typeValue] || typeValue;
          } else if (textContent) {
            modelType = 'text';
          } else if (usingTemplate && templates[usingTemplate]) {
            modelType = templates[usingTemplate].geometry;
          }

          // Handle GLB/GLTF model loading
          if (modelType === 'glb' && gltfLoader && modelPath) {
            // Create placeholder while loading
            const placeholder = new THREE.Mesh(
              new THREE.BoxGeometry(0.5, 0.5, 0.5),
              new THREE.MeshBasicMaterial({ color: 0x888888, wireframe: true })
            );
            placeholder.position.set(position[0], position[1], position[2]);
            placeholder.name = name + '_loading';
            scene.add(placeholder);
            objects.push(placeholder);
            
            // Try to load the model (will fail for relative paths, but shows intent)
            try {
              gltfLoader.load(modelPath, (gltf) => {
                scene.remove(placeholder);
                const model = gltf.scene;
                model.position.set(position[0], position[1], position[2]);
                model.scale.set(scale[0], scale[1], scale[2]);
                model.rotation.set(rotation[0], rotation[1], rotation[2]);
                model.name = name;
                model.traverse((child) => {
                  if (child.isMesh) {
                    child.castShadow = true;
                    child.receiveShadow = true;
                  }
                });
                scene.add(model);
                objects.push(model);
              }, undefined, (error) => {
                // Keep placeholder on error, just log
                console.log('GLB load hint:', modelPath, '(relative paths need workspace context)');
              });
            } catch (e) {
              console.log('GLB placeholder for:', modelPath);
            }
            count++;
            continue; // Skip normal geometry creation
          }

          // Handle 3D Text
          if (modelType === 'text' && textContent && defaultFont) {
            const textGeo = new THREE.TextGeometry(textContent, {
              font: defaultFont,
              size: 0.3,
              height: 0.05,
              curveSegments: 12,
              bevelEnabled: true,
              bevelThickness: 0.01,
              bevelSize: 0.005,
              bevelSegments: 3
            });
            textGeo.center();
            
            const textMat = new THREE.MeshStandardMaterial({
              color,
              metalness: metalness,
              roughness: roughness,
              emissive: emissiveColor,
              emissiveIntensity
            });
            
            const textMesh = new THREE.Mesh(textGeo, textMat);
            textMesh.position.set(position[0], position[1], position[2]);
            textMesh.scale.set(scale[0], scale[1], scale[2]);
            textMesh.rotation.set(rotation[0], rotation[1], rotation[2]);
            textMesh.castShadow = true;
            textMesh.name = name;
            scene.add(textMesh);
            objects.push(textMesh);
            count++;
            continue;
          }

          // Handle Particle systems
          if (modelType === 'particles' || modelType === 'emitter') {
            const particleCountMatch = props.match(/count\\s*:\\s*(\\d+)/);
            const particleCount = particleCountMatch ? parseInt(particleCountMatch[1]) : 100;
            
            const particlesGeo = new THREE.BufferGeometry();
            const positions = new Float32Array(particleCount * 3);
            const velocities = new Float32Array(particleCount * 3);
            
            for (let i = 0; i < particleCount; i++) {
              positions[i * 3] = (Math.random() - 0.5) * 2;
              positions[i * 3 + 1] = Math.random() * 2;
              positions[i * 3 + 2] = (Math.random() - 0.5) * 2;
              velocities[i * 3] = (Math.random() - 0.5) * 0.02;
              velocities[i * 3 + 1] = Math.random() * 0.02 + 0.01;
              velocities[i * 3 + 2] = (Math.random() - 0.5) * 0.02;
            }
            particlesGeo.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            
            const particlesMat = new THREE.PointsMaterial({
              color,
              size: 0.05,
              transparent: true,
              opacity: 0.8,
              blending: THREE.AdditiveBlending
            });
            
            const particles = new THREE.Points(particlesGeo, particlesMat);
            particles.position.set(position[0], position[1], position[2]);
            particles.name = name;
            particles.userData.velocities = velocities;
            scene.add(particles);
            objects.push(particles);
            particleSystems.push(particles);
            count++;
            continue;
          }

          // Create geometry based on model type - expanded library
          let geometry;
          switch (modelType) {
            // === BASIC PRIMITIVES ===
            case 'sphere':
            case 'orb':
              geometry = new THREE.SphereGeometry(0.5, 64, 64);
              break;
            case 'cylinder':
              geometry = new THREE.CylinderGeometry(0.5, 0.5, 1, 48);
              break;
            case 'cone':
              geometry = new THREE.ConeGeometry(0.5, 1, 48);
              break;
            case 'torus':
            case 'ring':
            case 'donut':
              geometry = new THREE.TorusGeometry(0.4, 0.15, 24, 64);
              break;
            case 'plane':
            case 'quad':
              geometry = new THREE.PlaneGeometry(1, 1, 4, 4);
              break;
            case 'cube':
            case 'box':
              geometry = new THREE.BoxGeometry(1, 1, 1, 2, 2, 2);
              break;

            // === ADVANCED SHAPES ===
            case 'capsule':
            case 'pill':
              geometry = new THREE.CapsuleGeometry(0.3, 0.6, 16, 32);
              break;
            case 'icosahedron':
            case 'gem':
            case 'crystal':
              geometry = new THREE.IcosahedronGeometry(0.5, 0);
              break;
            case 'octahedron':
            case 'diamond':
              geometry = new THREE.OctahedronGeometry(0.5, 0);
              break;
            case 'dodecahedron':
              geometry = new THREE.DodecahedronGeometry(0.5, 0);
              break;
            case 'tetrahedron':
            case 'pyramid':
              geometry = new THREE.TetrahedronGeometry(0.5, 0);
              break;
            case 'torusknot':
            case 'knot':
            case 'pretzel':
              geometry = new THREE.TorusKnotGeometry(0.3, 0.1, 128, 32);
              break;

            // === ARCHITECTURAL ===
            case 'column':
            case 'pillar':
              geometry = new THREE.CylinderGeometry(0.3, 0.35, 2, 24);
              break;
            case 'pedestal':
            case 'platform':
              geometry = new THREE.CylinderGeometry(0.6, 0.5, 0.2, 32);
              break;
            case 'ramp':
            case 'wedge':
              // Create wedge using extrude
              const wedgeShape = new THREE.Shape();
              wedgeShape.moveTo(0, 0);
              wedgeShape.lineTo(1, 0);
              wedgeShape.lineTo(1, 0.5);
              wedgeShape.lineTo(0, 0);
              geometry = new THREE.ExtrudeGeometry(wedgeShape, { depth: 1, bevelEnabled: false });
              geometry.center();
              break;
            case 'arch':
              // Half torus for archway
              geometry = new THREE.TorusGeometry(0.5, 0.1, 16, 32, Math.PI);
              break;
            case 'stairs':
            case 'steps':
              // Create stepped geometry
              const stepsGroup = new THREE.BufferGeometry();
              const stepGeos = [];
              for (let i = 0; i < 4; i++) {
                const step = new THREE.BoxGeometry(1, 0.2, 0.25);
                step.translate(0, i * 0.2 + 0.1, i * 0.25);
                stepGeos.push(step);
              }
              geometry = THREE.BufferGeometryUtils ? 
                THREE.BufferGeometryUtils.mergeBufferGeometries(stepGeos) :
                stepGeos[0]; // Fallback
              break;

            // === ORGANIC / NATURAL ===
            case 'rock':
            case 'boulder':
              geometry = new THREE.IcosahedronGeometry(0.5, 1);
              // Distort vertices for rocky look
              const rockPos = geometry.attributes.position;
              for (let i = 0; i < rockPos.count; i++) {
                rockPos.setXYZ(i,
                  rockPos.getX(i) * (0.8 + Math.random() * 0.4),
                  rockPos.getY(i) * (0.8 + Math.random() * 0.4),
                  rockPos.getZ(i) * (0.8 + Math.random() * 0.4)
                );
              }
              geometry.computeVertexNormals();
              break;
            case 'tree':
            case 'pine':
              // Simple cone tree
              geometry = new THREE.ConeGeometry(0.5, 1.5, 8);
              break;
            case 'leaf':
              // Flat oval
              geometry = new THREE.SphereGeometry(0.5, 16, 8);
              geometry.scale(1, 0.1, 0.6);
              break;

            // === TECH / SCI-FI ===
            case 'hexagon':
            case 'hex':
              geometry = new THREE.CylinderGeometry(0.5, 0.5, 0.2, 6);
              break;
            case 'prism':
              geometry = new THREE.CylinderGeometry(0.5, 0.5, 1, 3);
              break;
            case 'star':
              // 5-pointed star using lathe
              const starPts = [];
              for (let i = 0; i < 11; i++) {
                const r = i % 2 === 0 ? 0.5 : 0.25;
                starPts.push(new THREE.Vector2(
                  Math.cos(i * Math.PI / 5) * r,
                  Math.sin(i * Math.PI / 5) * r
                ));
              }
              const starShape = new THREE.Shape(starPts);
              geometry = new THREE.ExtrudeGeometry(starShape, { depth: 0.2, bevelEnabled: false });
              geometry.center();
              break;
            case 'portal':
            case 'gate':
              // Flat ring with hole
              geometry = new THREE.RingGeometry(0.3, 0.5, 32);
              break;
            case 'disc':
            case 'coin':
              geometry = new THREE.CylinderGeometry(0.5, 0.5, 0.05, 48);
              break;
            case 'antenna':
            case 'rod':
              geometry = new THREE.CylinderGeometry(0.03, 0.03, 2, 8);
              break;

            // === FURNITURE / PROPS ===
            case 'table':
              // Flat top
              geometry = new THREE.BoxGeometry(1.5, 0.1, 1);
              break;
            case 'chair':
            case 'seat':
              geometry = new THREE.BoxGeometry(0.5, 0.1, 0.5);
              break;
            case 'button':
            case 'switch':
              geometry = new THREE.CylinderGeometry(0.15, 0.18, 0.08, 32);
              break;
            case 'lever':
            case 'handle':
              geometry = new THREE.CapsuleGeometry(0.05, 0.4, 8, 16);
              break;
            case 'screen':
            case 'display':
            case 'monitor':
              geometry = new THREE.BoxGeometry(1.6, 0.9, 0.05);
              break;

            // === WEAPONS / TOOLS ===
            case 'sword':
            case 'blade':
              const swordShape = new THREE.Shape();
              swordShape.moveTo(0, 0);
              swordShape.lineTo(0.05, 0);
              swordShape.lineTo(0.03, 1);
              swordShape.lineTo(0, 1.1);
              swordShape.lineTo(-0.03, 1);
              swordShape.lineTo(-0.05, 0);
              geometry = new THREE.ExtrudeGeometry(swordShape, { depth: 0.02, bevelEnabled: true, bevelThickness: 0.01, bevelSize: 0.01 });
              geometry.center();
              break;
            case 'shield':
              geometry = new THREE.SphereGeometry(0.5, 32, 16, 0, Math.PI);
              geometry.scale(1, 1.2, 0.2);
              break;
            case 'wand':
            case 'staff':
              geometry = new THREE.CylinderGeometry(0.02, 0.04, 1, 8);
              break;

            // === CREATIVE / DECORATIVE ===
            case 'heart':
              const heartShape = new THREE.Shape();
              heartShape.moveTo(0, 0);
              heartShape.bezierCurveTo(0, -0.3, -0.5, -0.3, -0.5, 0);
              heartShape.bezierCurveTo(-0.5, 0.3, 0, 0.6, 0, 0.9);
              heartShape.bezierCurveTo(0, 0.6, 0.5, 0.3, 0.5, 0);
              heartShape.bezierCurveTo(0.5, -0.3, 0, -0.3, 0, 0);
              geometry = new THREE.ExtrudeGeometry(heartShape, { depth: 0.2, bevelEnabled: true, bevelThickness: 0.05, bevelSize: 0.05 });
              geometry.center();
              geometry.rotateX(Math.PI);
              break;
              
            case 'arrow':
            case 'pointer':
              const arrowShape = new THREE.Shape();
              arrowShape.moveTo(0, 0.5);
              arrowShape.lineTo(0.3, 0);
              arrowShape.lineTo(0.1, 0);
              arrowShape.lineTo(0.1, -0.5);
              arrowShape.lineTo(-0.1, -0.5);
              arrowShape.lineTo(-0.1, 0);
              arrowShape.lineTo(-0.3, 0);
              arrowShape.lineTo(0, 0.5);
              geometry = new THREE.ExtrudeGeometry(arrowShape, { depth: 0.1, bevelEnabled: false });
              geometry.center();
              break;
              
            case 'cross':
            case 'plus':
              const crossShape = new THREE.Shape();
              crossShape.moveTo(-0.15, 0.5);
              crossShape.lineTo(0.15, 0.5);
              crossShape.lineTo(0.15, 0.15);
              crossShape.lineTo(0.5, 0.15);
              crossShape.lineTo(0.5, -0.15);
              crossShape.lineTo(0.15, -0.15);
              crossShape.lineTo(0.15, -0.5);
              crossShape.lineTo(-0.15, -0.5);
              crossShape.lineTo(-0.15, -0.15);
              crossShape.lineTo(-0.5, -0.15);
              crossShape.lineTo(-0.5, 0.15);
              crossShape.lineTo(-0.15, 0.15);
              crossShape.lineTo(-0.15, 0.5);
              geometry = new THREE.ExtrudeGeometry(crossShape, { depth: 0.2, bevelEnabled: true, bevelThickness: 0.02, bevelSize: 0.02 });
              geometry.center();
              break;
              
            case 'moon':
            case 'crescent':
              const moonShape = new THREE.Shape();
              moonShape.absarc(0, 0, 0.5, 0, Math.PI * 2, false);
              const moonHole = new THREE.Path();
              moonHole.absarc(0.2, 0, 0.4, 0, Math.PI * 2, true);
              moonShape.holes.push(moonHole);
              geometry = new THREE.ExtrudeGeometry(moonShape, { depth: 0.15, bevelEnabled: false });
              geometry.center();
              break;
              
            case 'gear':
            case 'cog':
              const gearShape = new THREE.Shape();
              const teeth = 8;
              for (let i = 0; i < teeth * 2; i++) {
                const angle = (i / (teeth * 2)) * Math.PI * 2;
                const r = i % 2 === 0 ? 0.5 : 0.35;
                if (i === 0) {
                  gearShape.moveTo(r * Math.cos(angle), r * Math.sin(angle));
                } else {
                  gearShape.lineTo(r * Math.cos(angle), r * Math.sin(angle));
                }
              }
              const gearHole = new THREE.Path();
              gearHole.absarc(0, 0, 0.1, 0, Math.PI * 2, true);
              gearShape.holes.push(gearHole);
              geometry = new THREE.ExtrudeGeometry(gearShape, { depth: 0.15, bevelEnabled: false });
              geometry.center();
              break;
              
            case 'spring':
            case 'coil':
              // Helix/spring using tube
              const springCurve = new THREE.Curve();
              springCurve.getPoint = function(t) {
                const angle = t * Math.PI * 6;
                return new THREE.Vector3(
                  Math.cos(angle) * 0.3,
                  t - 0.5,
                  Math.sin(angle) * 0.3
                );
              };
              geometry = new THREE.TubeGeometry(springCurve, 64, 0.05, 8, false);
              break;
              
            case 'spiral':
            case 'helix':
              const spiralCurve = new THREE.Curve();
              spiralCurve.getPoint = function(t) {
                const angle = t * Math.PI * 4;
                const radius = 0.1 + t * 0.4;
                return new THREE.Vector3(
                  Math.cos(angle) * radius,
                  t * 0.5 - 0.25,
                  Math.sin(angle) * radius
                );
              };
              geometry = new THREE.TubeGeometry(spiralCurve, 64, 0.03, 8, false);
              break;
              
            case 'wave':
            case 'sine':
              const waveCurve = new THREE.Curve();
              waveCurve.getPoint = function(t) {
                return new THREE.Vector3(
                  t - 0.5,
                  Math.sin(t * Math.PI * 3) * 0.2,
                  0
                );
              };
              geometry = new THREE.TubeGeometry(waveCurve, 64, 0.05, 8, false);
              break;
              
            case 'ring2d':
            case 'hoop':
              geometry = new THREE.RingGeometry(0.3, 0.5, 32);
              break;
              
            case 'tube':
            case 'pipe':
              geometry = new THREE.TubeGeometry(
                new THREE.LineCurve3(new THREE.Vector3(0, -0.5, 0), new THREE.Vector3(0, 0.5, 0)),
                1, 0.3, 32, false
              );
              break;
              
            case 'cylinder_hollow':
            case 'ring3d':
              // Hollow cylinder using lathe
              const hollowPts = [
                new THREE.Vector2(0.3, -0.5),
                new THREE.Vector2(0.5, -0.5),
                new THREE.Vector2(0.5, 0.5),
                new THREE.Vector2(0.3, 0.5),
                new THREE.Vector2(0.3, -0.5)
              ];
              geometry = new THREE.LatheGeometry(hollowPts, 32);
              break;
              
            case 'bowl':
            case 'cup':
              const bowlPts = [];
              for (let i = 0; i <= 10; i++) {
                const t = i / 10;
                bowlPts.push(new THREE.Vector2(
                  0.2 + Math.sin(t * Math.PI * 0.5) * 0.3,
                  t * 0.5 - 0.25
                ));
              }
              geometry = new THREE.LatheGeometry(bowlPts, 32);
              break;
              
            case 'vase':
            case 'bottle':
              const vasePts = [];
              for (let i = 0; i <= 20; i++) {
                const t = i / 20;
                const r = 0.1 + Math.sin(t * Math.PI) * 0.2 + (t > 0.8 ? (t - 0.8) * 0.5 : 0);
                vasePts.push(new THREE.Vector2(r, t - 0.5));
              }
              geometry = new THREE.LatheGeometry(vasePts, 32);
              break;
              
            case 'egg':
            case 'oval':
              geometry = new THREE.SphereGeometry(0.5, 32, 32);
              geometry.scale(0.8, 1.2, 0.8);
              break;
              
            case 'pill':
            case 'lozenge':
              geometry = new THREE.CapsuleGeometry(0.2, 0.6, 16, 32);
              break;
              
            case 'droplet':
            case 'teardrop':
              const dropPts = [];
              for (let i = 0; i <= 20; i++) {
                const t = i / 20;
                const r = Math.sin(t * Math.PI) * (1 - t * 0.5) * 0.3;
                dropPts.push(new THREE.Vector2(r, t - 0.3));
              }
              geometry = new THREE.LatheGeometry(dropPts, 32);
              break;
              
            case 'lightning':
            case 'bolt':
              const boltShape = new THREE.Shape();
              boltShape.moveTo(0.1, 0.5);
              boltShape.lineTo(-0.2, 0.1);
              boltShape.lineTo(0, 0.1);
              boltShape.lineTo(-0.1, -0.5);
              boltShape.lineTo(0.2, -0.1);
              boltShape.lineTo(0, -0.1);
              boltShape.lineTo(0.1, 0.5);
              geometry = new THREE.ExtrudeGeometry(boltShape, { depth: 0.1, bevelEnabled: false });
              geometry.center();
              break;
              
            case 'explosion':
            case 'burst':
              geometry = new THREE.IcosahedronGeometry(0.5, 0);
              const burstPos = geometry.attributes.position;
              for (let i = 0; i < burstPos.count; i++) {
                const mult = 0.5 + Math.random() * 1.0;
                burstPos.setXYZ(i,
                  burstPos.getX(i) * mult,
                  burstPos.getY(i) * mult,
                  burstPos.getZ(i) * mult
                );
              }
              geometry.computeVertexNormals();
              break;
              
            case 'snowflake':
            case 'flake':
              const flakeShape = new THREE.Shape();
              const arms = 6;
              for (let i = 0; i < arms; i++) {
                const angle = (i / arms) * Math.PI * 2;
                const nextAngle = ((i + 0.5) / arms) * Math.PI * 2;
                flakeShape.lineTo(Math.cos(angle) * 0.5, Math.sin(angle) * 0.5);
                flakeShape.lineTo(Math.cos(nextAngle) * 0.15, Math.sin(nextAngle) * 0.15);
              }
              geometry = new THREE.ExtrudeGeometry(flakeShape, { depth: 0.05, bevelEnabled: false });
              geometry.center();
              break;

            // === DEFAULT (rounded box) ===
            default:
              // Beveled box for more professional look
              const boxShape = new THREE.Shape();
              const bevel = 0.08;
              boxShape.moveTo(-0.5 + bevel, -0.5);
              boxShape.lineTo(0.5 - bevel, -0.5);
              boxShape.quadraticCurveTo(0.5, -0.5, 0.5, -0.5 + bevel);
              boxShape.lineTo(0.5, 0.5 - bevel);
              boxShape.quadraticCurveTo(0.5, 0.5, 0.5 - bevel, 0.5);
              boxShape.lineTo(-0.5 + bevel, 0.5);
              boxShape.quadraticCurveTo(-0.5, 0.5, -0.5, 0.5 - bevel);
              boxShape.lineTo(-0.5, -0.5 + bevel);
              boxShape.quadraticCurveTo(-0.5, -0.5, -0.5 + bevel, -0.5);
              geometry = new THREE.ExtrudeGeometry(boxShape, { 
                depth: 1, 
                bevelEnabled: true, 
                bevelThickness: 0.05, 
                bevelSize: 0.05, 
                bevelSegments: 3 
              });
              geometry.center();
          }

          // Parse glow/emissive properties
          const glowMatch = props.match(/glow\\s*:\\s*(true|false)/i);
          const emissiveMatch = props.match(/emissive\\s*:\\s*["']?#?([\\w]+)["']?/);
          const isGlowing = glowMatch && glowMatch[1].toLowerCase() === 'true';
          const emissiveIntensityMatch = props.match(/emissiveIntensity\\s*:\\s*([\\d.]+)/);
          const emissiveIntensity = emissiveIntensityMatch ? parseFloat(emissiveIntensityMatch[1]) : (isGlowing ? 0.5 : 0);
          
          // Parse metallic/roughness from code
          const metallicMatch = props.match(/(?:metallic|metalness)\\s*:\\s*([\\d.]+)/);
          const roughnessMatch = props.match(/roughness\\s*:\\s*([\\d.]+)/);
          const metalness = metallicMatch ? parseFloat(metallicMatch[1]) : 0.1;
          const roughness = roughnessMatch ? parseFloat(roughnessMatch[1]) : 0.4;

          // Parse material type
          const materialTypeMatch = props.match(/material\\s*:\\s*["']([\\w]+)["']/);
          const materialType = materialTypeMatch ? materialTypeMatch[1].toLowerCase() : 'standard';
          
          // Parse opacity/transparency
          const opacityMatch = props.match(/opacity\\s*:\\s*([\\d.]+)/);
          const transparentMatch = props.match(/transparent\\s*:\\s*(true|false)/i);
          const opacity = opacityMatch ? parseFloat(opacityMatch[1]) : 1;
          const isTransparent = (transparentMatch && transparentMatch[1].toLowerCase() === 'true') || opacity < 1 || materialType === 'glass' || materialType === 'hologram';

          // Determine emissive color
          let emissiveColor = 0x000000;
          if (isGlowing) {
            emissiveColor = color; // Use object color as emissive
          } else if (emissiveMatch) {
            const emStr = emissiveMatch[1];
            emissiveColor = emStr.match(/^[0-9a-f]{6}$/i) ? parseInt(emStr, 16) : 0x000000;
          }

          // Create material based on material type
          let material;
          switch (materialType) {
            case 'glass':
            case 'crystal':
            case 'transparent':
              material = new THREE.MeshPhysicalMaterial({
                color,
                roughness: 0.05,
                metalness: 0,
                transmission: 0.9,
                thickness: 0.5,
                transparent: true,
                opacity: opacity,
                envMapIntensity: 1.5,
                clearcoat: 1.0,
                clearcoatRoughness: 0.1,
                ior: 1.5,
                wireframe: wireframeMode
              });
              break;
              
            case 'hologram':
            case 'holographic':
              material = new THREE.MeshBasicMaterial({
                color,
                transparent: true,
                opacity: 0.6,
                wireframe: true,
                side: THREE.DoubleSide
              });
              // Add inner solid core
              const innerMat = new THREE.MeshBasicMaterial({
                color,
                transparent: true,
                opacity: 0.2
              });
              const innerMesh = new THREE.Mesh(geometry.clone(), innerMat);
              innerMesh.scale.setScalar(0.95);
              scene.add(innerMesh);
              objects.push(innerMesh);
              break;
              
            case 'toon':
            case 'cartoon':
              const toonColors = new Uint8Array([0, 80, 160, 255]);
              const toonGradient = new THREE.DataTexture(toonColors, toonColors.length, 1, THREE.LuminanceFormat);
              toonGradient.needsUpdate = true;
              material = new THREE.MeshToonMaterial({
                color,
                gradientMap: toonGradient,
                wireframe: wireframeMode
              });
              break;
              
            case 'neon':
            case 'glow':
              material = new THREE.MeshBasicMaterial({
                color,
                transparent: true,
                opacity: 0.9
              });
              // Add glow halo
              const glowMat = new THREE.MeshBasicMaterial({
                color,
                transparent: true,
                opacity: 0.3,
                side: THREE.BackSide
              });
              const glowMesh = new THREE.Mesh(geometry.clone(), glowMat);
              glowMesh.scale.setScalar(1.15);
              scene.add(glowMesh);
              objects.push(glowMesh);
              break;
              
            case 'matte':
            case 'diffuse':
              material = new THREE.MeshLambertMaterial({
                color,
                emissive: emissiveColor,
                emissiveIntensity,
                wireframe: wireframeMode
              });
              break;
              
            case 'shiny':
            case 'plastic':
              material = new THREE.MeshPhongMaterial({
                color,
                shininess: 100,
                specular: 0xffffff,
                emissive: emissiveColor,
                emissiveIntensity,
                wireframe: wireframeMode
              });
              break;
              
            case 'metal':
            case 'metallic':
              material = new THREE.MeshStandardMaterial({
                color,
                roughness: 0.1,
                metalness: 1.0,
                emissive: emissiveColor,
                emissiveIntensity,
                envMapIntensity: 2.0,
                wireframe: wireframeMode
              });
              break;
              
            case 'mirror':
            case 'chrome':
              material = new THREE.MeshStandardMaterial({
                color: 0xffffff,
                roughness: 0.0,
                metalness: 1.0,
                envMapIntensity: 3.0,
                wireframe: wireframeMode
              });
              break;
              
            case 'velvet':
            case 'fabric':
              material = new THREE.MeshStandardMaterial({
                color,
                roughness: 0.9,
                metalness: 0.0,
                emissive: emissiveColor,
                emissiveIntensity,
                wireframe: wireframeMode
              });
              break;
              
            case 'wireframe':
            case 'wire':
              material = new THREE.MeshBasicMaterial({
                color,
                wireframe: true,
                transparent: true,
                opacity: 0.8
              });
              break;
              
            case 'xray':
              material = new THREE.MeshBasicMaterial({
                color,
                transparent: true,
                opacity: 0.3,
                depthWrite: false,
                side: THREE.DoubleSide
              });
              break;
              
            case 'fresnel':
            case 'rim':
              // Simulate fresnel with two materials
              material = new THREE.MeshStandardMaterial({
                color: 0x000000,
                roughness: 0.5,
                metalness: 0.5,
                emissive: color,
                emissiveIntensity: 0.2,
                wireframe: wireframeMode
              });
              break;
              
            case 'gradient':
              // Create a simple vertical gradient
              const canvas = document.createElement('canvas');
              canvas.width = 2;
              canvas.height = 256;
              const ctx = canvas.getContext('2d');
              const gradient = ctx.createLinearGradient(0, 0, 0, 256);
              gradient.addColorStop(0, '#' + color.toString(16).padStart(6, '0'));
              gradient.addColorStop(1, '#000000');
              ctx.fillStyle = gradient;
              ctx.fillRect(0, 0, 2, 256);
              const gradientTexture = new THREE.CanvasTexture(canvas);
              material = new THREE.MeshBasicMaterial({
                map: gradientTexture,
                transparent: isTransparent,
                opacity,
                wireframe: wireframeMode
              });
              break;
              
            default: // 'standard' or unrecognized
              material = new THREE.MeshStandardMaterial({
                color,
                roughness,
                metalness,
                emissive: emissiveColor,
                emissiveIntensity,
                transparent: isTransparent,
                opacity,
                envMapIntensity: 1.0,
                wireframe: wireframeMode
              });
          }

          // Create mesh
          const mesh = new THREE.Mesh(geometry, material);
          mesh.position.set(position[0], position[1], position[2]);
          mesh.scale.set(scale[0], scale[1], scale[2]);
          mesh.rotation.set(rotation[0], rotation[1], rotation[2]);
          mesh.castShadow = true;
          mesh.receiveShadow = true;
          mesh.name = name;

          scene.add(mesh);
          objects.push(mesh);
          
          // Parse animation properties
          const animateMatch = props.match(/animate\\s*:\\s*["']([\\w]+)["']/);
          const animSpeedMatch = props.match(/animSpeed\\s*:\\s*([\\d.]+)/);
          const animAmplitudeMatch = props.match(/animAmplitude\\s*:\\s*([\\d.]+)/);
          const animRadiusMatch = props.match(/animRadius\\s*:\\s*([\\d.]+)/);
          
          if (animateMatch) {
            animatedObjects.push({
              mesh,
              baseY: position[1],
              baseX: position[0],
              baseZ: position[2],
              baseScale: scale[0],
              animation: {
                type: animateMatch[1].toLowerCase(),
                speed: animSpeedMatch ? parseFloat(animSpeedMatch[1]) : 1,
                amplitude: animAmplitudeMatch ? parseFloat(animAmplitudeMatch[1]) : 0.3,
                radius: animRadiusMatch ? parseFloat(animRadiusMatch[1]) : 2
              }
            });
          }
          
          count++;
        }

        document.getElementById('stat-objects').textContent = count;
      } catch (error) {
        errorPanel.textContent = 'Parse error: ' + error.message;
        errorPanel.classList.add('visible');
      }
    }

    // Handle messages from extension
    window.addEventListener('message', event => {
      const message = event.data;
      switch (message.command) {
        case 'update':
          document.getElementById('file-name').textContent = message.fileName.split(/[./]/).pop();
          parseAndRender(message.content, message.isHoloPlus);
          break;
      }
    });
  </script>
</body>
</html>`}};function ZE(){let n="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let t=0;t<32;t++)n+=e.charAt(Math.floor(Math.random()*e.length));return n}var vc=Vt(require("vscode")),mR=DC(),yc=class n{constructor(e){this.context=e}static{this.viewType="holoscript.smartAssetViewer"}static register(e){let t=new n(e);return vc.window.registerCustomEditorProvider(n.viewType,t,{webviewOptions:{retainContextWhenHidden:!0},supportsMultipleEditorsPerDocument:!1})}async openCustomDocument(e,t,r){return{uri:e,dispose:()=>{}}}async resolveCustomEditor(e,t,r){t.webview.options={enableScripts:!0};try{let i=await vc.workspace.fs.readFile(e.uri),o=new mR(Buffer.from(i)).getEntry("smart-asset.json");if(!o){t.webview.html=this.getErrorHtml("Invalid Smart Asset: smart-asset.json not found.");return}let a=o.getData().toString("utf8"),c;try{c=JSON.parse(a)}catch{t.webview.html=this.getErrorHtml("Invalid Smart Asset: Malformed smart-asset.json.");return}t.webview.html=this.getHtmlForWebview(c)}catch(i){t.webview.html=this.getErrorHtml(`Error opening asset: ${i}`)}}getErrorHtml(e){return`
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <style>
                    body { font-family: sans-serif; padding: 20px; color: var(--vscode-editor-foreground); background: var(--vscode-editor-background); }
                    .error { color: var(--vscode-errorForeground); font-size: 1.2em; }
                </style>
            </head>
            <body>
                <div class="error">\u26A0\uFE0F ${e}</div>
            </body>
            </html>
        `}getHtmlForWebview(e){let t=e.script||"// No script provided",r=e.metadata||{},i=e.physics||{},s=e.ai||{};return`
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <style>
                    body {
                        font-family: var(--vscode-font-family);
                        padding: 20px;
                        color: var(--vscode-foreground);
                        background-color: var(--vscode-editor-background);
                    }
                    h1 { 
                        font-weight: normal; 
                        margin-bottom: 20px; 
                        border-bottom: 1px solid var(--vscode-widget-border);
                        padding-bottom: 10px;
                    }
                    h2 { font-size: 1.1em; color: var(--vscode-textLink-foreground); margin-top: 30px; }
                    .card {
                        background: var(--vscode-editor-inactiveSelectionBackground);
                        padding: 15px;
                        border-radius: 4px;
                        margin-bottom: 10px;
                    }
                    .property { margin-bottom: 8px; display: flex; }
                    .label { font-weight: bold; width: 120px; color: var(--vscode-descriptionForeground); }
                    .value { opacity: 0.9; }
                    pre {
                        background: var(--vscode-textCodeBlock-background);
                        padding: 15px;
                        border-radius: 4px;
                        overflow-x: auto;
                        font-family: 'Consolas', 'Courier New', monospace;
                        font-size: 0.9em;
                        border: 1px solid var(--vscode-widget-border);
                    }
                    .tag {
                        display: inline-block;
                        padding: 2px 8px;
                        background: var(--vscode-button-secondaryBackground);
                        color: var(--vscode-button-secondaryForeground);
                        border-radius: 10px;
                        font-size: 0.85em;
                        margin-right: 5px;
                    }
                </style>
            </head>
            <body>
                <h1>\u{1F4E6} ${r.name||"Unnamed Asset"} <span style="font-size: 0.6em; opacity: 0.6">v${r.version||"0.0.0"}</span></h1>
                
                <div class="card">
                    <p>${r.description||"No description provided."}</p>
                    <div style="margin-top: 10px;">
                        ${(r.tags||[]).map(o=>`<span class="tag">${o}</span>`).join("")}
                    </div>
                </div>

                <div style="display: flex; gap: 20px;">
                    <div style="flex: 1;">
                        <h2>Details</h2>
                        <div class="card">
                            <div class="property"><span class="label">Author:</span> <span class="value">${r.author||"Unknown"}</span></div>
                            <div class="property"><span class="label">Mass:</span> <span class="value">${i.mass||0}kg</span></div>
                            <div class="property"><span class="label">Collider:</span> <span class="value">${i.colliderType||"None"}</span></div>
                            <div class="property"><span class="label">AI Personality:</span> <span class="value">${s.personality||"Neutral"}</span></div>
                        </div>
                    </div>
                </div>

                <h2>HoloScript Logic</h2>
                <pre><code>${this.escapeHtml(t)}</code></pre>

                <script>
                    const vscode = acquireVsCodeApi();
                </script>
            </body>
            </html>
        `}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}};var ut=Vt(require("vscode")),bc=Vt(require("path")),Ss=Vt(require("fs"));var lh=class n{constructor(){}static getInstance(){return n.instance||(n.instance=new n),n.instance}initialize(e){this.context=e,this.registerAgentCommands(e)}registerAgentCommands(e){e.subscriptions.push(ut.commands.registerCommand("holoscript.agent.createFile",async t=>this.createHoloFile(t.filename,t.content,t.openPreview))),e.subscriptions.push(ut.commands.registerCommand("holoscript.agent.generateObject",async t=>this.generateObject(t))),e.subscriptions.push(ut.commands.registerCommand("holoscript.agent.analyzeScene",async()=>this.analyzeCurrentScene())),e.subscriptions.push(ut.commands.registerCommand("holoscript.agent.insertCode",async t=>this.insertCodeAtCursor(t.code))),e.subscriptions.push(ut.commands.registerCommand("holoscript.agent.openPreview",async t=>this.openPreview(t?.filePath))),e.subscriptions.push(ut.commands.registerCommand("holoscript.agent.addTrait",async t=>this.addTraitToObject(t.objectName,t.trait))),e.subscriptions.push(ut.commands.registerCommand("holoscript.agent.listTraits",async t=>this.listTraits(t?.category))),e.subscriptions.push(ut.commands.registerCommand("holoscript.agent.validate",async t=>this.validateSyntax(t?.content))),e.subscriptions.push(ut.commands.registerCommand("holoscript.agent.status",async()=>this.getStatus()))}async createHoloFile(e,t,r=!0){try{let i=ut.workspace.workspaceFolders?.[0];if(!i)return{success:!1,error:"No workspace folder open"};e.match(/\.(holo|hsplus|hs)$/)||(e+=".holo");let s=bc.join(i.uri.fsPath,e),o=bc.dirname(s);Ss.existsSync(o)||Ss.mkdirSync(o,{recursive:!0}),Ss.writeFileSync(s,t,"utf8");let a=await ut.workspace.openTextDocument(s),c=await ut.window.showTextDocument(a);return r&&this.context&&bn.createOrShow(this.context.extensionUri,a),{success:!0,data:{filePath:s,opened:!0,previewOpened:r}}}catch(i){return{success:!1,error:`Failed to create file: ${i}`}}}async generateObject(e){let{description:t,format:r="hsplus",traits:i=[]}=e,s=t.toLowerCase(),o="object",a=[...i];(s.includes("grab")||s.includes("pick up")||s.includes("hold"))&&a.push("@grabbable"),(s.includes("throw")||s.includes("toss"))&&a.push("@throwable"),(s.includes("collid")||s.includes("solid")||s.includes("hit"))&&a.push("@collidable"),(s.includes("glow")||s.includes("light")||s.includes("emissive"))&&a.push("@glowing"),(s.includes("click")||s.includes("button")||s.includes("press"))&&a.push("@clickable"),(s.includes("network")||s.includes("multiplayer")||s.includes("sync"))&&a.push("@networked"),(s.includes("physic")||s.includes("fall")||s.includes("gravity"))&&a.push("@physics"),(s.includes("stack")||s.includes("pile"))&&a.push("@stackable"),(s.includes("hover")||s.includes("highlight"))&&a.push("@hoverable"),a=[...new Set(a)];let c=t.split(" ").slice(0,2).map(d=>d.charAt(0).toUpperCase()+d.slice(1).toLowerCase()).join(""),u;return r==="holo"?u=`object "${c}" {
  ${a.join(`
  `)}
  
  position: [0, 1, 0]
  // TODO: ${t}
}`:u=`orb ${c.toLowerCase()} {
  ${a.join(`
  `)}
  
  position: { x: 0, y: 1, z: 0 }
  // TODO: ${t}
}`,{success:!0,data:{code:u,suggestedTraits:a,objectName:c,format:r}}}async analyzeCurrentScene(){let e=ut.window.activeTextEditor;if(!e||!this.isHoloScriptFile(e.document))return{success:!1,error:"No HoloScript file open"};let t=e.document.getText(),r={objects:0,templates:0,traits:[],hasNetworking:!1,hasPhysics:!1,complexity:"simple"},i=t.match(/\bobject\s+["']\w+["']/g)||[],s=t.match(/\borb\s+\w+/g)||[];r.objects=i.length+s.length;let o=t.match(/\btemplate\s+["']\w+["']/g)||[];r.templates=o.length;let a=t.match(/@\w+/g)||[];r.traits=[...new Set(a)],r.hasNetworking=/@networked|@synced|@persistent/.test(t),r.hasPhysics=/@physics|@collidable|@rigid|@gravity/.test(t);let c=r.objects+r.templates*2+r.traits.length;return c>20?r.complexity="complex":c>8&&(r.complexity="moderate"),{success:!0,data:r}}async insertCodeAtCursor(e){let t=ut.window.activeTextEditor;return t?(await t.edit(r=>{r.insert(t.selection.active,e)}),{success:!0,data:{inserted:!0}}):{success:!1,error:"No active editor"}}async openPreview(e){if(!this.context)return{success:!1,error:"Extension not initialized"};let t;return e?t=await ut.workspace.openTextDocument(e):t=ut.window.activeTextEditor?.document,!t||!this.isHoloScriptFile(t)?{success:!1,error:"No valid HoloScript file"}:(bn.createOrShow(this.context.extensionUri,t),{success:!0,data:{previewOpened:!0}})}async addTraitToObject(e,t){let r=ut.window.activeTextEditor;if(!r||!this.isHoloScriptFile(r.document))return{success:!1,error:"No HoloScript file open"};let i=r.document.getText(),s=[new RegExp(`(object\\s+["']${e}["']\\s*\\{)`,"i"),new RegExp(`(orb\\s+${e}\\s*\\{)`,"i")],o=!1;for(let a of s){let c=i.match(a);if(c&&c.index!==void 0){let u=r.document.positionAt(c.index+c[1].length);await r.edit(d=>{let v=t.startsWith("@")?t:`@${t}`;d.insert(u,`
  ${v}`)}),o=!0;break}}return o?{success:!0,data:{objectName:e,trait:t,added:!0}}:{success:!1,error:`Object "${e}" not found`}}async listTraits(e){let t={interaction:["@grabbable","@throwable","@holdable","@clickable","@hoverable","@draggable","@haptic"],physics:["@collidable","@physics","@rigid","@kinematic","@trigger","@gravity"],visual:["@glowing","@emissive","@transparent","@reflective","@animated","@billboard"],networking:["@networked","@synced","@persistent","@owned","@host_only"],behavior:["@stackable","@attachable","@equippable","@consumable","@destructible"],spatial:["@anchor","@tracked","@world_locked","@hand_tracked","@eye_tracked","@seated"],audio:["@spatial_audio","@ambient","@voice_activated"],state:["@state","@reactive","@observable","@computed"]};return e&&t[e]?{success:!0,data:{[e]:t[e]}}:{success:!0,data:t}}async validateSyntax(e){let t=ut.window.activeTextEditor,r=e||t?.document.getText();if(!r)return{success:!1,error:"No content to validate"};let i=[],s=r.split(`
`),o=0,a=!1;for(let c=0;c<s.length;c++){let u=s[c];for(let d of u)d==='"'||d==="'"?a=!a:a||(d==="{"&&o++,d==="}"&&o--);u.match(/^\s*@\w+[^(\s{]/)}return o!==0&&i.push({line:s.length,message:"Unbalanced braces"}),{success:i.length===0,data:{valid:i.length===0,errors:i,lineCount:s.length}}}async getStatus(){let e=ut.window.activeTextEditor;return{success:!0,data:{extensionVersion:"1.2.0",previewActive:!!bn.currentPanel,activeFile:e?.document.fileName,isHoloScriptFile:e?this.isHoloScriptFile(e.document):!1,workspaceOpen:!!ut.workspace.workspaceFolders?.length,capabilities:["holoscript.agent.createFile","holoscript.agent.generateObject","holoscript.agent.analyzeScene","holoscript.agent.insertCode","holoscript.agent.openPreview","holoscript.agent.addTrait","holoscript.agent.listTraits","holoscript.agent.validate","holoscript.agent.status"]}}}isHoloScriptFile(e){return e.languageId==="holoscript"||e.languageId==="holoscriptplus"||/\.(holo|hsplus|hs)$/.test(e.fileName)}},xC=lh.getInstance();var Jr=Vt(require("vscode")),Cc=class{constructor(){this.traits=[{label:"@grabbable",detail:"Make object grabbable by VR controllers",insertText:"grabbable"},{label:"@physics",detail:"Enable physics simulation",insertText:"physics"},{label:"@collidable",detail:"Enable collision detection",insertText:"collidable"},{label:"@glowing",detail:"Add glow effect",insertText:"glowing"},{label:"@sound",detail:"Attach 3D spatial sound",insertText:'sound("${1:sound_id}")'},{label:"@lookat",detail:"Make object look at target",insertText:'lookat("${1:target_id}")'},{label:"@spin",detail:"Spin object continuously",insertText:"spin(${1:speed})"},{label:"@bounce",detail:"Bounce animation",insertText:"bounce(${1:height})"},{label:"@float",detail:"Floating animation",insertText:"float(${1:height})"},{label:"@scale",detail:"Scale animation",insertText:"scale(${1:factor})"},{label:"@fade",detail:"Fade on trigger",insertText:"fade(${1:opacity})"},{label:"@light",detail:"Emit light",insertText:"light(${1:intensity})"},{label:"@particles",detail:"Emit particles",insertText:'particles("${1:effect_id}")'},{label:"@video",detail:"Play video texture",insertText:'video("${1:url}")'},{label:"@web",detail:"Display web content",insertText:'web("${1:url}")'},{label:"@text",detail:"Display 3D text",insertText:'text("${1:content}")'},{label:"@onclick",detail:"Trigger event on click",insertText:"onclick(${1:event})"},{label:"@onhover",detail:"Trigger event on hover",insertText:"onhover(${1:event})"},{label:"@draggable",detail:"Allow dragging object",insertText:"draggable"},{label:"@rotatable",detail:"Allow rotating object",insertText:"rotatable"},{label:"@scalable",detail:"Allow scaling object",insertText:"scalable"}]}provideCompletionItems(e,t,r,i){return e.lineAt(t).text.substr(0,t.character).endsWith("@"),this.traits.map(a=>{let c=new Jr.CompletionItem(a.label,Jr.CompletionItemKind.Keyword);return c.detail=a.detail,a.insertText.includes("${")?c.insertText=new Jr.SnippetString(a.insertText):c.insertText=a.insertText,c.documentation=new Jr.MarkdownString(`Applies the **${a.label}** trait to this object.`),c})}};var Sc;function _R(n){n.subscriptions.push(De.commands.registerCommand("holoscript.openPreview",()=>{let a=De.window.activeTextEditor;a&&_c(a.document)?bn.createOrShow(n.extensionUri,a.document):De.window.showWarningMessage("Open a HoloScript file (.holo or .hsplus) to preview.")})),n.subscriptions.push(De.commands.registerCommand("holoscript.openPreviewToSide",()=>{let a=De.window.activeTextEditor;a&&_c(a.document)?bn.createOrShow(n.extensionUri,a.document):De.window.showWarningMessage("Open a HoloScript file (.holo or .hsplus) to preview.")})),n.subscriptions.push(De.window.onDidChangeActiveTextEditor(a=>{a&&_c(a.document)&&bn.currentPanel&&bn.currentPanel.updateContent(a.document)})),De.window.registerWebviewPanelSerializer&&n.subscriptions.push(De.window.registerWebviewPanelSerializer(bn.viewType,{async deserializeWebviewPanel(a,c){bn.revive(a,n.extensionUri)}})),xC.initialize(n),console.log("HoloScript: AI Agent API initialized. Agents can use holoscript.agent.* commands."),n.subscriptions.push(De.commands.registerCommand("holoscript.openExamples",async()=>{let a=Mi.join(n.extensionPath,"..","..","examples","quickstart"),c=Ge.Uri.file(a);try{po.existsSync(a)?await De.commands.executeCommand("vscode.openFolder",c,{forceNewWindow:!1}):Ge.env.openExternal(Ge.Uri.parse("https://github.com/brianonbased-dev/holoscript/tree/main/examples/quickstart"))}catch{Ge.env.openExternal(Ge.Uri.parse("https://github.com/brianonbased-dev/holoscript/tree/main/examples/quickstart"))}})),n.subscriptions.push(De.commands.registerCommand("holoscript.showWalkthrough",()=>{De.commands.executeCommand("workbench.action.openWalkthrough","holoscript.holoscript-vscode#holoscript-getting-started")})),n.subscriptions.push(De.commands.registerCommand("holoscript.openDocumentation",()=>{Ge.env.openExternal(Ge.Uri.parse("https://holoscript.net/guides/"))})),n.subscriptions.push(De.commands.registerCommand("holoscript.validate",async()=>{let a=De.window.activeTextEditor;if(!a||!_c(a.document)){De.window.showWarningMessage("Open a HoloScript file (.holo or .hsplus) to validate.");return}let u=a.document.getText().split(`
`),d=[],v=0,b=!1;for(let g=0;g<u.length;g++){let h=u[g];for(let w of h)w==='"'||w==="'"?b=!b:b||(w==="{"&&v++,w==="}"&&v--)}v!==0&&d.push({line:u.length,message:"Unbalanced braces"}),d.length===0?De.window.showInformationMessage("\u2705 HoloScript syntax is valid!"):De.window.showErrorMessage(`\u274C Found ${d.length} error(s): ${d.map(g=>g.message).join(", ")}`)})),n.subscriptions.push(De.commands.registerCommand("holoscript.createFirstScene",async()=>{let a=Ge.workspace.workspaceFolders?.[0];if(!a){De.window.showWarningMessage("Open a folder first to create HoloScript files.");return}let c=await De.window.showInputBox({prompt:"Enter a name for your first scene",value:"hello-world",placeHolder:"hello-world"});if(!c)return;let u=Mi.join(a.uri.fsPath,`${c}.holo`),d=`composition "My First Scene" {
  environment {
    skybox: "default"
    ambient_light: 0.5
  }

  object "MyFirstCube" {
    @grabbable
    @collidable
    
    geometry: "cube"
    position: [0, 1, 0]
    scale: [0.5, 0.5, 0.5]
    color: "#00ffff"
  }
}
`;try{po.writeFileSync(u,d,"utf8");let v=await Ge.workspace.openTextDocument(u);await De.window.showTextDocument(v),De.window.showInformationMessage(`Created ${c}.holo! \u{1F389} Try adding more objects.`)}catch(v){De.window.showErrorMessage(`Failed to create file: ${v}`)}})),n.globalState.get("holoscript.hasShownWelcome")||(n.globalState.update("holoscript.hasShownWelcome",!0),De.window.showInformationMessage("Welcome to HoloScript! \u{1F389} Ready to build VR/AR experiences?","Get Started","Open Examples").then(a=>{a==="Get Started"?De.commands.executeCommand("holoscript.showWalkthrough"):a==="Open Examples"&&De.commands.executeCommand("holoscript.openExamples")}));let t=[Mi.join(n.extensionPath,"server","lsp","server.js"),Mi.join(n.extensionPath,"..","cli","dist","lsp","server.js"),Mi.join(n.extensionPath,"node_modules","@holoscript","cli","dist","lsp","server.js"),Mi.join(n.extensionPath,"..","lsp","dist","server.js")],r;for(let a of t)if(po.existsSync(a)){r=a;break}if(!r){console.log("HoloScript: Language server not found. Running in syntax-only mode.");return}let i={run:{module:r,transport:mo.TransportKind.ipc},debug:{module:r,transport:mo.TransportKind.ipc}},s={documentSelector:[{scheme:"file",language:"holoscript"},{scheme:"file",language:"holoscriptplus"}],synchronize:{fileEvents:De.workspace.createFileSystemWatcher("**/.holoscriptrc")}};Sc=new mo.LanguageClient("holoscriptLSP","HoloScript Language Server",i,s),Sc.start().catch(a=>{console.error("HoloScript: Failed to start language server:",a)}),n.subscriptions.push(yc.register(n));let o=new fc;Ge.window.registerTreeDataProvider("holohub.assets",o),n.subscriptions.push(De.commands.registerCommand("holoscript.holohub.importAsset",async a=>{let c=a?.label||"Asset";De.window.showInformationMessage(`Downloading ${c} from HoloHub...`),await new Promise(u=>setTimeout(u,1500)),De.window.showInformationMessage(`Successfully imported ${c} to project!`)}));try{let a=(dh(),yh(kC)),{loadConfig:c}=a;n.subscriptions.push(Ge.languages.registerDocumentFormattingEditProvider(["holoscript","holoscriptplus"],{provideDocumentFormattingEdits(u){let v=Ge.workspace.getConfiguration("holoscript").get("formatOnSaveTimeout",1e3);return new Promise(b=>{let g=setTimeout(()=>{console.warn("HoloScript: Formatting timed out"),b([])},v),h=()=>{try{let w=c(u.fileName),_=a.createFormatter(w),D=u.getText(),k=_.format(D,u.languageId==="holoscriptplus"?"hsplus":"holo");if(clearTimeout(g),k.errors.length>0&&console.warn("HoloScript: Formatter errors:",k.errors),!k.changed){b([]);return}let y=new Ge.Range(u.positionAt(0),u.positionAt(D.length));b([Ge.TextEdit.replace(y,k.formatted)])}catch(w){console.error("HoloScript: Formatting failed:",w),clearTimeout(g),b([])}};u.lineCount>1e3?Ge.window.withProgress({location:Ge.ProgressLocation.Notification,title:"Formatting HoloScript...",cancellable:!1},async()=>{h()}):h()})}}),Ge.languages.registerDocumentRangeFormattingEditProvider(["holoscript","holoscriptplus"],{provideDocumentRangeFormattingEdits(u,d){try{let v=c(u.fileName),b=a.createFormatter(v),g=u.getText(),h=u.languageId==="holoscriptplus"?"hsplus":"holo",w={startLine:d.start.line,endLine:d.end.line},_=b.formatRange(g,w,h);return _.changed?[Ge.TextEdit.replace(d,_.formatted)]:[]}catch(v){return console.error("HoloScript: Range formatting failed:",v),[]}}})),console.log("HoloScript: Formatter registered.")}catch(a){console.warn("HoloScript: Formatter package not found or failed to load:",a)}n.subscriptions.push(Ge.languages.registerCompletionItemProvider(["holoscript","holoscriptplus"],new Cc,"@"))}function _c(n){let e=n.fileName.toLowerCase();return e.endsWith(".holo")||e.endsWith(".hsplus")||e.endsWith(".hs")}function SR(){if(Sc)return Sc.stop()}0&&(module.exports={activate,deactivate});
